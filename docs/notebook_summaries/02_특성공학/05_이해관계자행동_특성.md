## 6. ì´í•´ê´€ê³„ì í–‰ë™ íŒ¨í„´ íŠ¹ì„±

### ğŸ’¡ ì¬ë¬´ ì „ë¬¸ê°€ ê´€ì : ì‹ ìš© í–‰ë™ > ì¬ë¬´ ì§€í‘œ

**í•™ìˆ ì  ë°°ê²½ (Shumway 2001; Campbell et al. 2008)**

Tyler Shumway(2001)ëŠ” **ë¶€ë„ ì „ 6ê°œì›”~1ë…„ ì‚¬ì´ ì‹ ìš© í–‰ë™ ë³€í™”**ê°€ ì¬ë¬´ ë¹„ìœ¨ë³´ë‹¤ ê°•ë ¥í•œ ì˜ˆì¸¡ ë³€ìˆ˜ì„ì„ ì‹¤ì¦í–ˆìŠµë‹ˆë‹¤. ë³¸ í”„ë¡œì íŠ¸ ë¶„ì„ì—ì„œë„ **ì—°ì²´ ê´€ë ¨ ë³€ìˆ˜ê°€ ìƒê´€ê³„ìˆ˜ 0.32**ë¡œ 1ìœ„ë¥¼ ì°¨ì§€í–ˆìŠµë‹ˆë‹¤.

**í•µì‹¬ ì›ë¦¬: ì—°ì²´ëŠ” "ë§ˆì§€ë§‰ ì„ íƒ"**

```
ê¸°ì—…ì˜ ì„ íƒ ìš°ì„ ìˆœìœ„:
1. ì˜ì—… ë¹„ìš© ì§€ê¸‰ (ê¸‰ì—¬, ì„ëŒ€ë£Œ) â†’ ìƒì¡´ í•„ìˆ˜
2. ëŒ€ì¶œ ì´ì ì§€ê¸‰ â†’ ì‹ ìš©ë„ ìœ ì§€
3. ì„¸ê¸ˆ ë‚©ë¶€ â†’ ë²•ì  ì˜ë¬´
4. ëŒ€ì¶œ ì›ê¸ˆ ìƒí™˜ â†’ ë§ˆì§€ë§‰

ì—°ì²´ ë°œìƒ = ìœ„ ëª¨ë“  ê²ƒì„ í¬ê¸° = ë¶€ë„ ì§ì „
```

**ì‹¤ì¦ ë°ì´í„° (ë³¸ í”„ë¡œì íŠ¸):**
- ì—°ì²´ê¸°ê´€ìˆ˜_ë¡œê·¸ ìƒê´€ê³„ìˆ˜: **0.323** (1ìœ„)
- ì—°ì²´ì—¬ë¶€_ë¯¸í•´ì œ: ë¶€ë„ìœ¨ **47.7%** (ì •ìƒ 1.2%ì˜ 39ë°°)
- ì¥ê¸°ì—°ì²´(30ì¼+): ë¶€ë„ìœ¨ **66.0%** (ì •ìƒ 1.4%ì˜ 47ë°°)

### ìƒì„±í•  9ê°œ ì´í•´ê´€ê³„ì í–‰ë™ ì§€í‘œ

| ì§€í‘œ | ì‹¤ë¬´ ì˜ë¯¸ | ë¶€ë„ìœ¨ ì¦ê°€ ë°°ìˆ˜ |
|------|-----------|------------------|
| ì´ì—°ì²´ê±´ìˆ˜ | ì—°ì²´ ë¹ˆë„ | 25ë°° |
| ì—°ì²´ì—¬ë¶€ | í˜„ì¬ ì—°ì²´ ì¤‘ | 39ë°° |
| ì—°ì²´ì‹¬ê°ë„ | ì—°ì²´ Ã— ë¶€ì±„ë¹„ìœ¨ | ë³µí•© |
| ì„¸ê¸ˆì²´ë‚©ê±´ìˆ˜ | ì„¸ê¸ˆ ë¯¸ë‚© | 21ë°° |
| ì„¸ê¸ˆì²´ë‚©ë¦¬ìŠ¤í¬ | ì²´ë‚© í˜ë„í‹° | 21ë°° |
| ê³µê³µì •ë³´ë¦¬ìŠ¤í¬ | ì••ë¥˜/ì†Œì†¡ | 15ë°° |
| ë²•ì ë¦¬ìŠ¤í¬ | ë²•ì  ë¶„ìŸ | 15ë°° |
| ì‹ ìš©ë“±ê¸‰ì ìˆ˜ | ì‹ ìš©í‰ê°€ì‚¬ íŒë‹¨ | ë“±ê¸‰ë³„ ì°¨ë“± |
| ì´í•´ê´€ê³„ì_ë¶ˆì‹ ì§€ìˆ˜ | ì¢…í•© ì‹ ë¢°ë„ | 35ë°° |

**í•µì‹¬ ë©”ì‹œì§€:**
> "ì¬ë¬´ì œí‘œëŠ” ê³¼ê±°, ì—°ì²´ ì´ë ¥ì€ í˜„ì¬" - ì„ í–‰ ì§€í‘œì˜ í˜

### ì½”ë“œ ì…€ #6

```python
def create_stakeholder_behavior_features(df):
    """ì´í•´ê´€ê³„ì í–‰ë™ íŒ¨í„´ì„ í¬ì°©í•˜ëŠ” íŠ¹ì„± ìƒì„±"""
    
    features = pd.DataFrame(index=df.index)
    
    # 1. ì‹ ìš© í–‰ë™ íŒ¨í„´
    credit_cols = [col for col in df.columns if 'ì—°ì²´' in col]
    if credit_cols:
        features['ì´ì—°ì²´ê±´ìˆ˜'] = df[credit_cols].sum(axis=1)
        features['ì—°ì²´ì—¬ë¶€'] = (features['ì´ì—°ì²´ê±´ìˆ˜'] > 0).astype(int)
        features['ì—°ì²´ì‹¬ê°ë„'] = features['ì´ì—°ì²´ê±´ìˆ˜'] * df.get('ë¶€ì±„ë¹„ìœ¨', 100) / 100
    
    # 2. ì„¸ê¸ˆ ì²´ë‚© ë¦¬ìŠ¤í¬
    tax_cols = [col for col in df.columns if 'ì²´ë‚©' in col or 'ì„¸ê¸ˆ' in col]
    if tax_cols:
        features['ì„¸ê¸ˆì²´ë‚©ê±´ìˆ˜'] = df[tax_cols].sum(axis=1)
        features['ì„¸ê¸ˆì²´ë‚©ë¦¬ìŠ¤í¬'] = (features['ì„¸ê¸ˆì²´ë‚©ê±´ìˆ˜'] > 0).astype(int) * 5
    
    # 3. ê³µê³µì •ë³´ ë¦¬ìŠ¤í¬
    public_cols = [col for col in df.columns if any(k in col for k in ['ì••ë¥˜', 'ì†Œì†¡', 'ê³µê³µ'])]
    if public_cols:
        features['ê³µê³µì •ë³´ë¦¬ìŠ¤í¬'] = df[public_cols].sum(axis=1)
        features['ë²•ì ë¦¬ìŠ¤í¬'] = (features['ê³µê³µì •ë³´ë¦¬ìŠ¤í¬'] > 0).astype(int) * 3
    
    # 4. ì‹ ìš©ë“±ê¸‰ ë¦¬ìŠ¤í¬
    rating_cols = [col for col in df.columns if 'ì‹ ìš©í‰ê°€ë“±ê¸‰' in col]
    if rating_cols:
        # ì‹ ìš©ë“±ê¸‰ì„ ìˆ«ìë¡œ ë³€í™˜ (ë‚®ì€ ë“±ê¸‰ì¼ìˆ˜ë¡ ë†’ì€ ì ìˆ˜)
        for col in rating_cols:
            if df[col].dtype == 'object':
                # ë“±ê¸‰ì„ ë¦¬ìŠ¤í¬ ì ìˆ˜ë¡œ ë§¤í•‘
                grade_map = {'AAA': 1, 'AA': 2, 'A': 3, 'BBB': 4, 'BB': 5, 'B': 6, 'CCC': 7, 'CC': 8, 'C': 9, 'D': 10}
                features['ì‹ ìš©ë“±ê¸‰ì ìˆ˜'] = df[col].map(grade_map).fillna(10)
            else:
                features['ì‹ ìš©ë“±ê¸‰ì ìˆ˜'] = df[col]
            break
    
    # 5. ì¢…í•© ì‹ ë¢°ë„ ì§€í‘œ
    features['ì´í•´ê´€ê³„ì_ë¶ˆì‹ ì§€ìˆ˜'] = (
        features.get('ì—°ì²´ì—¬ë¶€', 0) * 2 +
        features.get('ì„¸ê¸ˆì²´ë‚©ë¦¬ìŠ¤í¬', 0) +
        features.get('ë²•ì ë¦¬ìŠ¤í¬', 0) +
        features.get('ì‹ ìš©ë“±ê¸‰ì ìˆ˜', 0) / 2
    )
    
    print(f"âœ… ì´í•´ê´€ê³„ì í–‰ë™ íŒ¨í„´ íŠ¹ì„± {features.shape[1]}ê°œ ìƒì„± ì™„ë£Œ")
    return features

stakeholder_features = create_stakeholder_behavior_features(df)
print("\nìƒì„±ëœ ì´í•´ê´€ê³„ì í–‰ë™ íŠ¹ì„±:")
print(stakeholder_features.columns.tolist())
```

**ì¶œë ¥:**

```
âœ… ì´í•´ê´€ê³„ì í–‰ë™ íŒ¨í„´ íŠ¹ì„± 9ê°œ ìƒì„± ì™„ë£Œ

ìƒì„±ëœ ì´í•´ê´€ê³„ì í–‰ë™ íŠ¹ì„±:
['ì´ì—°ì²´ê±´ìˆ˜', 'ì—°ì²´ì—¬ë¶€', 'ì—°ì²´ì‹¬ê°ë„', 'ì„¸ê¸ˆì²´ë‚©ê±´ìˆ˜', 'ì„¸ê¸ˆì²´ë‚©ë¦¬ìŠ¤í¬', 'ê³µê³µì •ë³´ë¦¬ìŠ¤í¬', 'ë²•ì ë¦¬ìŠ¤í¬', 'ì‹ ìš©ë“±ê¸‰ì ìˆ˜', 'ì´í•´ê´€ê³„ì_ë¶ˆì‹ ì§€ìˆ˜']
```

---

## 6.5 ì„±ì¥ì„± ì§€í‘œ (Growth Features)

### ğŸ’¡ ì™œ ì„±ì¥ì„± ì§€í‘œê°€ ì¤‘ìš”í•œê°€?

**ê²½ì œì  ê°€ì„¤: "ì„±ì¥ ë‘”í™”ëŠ” ë¶€ë„ì˜ ì¡°ê¸° ê²½ë³´ ì‹ í˜¸"**

**ì‹¤ì¦ ë¶„ì„ ê²°ê³¼ (ì°¸ê³  ë°ì´í„° ê¸°ë°˜):**
- ì˜ì—…ì´ìµì¦ê°€ìœ¨_YoY ìƒê´€ê³„ìˆ˜: -0.012 â†’ **ìŒì˜ ì„±ì¥(ì—­ì„±ì¥)ì´ ë¶€ë„ì™€ ì—°ê´€**
- ì„±ì¥ ë‘”í™”ëŠ” ë¶€ë„ ë°œìƒ **3~6ê°œì›” ì „**ì— ë‚˜íƒ€ë‚¨

**ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§:**
1. **ë§¤ì¶œ ê°ì†Œ** â†’ ì‹œì¥ ì ìœ ìœ¨ ìƒì‹¤, ê²½ìŸë ¥ ì•½í™”
2. **ì˜ì—…ì´ìµ ê°ì†Œ** â†’ ìˆ˜ìµì„± ì•…í™”, ë¹„ìš© í†µì œ ì‹¤íŒ¨  
3. **ë‹¹ê¸°ìˆœì´ìµ ê°ì†Œ** â†’ ìµœì¢… ìˆ˜ìµì„± ì €í•˜, ëˆ„ì  ì†ì‹¤
4. **ìì‚° ê°ì†Œ** â†’ ì‚¬ì—… ì¶•ì†Œ, íˆ¬ì ì¤‘ë‹¨
5. **ìë³¸ ê°ì†Œ** â†’ ìë³¸ì ì‹ ì§„í–‰, ì¬ë¬´êµ¬ì¡° ì•…í™”

**ì‹¤ì œ ì‚¬ë¡€:**
```
IT ì„œë¹„ìŠ¤ ê¸°ì—… Eì‚¬:
- 2019ë…„: ë§¤ì¶œ 200ì–µ, ì˜ì—…ì´ìµ 20ì–µ (ì„±ì¥ì„¸)
- 2020ë…„: ë§¤ì¶œ 180ì–µ(-10%), ì˜ì—…ì´ìµ 5ì–µ(-75%) â† ê¸‰ê²©í•œ ë‘”í™”
- 2021ë…„: ë§¤ì¶œ 150ì–µ(-17%), ì˜ì—…ì´ìµ -10ì–µ â† ì ì ì „í™˜
- ê²°ê³¼: 2021ë…„ 6ì›” ë¶€ë„
```

**ì„ê³„ ê¸°ì¤€:**
- ë§¤ì¶œ ê°ì†Œìœ¨ > 10%: ê²½ê³ 
- ì˜ì—…ì´ìµ ê°ì†Œìœ¨ > 30%: ìœ„í—˜
- ë‹¹ê¸°ìˆœì´ìµ ì ì ì „í™˜: ë§¤ìš° ìœ„í—˜

### ì½”ë“œ ì…€ #7

```python
def create_growth_features(df):
    """ì„±ì¥ì„± ì§€í‘œ ìƒì„± (Growth Features)"""
    
    features = pd.DataFrame(index=df.index)
    
    # 1. ë§¤ì¶œ ì„±ì¥ë¥  (Sales Growth Rate)
    if 'ë§¤ì¶œì•¡ì¦ê°€ìœ¨' in df.columns:
        features['ë§¤ì¶œì¦ê°€ìœ¨_YoY'] = df['ë§¤ì¶œì•¡ì¦ê°€ìœ¨']
    elif 'ë§¤ì¶œì•¡' in df.columns and 'ì „ê¸°ë§¤ì¶œì•¡' in df.columns:
        features['ë§¤ì¶œì¦ê°€ìœ¨_YoY'] = (
            (df['ë§¤ì¶œì•¡'] - df['ì „ê¸°ë§¤ì¶œì•¡']) / (df['ì „ê¸°ë§¤ì¶œì•¡'] + 1)
        ) * 100
    
    # 2. ì˜ì—…ì´ìµ ì„±ì¥ë¥ 
    if 'ì˜ì—…ì´ìµì¦ê°€ìœ¨' in df.columns:
        features['ì˜ì—…ì´ìµì¦ê°€ìœ¨_YoY'] = df['ì˜ì—…ì´ìµì¦ê°€ìœ¨']
    elif 'ì˜ì—…ì´ìµ' in df.columns and 'ì „ê¸°ì˜ì—…ì´ìµ' in df.columns:
        features['ì˜ì—…ì´ìµì¦ê°€ìœ¨_YoY'] = (
            (df['ì˜ì—…ì´ìµ'] - df['ì „ê¸°ì˜ì—…ì´ìµ']) / (df['ì „ê¸°ì˜ì—…ì´ìµ'].abs() + 1)
        ) * 100
    
    # 3. ë‹¹ê¸°ìˆœì´ìµ ì„±ì¥ë¥ 
    if 'ë‹¹ê¸°ìˆœì´ìµì¦ê°€ìœ¨' in df.columns:
        features['ë‹¹ê¸°ìˆœì´ìµì¦ê°€ìœ¨_YoY'] = df['ë‹¹ê¸°ìˆœì´ìµì¦ê°€ìœ¨']
    elif 'ë‹¹ê¸°ìˆœì´ìµ' in df.columns and 'ì „ê¸°ë‹¹ê¸°ìˆœì´ìµ' in df.columns:
        features['ë‹¹ê¸°ìˆœì´ìµì¦ê°€ìœ¨_YoY'] = (
            (df['ë‹¹ê¸°ìˆœì´ìµ'] - df['ì „ê¸°ë‹¹ê¸°ìˆœì´ìµ']) / (df['ì „ê¸°ë‹¹ê¸°ìˆœì´ìµ'].abs() + 1)
        ) * 100
    
    # 4. ì´ìì‚° ì„±ì¥ë¥ 
    if 'ì´ìì‚°ì¦ê°€ìœ¨' in df.columns:
        features['ì´ìì‚°ì¦ê°€ìœ¨_YoY'] = df['ì´ìì‚°ì¦ê°€ìœ¨']
    elif 'ì´ìì‚°' in df.columns and 'ì „ê¸°ì´ìì‚°' in df.columns:
        features['ì´ìì‚°ì¦ê°€ìœ¨_YoY'] = (
            (df['ì´ìì‚°'] - df['ì „ê¸°ì´ìì‚°']) / (df['ì „ê¸°ì´ìì‚°'] + 1)
        ) * 100
    
    # 5. ìë³¸ ì„±ì¥ë¥  (ìë³¸ì ì‹ ì—¬ë¶€ í™•ì¸)
    if 'ìë³¸ì¦ê°€ìœ¨' in df.columns:
        features['ìë³¸ì¦ê°€ìœ¨_YoY'] = df['ìë³¸ì¦ê°€ìœ¨']
    elif 'ìê¸°ìë³¸' in df.columns and 'ì „ê¸°ìê¸°ìë³¸' in df.columns:
        features['ìë³¸ì¦ê°€ìœ¨_YoY'] = (
            (df['ìê¸°ìë³¸'] - df['ì „ê¸°ìê¸°ìë³¸']) / (df['ì „ê¸°ìê¸°ìë³¸'].abs() + 1)
        ) * 100
    
    # 6. ì„±ì¥ ë‘”í™” ì‹ í˜¸ (ë§¤ì¶œ ê°ì†Œ + ì˜ì—…ì´ìµ ê°ì†Œ)
    features['ì„±ì¥ë‘”í™”ì‹ í˜¸'] = (
        (features.get('ë§¤ì¶œì¦ê°€ìœ¨_YoY', 0) < -10).astype(int) +
        (features.get('ì˜ì—…ì´ìµì¦ê°€ìœ¨_YoY', 0) < -30).astype(int)
    )
    
    # 7. ì—­ì„±ì¥ ìœ„í—˜ (ìŒì˜ ì„±ì¥ë¥ )
    features['ì—­ì„±ì¥ìœ„í—˜'] = (
        (features.get('ë§¤ì¶œì¦ê°€ìœ¨_YoY', 0) < 0).astype(int) * 2 +
        (features.get('ì˜ì—…ì´ìµì¦ê°€ìœ¨_YoY', 0) < 0).astype(int) * 3 +
        (features.get('ë‹¹ê¸°ìˆœì´ìµì¦ê°€ìœ¨_YoY', 0) < 0).astype(int)
    )
    
    print(f"âœ… ì„±ì¥ì„± ì§€í‘œ {features.shape[1]}ê°œ ìƒì„± ì™„ë£Œ")
    return features

growth_features = create_growth_features(df)
print("\nìƒì„±ëœ ì„±ì¥ì„± ì§€í‘œ:")
print(growth_features.columns.tolist())

```

**ì¶œë ¥:**

```
âœ… ì„±ì¥ì„± ì§€í‘œ 5ê°œ ìƒì„± ì™„ë£Œ

ìƒì„±ëœ ì„±ì¥ì„± ì§€í‘œ:
['ë§¤ì¶œì¦ê°€ìœ¨_YoY', 'ì˜ì—…ì´ìµì¦ê°€ìœ¨_YoY', 'ë‹¹ê¸°ìˆœì´ìµì¦ê°€ìœ¨_YoY', 'ì„±ì¥ë‘”í™”ì‹ í˜¸', 'ì—­ì„±ì¥ìœ„í—˜']
```

---

## 6.6 ìˆ˜ìµì„± ë° í™œë™ì„± ë³´ì™„ ì§€í‘œ

### ğŸ’¡ ì™œ ìˆ˜ìµì„±ê³¼ í™œë™ì„± ì§€í‘œê°€ ì¶”ê°€ë¡œ í•„ìš”í•œê°€?

**ê²½ì œì  ê°€ì„¤: "ìˆ˜ìµì„± ì•…í™” + ìì‚° í™œìš© ì €í•˜ = ë¶€ë„ ìœ„í—˜"**

**ìˆ˜ìµì„± ì§€í‘œ (Profitability):**
- **ì˜ì—…ì´ìµë¥ **: ë³¸ì—…ì˜ ìˆ˜ìµì„± ì¸¡ì • (íŒê´€ë¹„ í†µì œ ëŠ¥ë ¥)
- **ìˆœì´ìµë¥ **: ìµœì¢… ìˆ˜ìµì„± (ì´ì, ì„¸ê¸ˆ í¬í•¨)
- **ì´ìµì˜ ì§ˆ (Accruals)**: í˜„ê¸ˆì´ ë’·ë°›ì¹¨ë˜ì§€ ì•ŠëŠ” ì´ìµ = ë¶„ì‹íšŒê³„ ì˜ì‹¬

**í™œë™ì„± ì§€í‘œ (Activity):**
- **ì´ìì‚°íšŒì „ìœ¨**: ìì‚°ì„ ì–¼ë§ˆë‚˜ íš¨ìœ¨ì ìœ¼ë¡œ í™œìš©í•˜ì—¬ ë§¤ì¶œì„ ì°½ì¶œí•˜ëŠ”ê°€?
- **ìœ ë™ì„±_íš¨ìœ¨ì„±_êµì°¨**: ìœ ë™ì„±ê³¼ íš¨ìœ¨ì„±ì˜ ìƒí˜¸ì‘ìš© (ë‚®ì€ ì¬ê³ íšŒì „ìœ¨ + ë‚®ì€ ìœ ë™ë¹„ìœ¨ = ìœ„í—˜)

**ì‹¤ì œ ì‚¬ë¡€:**
```
ì†Œë§¤ì—…ì²´ Fì‚¬:
- ì˜ì—…ì´ìµë¥ : 2% (ì—…ê³„ í‰ê·  5%) â† ë‚®ì€ ìˆ˜ìµì„±
- ì´ìì‚°íšŒì „ìœ¨: 0.5íšŒ (ì—…ê³„ í‰ê·  2íšŒ) â† ë‚®ì€ íš¨ìœ¨ì„±
- ì´ìµì˜ ì§ˆ: -0.05 (ìŒìˆ˜) â† í˜„ê¸ˆíë¦„ < ì´ìµ (ì˜ì‹¬)
- ê²°ê³¼: 1ë…„ ë‚´ ë¶€ë„
```

### ì½”ë“œ ì…€ #8

```python
def create_profitability_activity_features(df):
    """ìˆ˜ìµì„± ë° í™œë™ì„± ì§€í‘œ ìƒì„±"""
    
    features = pd.DataFrame(index=df.index)
    
    # 1. ìˆ˜ìµì„± ì§€í‘œ (Profitability)
    
    # ì˜ì—…ì´ìµë¥  (Operating Profit Margin)
    if 'ì˜ì—…ì´ìµ' in df.columns and 'ë§¤ì¶œì•¡' in df.columns:
        features['ì˜ì—…ì´ìµë¥ '] = (df['ì˜ì—…ì´ìµ'] / (df['ë§¤ì¶œì•¡'] + 1)) * 100
    
    # ìˆœì´ìµë¥  (Net Profit Margin)
    if 'ë‹¹ê¸°ìˆœì´ìµ' in df.columns and 'ë§¤ì¶œì•¡' in df.columns:
        features['ìˆœì´ìµë¥ '] = (df['ë‹¹ê¸°ìˆœì´ìµ'] / (df['ë§¤ì¶œì•¡'] + 1)) * 100
    
    # ë§¤ì¶œì´ì´ìµë¥  (Gross Profit Margin)
    if 'ë§¤ì¶œì´ì´ìµ' in df.columns and 'ë§¤ì¶œì•¡' in df.columns:
        features['ë§¤ì¶œì´ì´ìµë¥ '] = (df['ë§¤ì¶œì´ì´ìµ'] / (df['ë§¤ì¶œì•¡'] + 1)) * 100
    elif 'ë§¤ì¶œì›ê°€' in df.columns and 'ë§¤ì¶œì•¡' in df.columns:
        features['ë§¤ì¶œì´ì´ìµë¥ '] = ((df['ë§¤ì¶œì•¡'] - df['ë§¤ì¶œì›ê°€']) / (df['ë§¤ì¶œì•¡'] + 1)) * 100
    
    # ROA (Return on Assets)
    if 'ë‹¹ê¸°ìˆœì´ìµ' in df.columns and 'ì´ìì‚°' in df.columns:
        features['ROA'] = (df['ë‹¹ê¸°ìˆœì´ìµ'] / (df['ì´ìì‚°'] + 1)) * 100
    
    # ROE (Return on Equity)
    if 'ë‹¹ê¸°ìˆœì´ìµ' in df.columns and 'ìê¸°ìë³¸' in df.columns:
        features['ROE'] = (df['ë‹¹ê¸°ìˆœì´ìµ'] / (df['ìê¸°ìë³¸'].abs() + 1)) * 100
    
    # ì´ìµì˜ ì§ˆ (Accruals Quality)
    # ì´ìµì˜ ì§ˆ = ì˜ì—…í˜„ê¸ˆíë¦„ / ë‹¹ê¸°ìˆœì´ìµ (1ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ì–‘í˜¸)
    if 'ì˜ì—…í™œë™í˜„ê¸ˆíë¦„' in df.columns and 'ë‹¹ê¸°ìˆœì´ìµ' in df.columns:
        features['ì´ìµì˜ì§ˆ'] = df['ì˜ì—…í™œë™í˜„ê¸ˆíë¦„'] / (df['ë‹¹ê¸°ìˆœì´ìµ'].abs() + 1)
        # ìŒìˆ˜ ì´ìµì˜ ì§ˆ = í˜„ê¸ˆíë¦„ < ì´ìµ (ì˜ì‹¬)
        features['ì´ìµí’ˆì§ˆ_ì´ìƒì‹ í˜¸'] = (features['ì´ìµì˜ì§ˆ'] < 0.5).astype(int)
    
    # 2. í™œë™ì„± ì§€í‘œ (Activity / Efficiency)
    
    # ì´ìì‚°íšŒì „ìœ¨ (Total Asset Turnover)
    if 'ë§¤ì¶œì•¡' in df.columns and 'ì´ìì‚°' in df.columns:
        features['ì´ìì‚°íšŒì „ìœ¨'] = df['ë§¤ì¶œì•¡'] / (df['ì´ìì‚°'] + 1)
    
    # ì¬ê³ ìì‚°íšŒì „ìœ¨ (Inventory Turnover)
    if 'ë§¤ì¶œì›ê°€' in df.columns and 'ì¬ê³ ìì‚°' in df.columns:
        features['ì¬ê³ ìì‚°íšŒì „ìœ¨'] = df['ë§¤ì¶œì›ê°€'] / (df['ì¬ê³ ìì‚°'] + 1)
        # ë‚®ì€ ì¬ê³ íšŒì „ìœ¨ = ì¬ê³  ì ì²´ ìœ„í—˜
        features['ì¬ê³ ì ì²´ìœ„í—˜'] = (features['ì¬ê³ ìì‚°íšŒì „ìœ¨'] < 2).astype(int)
    
    # ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨ (Accounts Receivable Turnover)
    if 'ë§¤ì¶œì•¡' in df.columns and 'ë§¤ì¶œì±„ê¶Œ' in df.columns:
        features['ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨'] = df['ë§¤ì¶œì•¡'] / (df['ë§¤ì¶œì±„ê¶Œ'] + 1)
        # ë‚®ì€ ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨ = íšŒìˆ˜ ì§€ì—°
        features['ë§¤ì¶œì±„ê¶ŒíšŒìˆ˜ì§€ì—°'] = (features['ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨'] < 5).astype(int)
    
    # 3. ìœ ë™ì„±_íš¨ìœ¨ì„± êµì°¨ ì§€í‘œ
    # ë‚®ì€ ì¬ê³ íšŒì „ìœ¨ + ë‚®ì€ ìœ ë™ë¹„ìœ¨ = ìœ„í—˜
    if 'ìœ ë™ë¹„ìœ¨' in df.columns and 'ì¬ê³ ìì‚°íšŒì „ìœ¨' in features.columns:
        features['ìœ ë™ì„±_íš¨ìœ¨ì„±_êµì°¨ìœ„í—˜'] = (
            ((df['ìœ ë™ë¹„ìœ¨'] < 100).astype(int) +
             (features['ì¬ê³ ìì‚°íšŒì „ìœ¨'] < 2).astype(int))
        )
    
    print(f"âœ… ìˆ˜ìµì„± ë° í™œë™ì„± ì§€í‘œ {features.shape[1]}ê°œ ìƒì„± ì™„ë£Œ")
    return features

profitability_activity_features = create_profitability_activity_features(df)
print("\nìƒì„±ëœ ìˆ˜ìµì„±/í™œë™ì„± ì§€í‘œ:")
print(profitability_activity_features.columns.tolist())

```

**ì¶œë ¥:**

```
âœ… ìˆ˜ìµì„± ë° í™œë™ì„± ì§€í‘œ 8ê°œ ìƒì„± ì™„ë£Œ

ìƒì„±ëœ ìˆ˜ìµì„±/í™œë™ì„± ì§€í‘œ:
['ìˆœì´ìµë¥ ', 'ë§¤ì¶œì´ì´ìµë¥ ', 'ì´ìµì˜ì§ˆ', 'ì´ìµí’ˆì§ˆ_ì´ìƒì‹ í˜¸', 'ì¬ê³ ìì‚°íšŒì „ìœ¨', 'ì¬ê³ ì ì²´ìœ„í—˜', 'ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨', 'ë§¤ì¶œì±„ê¶ŒíšŒìˆ˜ì§€ì—°']
```

---

