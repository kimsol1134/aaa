## 4. ì¬ë¬´ì¡°ì‘ íƒì§€ íŠ¹ì„± (Beneish M-Score í•œêµ­í˜•)

### ğŸ’¡ ì™œ ì¬ë¬´ì¡°ì‘ íƒì§€ê°€ í•„ìš”í•œê°€?

**ê²½ì œì  ê°€ì„¤: "ë¶€ë„ ì§ì „ ê¸°ì—…ì€ ì‹¤ì ì„ ë¶€í’€ë¦°ë‹¤"**

**í•™ìˆ ì  ë°°ê²½ (Beneish 1999):**
- **M-Score**: ì¬ë¬´ì œí‘œ ì¡°ì‘ ê°€ëŠ¥ì„±ì„ ìˆ˜ì¹˜í™”í•œ ì§€í‘œ
- 8ê°œ ì¬ë¬´ ë¹„ìœ¨ì˜ ê°€ì¤‘í•©ìœ¼ë¡œ ê³„ì‚°
- M-Score > -2.22: ì¡°ì‘ ì˜ì‹¬ (76% ì •í™•ë„)

**í•œêµ­í˜• M-Score ì¡°ì •:**
- ì™¸ë¶€ê°ì‚¬ ì—¬ë¶€ ë°˜ì˜ (í•œêµ­ ì‹œì¥ íŠ¹ì„±)
- ì¤‘ì†Œê¸°ì—… íŠ¹ì„± ë°˜ì˜ (íšŒê³„ í’ˆì§ˆ ì°¨ì´)

**ì‹¤ì œ ì‚¬ë¡€ (ëŒ€ìš°ì¡°ì„ í•´ì–‘ 2015):**
```
- ë§¤ì¶œì±„ê¶Œ ê¸‰ì¦ (DSRIâ†‘): ê°€ê³µ ë§¤ì¶œ ì˜ì‹¬
- ë§¤ì¶œì´ì´ìµë¥  ê¸‰ì¦ (GMIâ†‘): ì›ê°€ ì¡°ì‘ ì˜ì‹¬
- ë°œìƒì•¡ ë¹„ì •ìƒ (TATAâ†‘): í˜„ê¸ˆ ì—†ëŠ” ì´ìµ ì˜ì‹¬
- M-Score > -2.22 â†’ ì¡°ì‘ ì˜ì‹¬
- ê²°ê³¼: 2015ë…„ ë¶„ì‹íšŒê³„ ì ë°œ
```

### Beneish M-Score 8ê°œ êµ¬ì„± ìš”ì†Œ

| ì§€í‘œ | ì˜ë¯¸ | ì¡°ì‘ ì‹ í˜¸ |
|------|------|----------|
| DSRI | ë§¤ì¶œì±„ê¶Œ / ë§¤ì¶œ ì¦ê°€ìœ¨ | ë†’ì„ìˆ˜ë¡ ê°€ê³µë§¤ì¶œ ì˜ì‹¬ |
| GMI | ë§¤ì¶œì´ì´ìµë¥  ë³€í™” | ê°ì†Œ ì‹œ ì¡°ì‘ ê°€ëŠ¥ì„± |
| AQI | ìì‚° í’ˆì§ˆ ì§€ìˆ˜ | ë†’ì„ìˆ˜ë¡ ìì‚° ë¶€í’€ë¦¬ê¸° ì˜ì‹¬ |
| SGI | ë§¤ì¶œ ì„±ì¥ë¥  | ê³¼ë„í•œ ì„±ì¥ ì‹œ ì˜ì‹¬ |
| DEPI | ê°ê°€ìƒê°ë¥  ë³€í™” | ê°ì†Œ ì‹œ ì´ìµ ë¶€í’€ë¦¬ê¸° ì˜ì‹¬ |
| SGAI | íŒê´€ë¹„ / ë§¤ì¶œ ë³€í™” | ì¦ê°€ ì‹œ ë¹„íš¨ìœ¨ ì˜ì‹¬ |
| LVGI | ë ˆë²„ë¦¬ì§€ ì¦ê°€ìœ¨ | ì¦ê°€ ì‹œ ì¬ë¬´ìœ„í—˜ ì¦ê°€ |
| TATA | ë°œìƒì•¡ / ì´ìì‚° | ë†’ì„ìˆ˜ë¡ í˜„ê¸ˆ ì—†ëŠ” ì´ìµ ì˜ì‹¬ |

**M-Score ê³„ì‚°ì‹:**
```
M-Score = -4.84 + 0.92*DSRI + 0.528*GMI + 0.404*AQI + 0.892*SGI 
          + 0.115*DEPI - 0.172*SGAI + 4.679*TATA - 0.327*LVGI

í•´ì„:
- M-Score > -2.22: ì¡°ì‘ ê°€ëŠ¥ì„± ë†’ìŒ
- M-Score â‰¤ -2.22: ì •ìƒ
```


### ì½”ë“œ ì…€ #4

```python
def create_manipulation_detection_features(df):
    """ì¬ë¬´ì¡°ì‘ ê°€ëŠ¥ì„±ì„ íƒì§€í•˜ëŠ” íŠ¹ì„± ìƒì„±"""
    
    features = pd.DataFrame(index=df.index)
    
    # ê³µí†µ ë³€ìˆ˜ ì•ˆì „í•˜ê²Œ í™•ë³´ (ë¶€ì±„ë¹„ìœ¨ì´ ì—†ìœ¼ë©´ ê³„ì‚°)
    if 'ë¶€ì±„ë¹„ìœ¨' in df.columns:
        ë¶€ì±„ë¹„ìœ¨ = df['ë¶€ì±„ë¹„ìœ¨']
    elif 'ë¶€ì±„ì´ê³„' in df.columns and 'ìë³¸ì´ê³„' in df.columns:
        ë¶€ì±„ë¹„ìœ¨ = df['ë¶€ì±„ì´ê³„'] / (df['ìë³¸ì´ê³„'].abs() + 1) * 100
    else:
        ë¶€ì±„ë¹„ìœ¨ = 100  # ê¸°ë³¸ê°’ (ë°ì´í„° ë¶€ì¡± ì‹œ)

    # 1. ë§¤ì¶œì±„ê¶Œ ì´ìƒ ì¦ê°€
    if 'ë§¤ì¶œì±„ê¶Œ' in df.columns and 'ë§¤ì¶œì•¡' in df.columns:
        features['ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨'] = df['ë§¤ì¶œì•¡'] / (df['ë§¤ì¶œì±„ê¶Œ'] + 1)
        features['ë§¤ì¶œì±„ê¶Œë¹„ìœ¨'] = df['ë§¤ì¶œì±„ê¶Œ'] / (df['ë§¤ì¶œì•¡'] + 1)
        # ìˆ˜ì •ëœ ë¶€ë¶„: df['ë¶€ì±„ë¹„ìœ¨'] ëŒ€ì‹  ìœ„ì—ì„œ í™•ë³´í•œ ë³€ìˆ˜ ì‚¬ìš©
        features['ë§¤ì¶œì±„ê¶Œ_ì´ìƒì§€í‘œ'] = features['ë§¤ì¶œì±„ê¶Œë¹„ìœ¨'] * (ë¶€ì±„ë¹„ìœ¨ / 100)
    
    # 2. ì¬ê³ ìì‚° ì´ìƒ ì ì²´
    if 'ì¬ê³ ìì‚°' in df.columns and 'ë§¤ì¶œì›ê°€' in df.columns:
        features['ì¬ê³ íšŒì „ìœ¨'] = df['ë§¤ì¶œì›ê°€'] / (df['ì¬ê³ ìì‚°'] + 1)
        features['ì¬ê³ ë³´ìœ ì¼ìˆ˜'] = 365 / (features['ì¬ê³ íšŒì „ìœ¨'] + 0.1)
        features['ì¬ê³ _ì´ìƒì§€í‘œ'] = df['ì¬ê³ ìì‚°'] / (df.get('ìì‚°ì´ê³„', 1) + 1) * 100
    
    # 3. ë°œìƒì•¡(Accruals) í’ˆì§ˆ
    if 'ë‹¹ê¸°ìˆœì´ìµ' in df.columns and 'ì˜ì—…í™œë™í˜„ê¸ˆíë¦„' in df.columns:
        features['ì´ë°œìƒì•¡'] = df['ë‹¹ê¸°ìˆœì´ìµ'] - df['ì˜ì—…í™œë™í˜„ê¸ˆíë¦„']
        features['ë°œìƒì•¡ë¹„ìœ¨'] = features['ì´ë°œìƒì•¡'] / (df.get('ìì‚°ì´ê³„', 1) + 1)
        features['í˜„ê¸ˆíë¦„í’ˆì§ˆ'] = df['ì˜ì—…í™œë™í˜„ê¸ˆíë¦„'] / (df['ë‹¹ê¸°ìˆœì´ìµ'] + 1)
    
    # 4. ë¹„ìš© ìë³¸í™” ì˜ì‹¬
    if 'ë¬´í˜•ìì‚°' in df.columns and 'ì˜ì—…ë¹„ìš©' in df.columns:
        features['ë¬´í˜•ìì‚°ë¹„ìœ¨'] = df['ë¬´í˜•ìì‚°'] / (df.get('ìì‚°ì´ê³„', 1) + 1)
        features['ë¹„ìš©ìë³¸í™”ì§€í‘œ'] = df['ë¬´í˜•ìì‚°'] / (df['ì˜ì—…ë¹„ìš©'] + 1)
    
    # 5. ë§¤ì¶œì´ì´ìµë¥  ì•…í™”
    if 'ë§¤ì¶œì´ì´ìµ' in df.columns and 'ë§¤ì¶œì•¡' in df.columns:
        features['ë§¤ì¶œì´ì´ìµë¥ '] = df['ë§¤ì¶œì´ì´ìµ'] / (df['ë§¤ì¶œì•¡'] + 1) * 100
        features['ì˜ì—…ë ˆë²„ë¦¬ì§€'] = df.get('ì˜ì—…ì†ìµ', 0) / (df['ë§¤ì¶œì´ì´ìµ'] + 1)
    
    # 6. íŒê´€ë¹„ ì´ìƒ ì¦ê°€
    if 'íŒë§¤ë¹„ì™€ê´€ë¦¬ë¹„' in df.columns and 'ë§¤ì¶œì•¡' in df.columns:
        features['íŒê´€ë¹„ìœ¨'] = df['íŒë§¤ë¹„ì™€ê´€ë¦¬ë¹„'] / (df['ë§¤ì¶œì•¡'] + 1) * 100
        features['íŒê´€ë¹„íš¨ìœ¨ì„±'] = df.get('ì˜ì—…ì†ìµ', 0) / (df['íŒë§¤ë¹„ì™€ê´€ë¦¬ë¹„'] + 1)
    
    # 7. M-Score ì¢…í•©
    m_score = 0
    if 'ë§¤ì¶œì±„ê¶Œë¹„ìœ¨' in features.columns:
        m_score += features['ë§¤ì¶œì±„ê¶Œë¹„ìœ¨'] * 0.92
    if 'ì¬ê³ _ì´ìƒì§€í‘œ' in features.columns:
        m_score += features['ì¬ê³ _ì´ìƒì§€í‘œ'] * 0.528
    if 'ë°œìƒì•¡ë¹„ìœ¨' in features.columns:
        m_score += features['ë°œìƒì•¡ë¹„ìœ¨'] * 4.679
    if 'ë¬´í˜•ìì‚°ë¹„ìœ¨' in features.columns:
        m_score += features['ë¬´í˜•ìì‚°ë¹„ìœ¨'] * 0.404
    
    features['M_Score_í•œêµ­í˜•'] = m_score - 2.22  # í•œêµ­ ì‹œì¥ ì¡°ì •
    features['ì¬ë¬´ì¡°ì‘ìœ„í—˜'] = (features['M_Score_í•œêµ­í˜•'] > 0).astype(int)
    
    print(f"âœ… ì¬ë¬´ì¡°ì‘ íƒì§€ íŠ¹ì„± {features.shape[1]}ê°œ ìƒì„± ì™„ë£Œ")
    return features

manipulation_features = create_manipulation_detection_features(df)
print("\nìƒì„±ëœ ì¬ë¬´ì¡°ì‘ íƒì§€ íŠ¹ì„±:")
print(manipulation_features.columns.tolist())
```

**ì¶œë ¥:**

```
âœ… ì¬ë¬´ì¡°ì‘ íƒì§€ íŠ¹ì„± 15ê°œ ìƒì„± ì™„ë£Œ

ìƒì„±ëœ ì¬ë¬´ì¡°ì‘ íƒì§€ íŠ¹ì„±:
['ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨', 'ë§¤ì¶œì±„ê¶Œë¹„ìœ¨', 'ë§¤ì¶œì±„ê¶Œ_ì´ìƒì§€í‘œ', 'ì¬ê³ íšŒì „ìœ¨', 'ì¬ê³ ë³´ìœ ì¼ìˆ˜', 'ì¬ê³ _ì´ìƒì§€í‘œ', 'ì´ë°œìƒì•¡', 'ë°œìƒì•¡ë¹„ìœ¨', 'í˜„ê¸ˆíë¦„í’ˆì§ˆ', 'ë§¤ì¶œì´ì´ìµë¥ ', 'ì˜ì—…ë ˆë²„ë¦¬ì§€', 'íŒê´€ë¹„ìœ¨', 'íŒê´€ë¹„íš¨ìœ¨ì„±', 'M_Score_í•œêµ­í˜•', 'ì¬ë¬´ì¡°ì‘ìœ„í—˜']
```

---

