# ë…¸íŠ¸ë¶ ë‚´ìš©: 01_ë„ë©”ì¸_ê¸°ë°˜_ë¶€ë„ì›ì¸_ë¶„ì„.ipynb

ì´ ì…€ ê°œìˆ˜: 53
================================================================================

## [ë§ˆí¬ë‹¤ìš´ #1]

# ğŸ“Š ë„ë©”ì¸ ê¸°ë°˜ ë¶€ë„ ì›ì¸ ë¶„ì„

## í•µì‹¬ ì§ˆë¬¸: "ì™œ ê¸°ì—…ì´ ë¶€ë„ê°€ ë‚˜ëŠ”ê°€?"

ì´ ë…¸íŠ¸ë¶ì—ì„œëŠ” í•œêµ­ ê¸°ì—…ì˜ ë¶€ë„ ì›ì¸ì„ ë„ë©”ì¸ ì „ë¬¸ê°€ ê´€ì ì—ì„œ ì‹¬ì¸µ ë¶„ì„í•©ë‹ˆë‹¤.
- ë°ì´í„°ì‚¬ì´ì–¸í‹°ìŠ¤íŠ¸ ê´€ì : í†µê³„ì  íŒ¨í„´ê³¼ ì´ìƒì¹˜ ë¶„ì„
- ê²½ì œì „ë¬¸ê°€ ê´€ì : ì¬ë¬´ ê±´ì „ì„± ì§€í‘œì™€ ì‚°ì—… íŠ¹ì„± ë¶„ì„

--------------------------------------------------------------------------------

## [ë§ˆí¬ë‹¤ìš´ #2]

## 1. í™˜ê²½ ì„¤ì • ë° ë°ì´í„° ë¡œë”©

--------------------------------------------------------------------------------

## [ì½”ë“œ #1]

```python
# í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
import warnings
warnings.filterwarnings('ignore')

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from scipy import stats
import plotly.express as px
import plotly.graph_objects as go
from plotly.subplots import make_subplots

# í•œê¸€ í°íŠ¸ ì„¤ì •
import platform
import matplotlib.font_manager as fm

# ìš´ì˜ì²´ì œë³„ í•œê¸€ í°íŠ¸ ì„¤ì •
if platform.system() == 'Darwin':  # macOS
    plt.rc('font', family='AppleGothic')
elif platform.system() == 'Windows':
    plt.rc('font', family='Malgun Gothic')
else:  # Linux
    plt.rc('font', family='NanumGothic')

plt.rc('axes', unicode_minus=False)  # ë§ˆì´ë„ˆìŠ¤ ê¸°í˜¸ ê¹¨ì§ ë°©ì§€

# ë””ìŠ¤í”Œë ˆì´ ì„¤ì •
pd.set_option('display.max_columns', None)
pd.set_option('display.max_rows', 100)
pd.set_option('display.float_format', lambda x: '%.3f' % x)

# ìŠ¤íƒ€ì¼ ì„¤ì •
sns.set_style('whitegrid')
sns.set_palette('husl')

print("âœ… í™˜ê²½ ì„¤ì • ì™„ë£Œ")
```

**ì¶œë ¥:**

```
âœ… í™˜ê²½ ì„¤ì • ì™„ë£Œ

```

--------------------------------------------------------------------------------

## [ì½”ë“œ #2]

```python
# ë°ì´í„° ë¡œë”©
df = pd.read_csv('../data/ê¸°ì—…ì‹ ìš©í‰ê°€ì •ë³´_210801.csv', encoding='utf-8')

# ë°ì´í„° ë”•ì…”ë„ˆë¦¬ ë¡œë”© (ì—‘ì…€ íŒŒì¼ì´ ìˆëŠ” ê²½ìš°)
try:
    data_dict = pd.read_excel('../data/ê¸°ì—… CB ë°ì´í„° í•­ëª©ì„¤ëª….xlsx')
    print("âœ… ë°ì´í„° ë”•ì…”ë„ˆë¦¬ ë¡œë”© ì™„ë£Œ")
except:
    print("âš ï¸ ë°ì´í„° ë”•ì…”ë„ˆë¦¬ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤")
    data_dict = None

print(f"\nğŸ“Š ë°ì´í„° shape: {df.shape}")
print(f"ğŸ“Š ê¸°ì—… ìˆ˜: {df.shape[0]:,}")
print(f"ğŸ“Š ë³€ìˆ˜ ìˆ˜: {df.shape[1]:,}")
```

**ì¶œë ¥:**

```
âœ… ë°ì´í„° ë”•ì…”ë„ˆë¦¬ ë¡œë”© ì™„ë£Œ

ğŸ“Š ë°ì´í„° shape: (50105, 159)
ğŸ“Š ê¸°ì—… ìˆ˜: 50,105
ğŸ“Š ë³€ìˆ˜ ìˆ˜: 159

```

--------------------------------------------------------------------------------

## [ë§ˆí¬ë‹¤ìš´ #3]

## 2. íƒ€ê²Ÿ ë³€ìˆ˜ ë° ë¶ˆê· í˜• ë¶„ì„

--------------------------------------------------------------------------------

## [ì½”ë“œ #3]

```python
# íƒ€ê²Ÿ ë³€ìˆ˜ í™•ì¸
target_col = 'ëª¨í˜•ê°œë°œìš©Performance(í–¥í›„1ë…„ë‚´ë¶€ë„ì—¬ë¶€)'

if target_col in df.columns:
    # ë¶€ë„ìœ¨ ê³„ì‚°
    bankruptcy_rate = df[target_col].value_counts(normalize=True)
    
    print("ğŸ¯ íƒ€ê²Ÿ ë³€ìˆ˜ ë¶„í¬")
    print("="*50)
    print(f"ì •ìƒ ê¸°ì—…: {(bankruptcy_rate.get(0, 0)*100):.2f}%")
    print(f"ë¶€ë„ ê¸°ì—…: {(bankruptcy_rate.get(1, 0)*100):.2f}%")
    print(f"\në¶ˆê· í˜• ë¹„ìœ¨: 1:{int(1/(bankruptcy_rate.get(1, 0.001)))}")
    
    # ì‹œê°í™”
    fig = make_subplots(rows=1, cols=2, 
                        subplot_titles=['ë¶€ë„ ì—¬ë¶€ ë¶„í¬', 'ë¶ˆê· í˜• ë¹„ìœ¨'],
                        specs=[[{'type': 'bar'}, {'type': 'pie'}]])
    
    # ë§‰ëŒ€ ê·¸ë˜í”„
    counts = df[target_col].value_counts()
    fig.add_trace(
        go.Bar(x=['ì •ìƒ', 'ë¶€ë„'], 
               y=[counts.get(0, 0), counts.get(1, 0)],
               text=[f"{counts.get(0, 0):,}", f"{counts.get(1, 0):,}"],
               textposition='outside'),
        row=1, col=1
    )
    
# íŒŒì´ ì°¨íŠ¸ (ìˆ˜ì •ë¨)
    fig.add_trace(
        go.Pie(labels=['ì •ìƒ', 'ë¶€ë„'], 
               values=[counts.get(0, 0), counts.get(1, 0)],
               hole=0.3,
               # 1. í…ìŠ¤íŠ¸ ìœ„ì¹˜ë¥¼ ë°”ê¹¥ìœ¼ë¡œ ê°•ì œ ì„¤ì •
               textposition='outside', 
               # 2. í…ìŠ¤íŠ¸ ì •ë³´ ì„¤ì • (ë ˆì´ë¸”+ë¹„ìœ¨)
               textinfo='label+percent', 
               # 3. í°íŠ¸ í¬ê¸° ì¡°ì • (ì„ íƒì‚¬í•­)
               textfont=dict(size=12),
               # 4. ì‘ì€ ì¡°ê°ì´ ì œëª©(12ì‹œ ë°©í–¥)ê³¼ ê²¹ì¹˜ì§€ ì•Šë„ë¡ 45ë„ íšŒì „
               rotation=45,
               # 5. (ì„ íƒ) ì‘ì€ ì¡°ê°(ë¶€ë„)ì„ ì‚´ì§ ë–¼ì–´ë‚´ì–´ ê°•ì¡°í•˜ê³  ì‹¶ë‹¤ë©´ ì•„ë˜ ì£¼ì„ í•´ì œ
               # pull=[0, 0.1] 
               ),
        row=1, col=2
    )
    
    # ë ˆì´ì•„ì›ƒ ì—…ë°ì´íŠ¸ (ì—¬ë°± í™•ë³´)
    fig.update_layout(
        height=400, 
        showlegend=False, 
        title_text="íƒ€ê²Ÿ ë³€ìˆ˜ ë¶ˆê· í˜• ë¶„ì„",
        # íŒŒì´ì°¨íŠ¸ ê¸€ìê°€ ë°”ê¹¥ìœ¼ë¡œ ë‚˜ê°€ë©´ì„œ ì˜ë¦¬ì§€ ì•Šë„ë¡ ì—¬ë°± ì¡°ì •
        margin=dict(t=80, b=50, l=50, r=50) 
    )
    fig.show()
else:
    print("âš ï¸ íƒ€ê²Ÿ ë³€ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤")
```

**ì¶œë ¥:**

```
ğŸ¯ íƒ€ê²Ÿ ë³€ìˆ˜ ë¶„í¬
==================================================
ì •ìƒ ê¸°ì—…: 98.49%
ë¶€ë„ ê¸°ì—…: 1.51%

ë¶ˆê· í˜• ë¹„ìœ¨: 1:66

```

--------------------------------------------------------------------------------

## [ë§ˆí¬ë‹¤ìš´ #4]

## 3. ë¶€ë„ì˜ ê·¼ë³¸ ì›ì¸ ë¶„ì„ (ë„ë©”ì¸ ê´€ì )

--------------------------------------------------------------------------------

## [ì½”ë“œ #4]

```python
# ì£¼ìš” ì¬ë¬´ ì§€í‘œ ì»¬ëŸ¼ ì‹ë³„ (ê°œì„ ëœ ë²„ì „)
def identify_key_columns(df):
    """
    ì£¼ìš” ì¬ë¬´ ì§€í‘œ ì»¬ëŸ¼ì„ ì‹ë³„í•˜ëŠ” í•¨ìˆ˜
    
    ê°œì„  ì‚¬í•­:
    - ì¬ë¬´ë¹„ìœ¨_ ì ‘ë‘ì‚¬ ìš°ì„  ì²˜ë¦¬
    - íŠ¹ì • í•­ëª© ëª…ì‹œì  ë¶„ë¥˜
    - í‚¤ì›Œë“œ í™•ì¥ ë° ìš°ì„ ìˆœìœ„ ì„¤ì •
    - ì¬ë¬´ì œí‘œ ì²´ê³„ ì¤€ìˆ˜
    """
    
    columns_dict = {
        'ê¸°ë³¸ì •ë³´': [],
        'ì¬ë¬´ìƒíƒœí‘œ': [],
        'ì†ìµê³„ì‚°ì„œ': [],
        'í˜„ê¸ˆíë¦„í‘œ': [],
        'ì¬ë¬´ë¹„ìœ¨': [],
        'ì‹ ìš©ì •ë³´': [],
        'ëª©í‘œë³€ìˆ˜': []
    }
    
    for col in df.columns:
        # 0. ëª©í‘œ ë³€ìˆ˜ (ìµœìš°ì„ )
        if col == 'ëª¨í˜•ê°œë°œìš©Performance(í–¥í›„1ë…„ë‚´ë¶€ë„ì—¬ë¶€)':
            columns_dict['ëª©í‘œë³€ìˆ˜'].append(col)
        
        # 1. ì¬ë¬´ë¹„ìœ¨_ ì ‘ë‘ì‚¬ê°€ ìˆëŠ” í•­ëª©ì€ ë¬´ì¡°ê±´ ì¬ë¬´ë¹„ìœ¨ë¡œ ë¶„ë¥˜
        elif col.startswith('ì¬ë¬´ë¹„ìœ¨_'):
            columns_dict['ì¬ë¬´ë¹„ìœ¨'].append(col)
        
        # 2. ì‹ ìš©ì •ë³´ (ìš°ì„ ìˆœìœ„ ë†’ìŒ)
        elif any(keyword in col for keyword in ['ì—°ì²´', 'ì²´ë‚©', 'ì‹ ìš©', 'í‰ê°€ë“±ê¸‰', 'ì••ë¥˜', 'ê³µê³µì •ë³´', 'CIS']):
            columns_dict['ì‹ ìš©ì •ë³´'].append(col)
        
        # 3. ê¸°ë³¸ì •ë³´
        elif any(keyword in col for keyword in ['ì—…ì¢…', 'ì„¤ë¦½', 'ì¢…ì—…ì›', 'ì£¼ì†Œ', 'ì™¸ê°', 'ìƒì¥', 'ê¸°ì¤€ë…„ì›”', 'ì†Œìœ ê±´ì¶•ë¬¼', 'ì‚¬ì—…ì¥']):
            columns_dict['ê¸°ë³¸ì •ë³´'].append(col)
        
        # 4. í˜„ê¸ˆíë¦„í‘œ (íŠ¹ì • í•­ëª© ëª…ì‹œ)
        elif col in ['í˜„ê¸ˆíë¦„', 'ì˜ì—…í™œë™í˜„ê¸ˆíë¦„', 'íˆ¬ìí™œë™í˜„ê¸ˆíë¦„', 'ì¬ë¬´í™œë™í˜„ê¸ˆíë¦„']:
            columns_dict['í˜„ê¸ˆíë¦„í‘œ'].append(col)
        
        # 5. ì¬ë¬´ë¹„ìœ¨ ëª…ì‹œì  í•­ëª© (ìš°ì„ ìˆœìœ„ ìµœê³ )
        elif col in ['ìê¸°ìë³¸ìˆœì´ìµìœ¨', 'ì´ìë³¸íšŒì „ìœ¨']:
            columns_dict['ì¬ë¬´ë¹„ìœ¨'].append(col)
        
        # 6. ì¬ë¬´ë¹„ìœ¨ (ê³„ì‚°ëœ ì§€í‘œ)
        elif any(keyword in col for keyword in ['ë¹„ìœ¨', 'íšŒì „ìœ¨', 'ROE', 'ROA', 'EBITDA', 'EBIT', 'ë³´ìƒë°°ìœ¨', 
                                                 'ì²­ì‚°ê°€ì¹˜', 'ì˜ì¡´ë„', 'ë§ˆì§„', 'OCF/', 'ì¦ê°€ìœ¨', 'ê³„ìˆ˜']):
            columns_dict['ì¬ë¬´ë¹„ìœ¨'].append(col)
        
        # 7. ì¬ë¬´ìƒíƒœí‘œ íŠ¹ì • í•­ëª©
        elif col in ['ì´ìµì‰ì—¬ê¸ˆ', 'ìœ ë³´ê¸ˆ', 'ê¸°íƒ€í¬ê´„ì†ìµëˆ„ê³„ì•¡']:
            columns_dict['ì¬ë¬´ìƒíƒœí‘œ'].append(col)
        
        # 8. ì†ìµê³„ì‚°ì„œ í•­ëª© ëª…ì‹œ
        elif col in ['íŒë§¤ë¹„ì™€ê´€ë¦¬ë¹„', 'ë²•ì¸ì„¸', 'ì¤‘ë‹¨ì‚°ì—…ì†ìµ', 'ê¸ˆìœµë¹„ìš©', 'ì‚¬ì±„ì´ì(ë‹¹ê¸°)', 'ì´ìë¹„ìš©',
                     'ë§¤ì¶œì±„ê¶Œì²˜ë¶„ì†ì‹¤(ë‹¹ê¸°)', 'ê³„ì†ì‚¬ì—…ì´ìµ', 'ì˜ì—…ì†ìµ', 'ì˜ì—…ì™¸ìˆ˜ìµ', 'ì˜ì—…ì™¸ë¹„ìš©']:
            columns_dict['ì†ìµê³„ì‚°ì„œ'].append(col)
        
        # 9. ì†ìµê³„ì‚°ì„œ (ìˆ˜ìµ, ë¹„ìš©, ì´ìµ í•­ëª©)
        elif any(keyword in col for keyword in ['ë§¤ì¶œì•¡', 'ì˜ì—…ì´ìµ', 'ë‹¹ê¸°ìˆœì´ìµ', 'ì†ì‹¤', 'ì›ê°€', 'ì´ì´ìµ', 
                                                 'ë²•ì¸ì„¸', 'ë§¤ì¶œì´ì´ìµ', 'ë§¤ì¶œì›ê°€']):
            columns_dict['ì†ìµê³„ì‚°ì„œ'].append(col)
        
        # 10. ì¬ë¬´ìƒíƒœí‘œ (ìì‚°, ë¶€ì±„, ìë³¸ í•­ëª©)
        elif any(keyword in col for keyword in ['ìì‚°', 'ë¶€ì±„', 'ìë³¸', 'ìœ ë™', 'ë¹„ìœ ë™', 'ì¬ê³ ', 'ë§¤ì¶œì±„ê¶Œ', 'ì°¨ì…ê¸ˆ', 
                                                 'ë§¤ì…ì±„ë¬´', 'ì¬ê³µí’ˆ', 'ìœ ê°€ì¦ê¶Œ', 'í¬ê´„ì†ìµ', 'í˜„ê¸ˆ', 
                                                 'í˜„ê¸ˆë“±ê°€ë¬¼', 'í˜„ê¸ˆì„±ìì‚°', 'ë‚©ì…ìë³¸', 'ë¬´í˜•ìì‚°', 'íˆ¬ììì‚°',
                                                 'ìš´ì „ìë³¸', 'ìˆœì°¨ì…ê¸ˆ', 'ë‹¹ì¢Œìì‚°']):
            columns_dict['ì¬ë¬´ìƒíƒœí‘œ'].append(col)
        
        else:
            columns_dict['ëª©í‘œë³€ìˆ˜'].append(col)  # ë¶„ë¥˜ ì•ˆëœ ê²ƒ
    
    return columns_dict

# ì»¬ëŸ¼ ë¶„ë¥˜ ì‹¤í–‰
columns_info = identify_key_columns(df)

# ê²°ê³¼ ì¶œë ¥
print("\n" + "="*80)
print("ì¬ë¬´ ì§€í‘œ ìë™ ë¶„ë¥˜ ê²°ê³¼ (ê°œì„ ëœ ë²„ì „)")
print("="*80)
for category, cols in columns_info.items():
    if len(cols) > 0:
        print(f"\n{category}: {len(cols)}ê°œ ë³€ìˆ˜")
        print(f"  ì˜ˆì‹œ: {cols[:3]}")

print(f"\n{'='*80}")
print(f"ì´ ë¶„ë¥˜ëœ ì»¬ëŸ¼: {sum(len(v) for v in columns_info.values())}ê°œ")
print(f"{'='*80}")

```

**ì¶œë ¥:**

```

================================================================================
ì¬ë¬´ ì§€í‘œ ìë™ ë¶„ë¥˜ ê²°ê³¼ (ê°œì„ ëœ ë²„ì „)
================================================================================

ê¸°ë³¸ì •ë³´: 13ê°œ ë³€ìˆ˜
  ì˜ˆì‹œ: ['ê¸°ì¤€ë…„ì›”', 'ì—…ì¢…(ì¤‘ë¶„ë¥˜)', 'ì™¸ê°êµ¬ë¶„']

ì¬ë¬´ìƒíƒœí‘œ: 33ê°œ ë³€ìˆ˜
  ì˜ˆì‹œ: ['ìœ ë™ìì‚°', 'ë¹„ìœ ë™ìì‚°', 'ë‹¹ì¢Œìì‚°']

ì†ìµê³„ì‚°ì„œ: 22ê°œ ë³€ìˆ˜
  ì˜ˆì‹œ: ['ë§¤ì¶œì±„ê¶Œì²˜ë¶„ì†ì‹¤(ë‹¹ê¸°)', 'ë§¤ì¶œì•¡', 'ì „ê¸°ë§¤ì¶œì•¡']

í˜„ê¸ˆíë¦„í‘œ: 4ê°œ ë³€ìˆ˜
  ì˜ˆì‹œ: ['í˜„ê¸ˆíë¦„', 'ì˜ì—…í™œë™í˜„ê¸ˆíë¦„', 'íˆ¬ìí™œë™í˜„ê¸ˆíë¦„']

ì¬ë¬´ë¹„ìœ¨: 40ê°œ ë³€ìˆ˜
  ì˜ˆì‹œ: ['ë¶€ì±„ìƒí™˜ê³„ìˆ˜', 'ì˜ì—…ì´ìµì´ìë³´ìƒë°°ìœ¨', 'ì´ìë³´ìƒë°°ìœ¨']

ì‹ ìš©ì •ë³´: 46ê°œ ë³€ìˆ˜
  ì˜ˆì‹œ: ['ê¸°ì—…ì‹ ìš©ê³µì—¬ì—°ì²´ê³¼ëª©ìˆ˜(ì¼ë³´)(ë¯¸í•´ì œ)', 'ê¸°ì—…ì‹ ìš©ê³µì—¬ì—°ì²´ê³¼ëª©ìˆ˜(ì¼ë³´)(3ê°œì›”ë‚´ìœ ì§€)(í•´ì œí¬í•¨)', 'ê¸°ì—…ì‹ ìš©ê³µì—¬ì—°ì²´ê³¼ëª©ìˆ˜(ì¼ë³´)(6ê°œì›”ë‚´ìœ ì§€)(í•´ì œí¬í•¨)']

ëª©í‘œë³€ìˆ˜: 1ê°œ ë³€ìˆ˜
  ì˜ˆì‹œ: ['ëª¨í˜•ê°œë°œìš©Performance(í–¥í›„1ë…„ë‚´ë¶€ë„ì—¬ë¶€)']

================================================================================
ì´ ë¶„ë¥˜ëœ ì»¬ëŸ¼: 159ê°œ
================================================================================

```

--------------------------------------------------------------------------------

## [ë§ˆí¬ë‹¤ìš´ #5]

### 3.1 ìœ ë™ì„± ìœ„ê¸° ë¶„ì„

--------------------------------------------------------------------------------

## [ì½”ë“œ #5]

```python
# ìœ ë™ë¹„ìœ¨ ë° ë‹¹ì¢Œë¹„ìœ¨ ë¶„ì„ (í˜„ê¸ˆë¹„ìœ¨ ì œì™¸)
liquidity_cols = ['ìœ ë™ìì‚°', 'ìœ ë™ë¶€ì±„', 'ì¬ê³ ìì‚°']
existing_liquidity_cols = [col for col in liquidity_cols if col in df.columns]

print("ğŸ“Š ìœ ë™ë¹„ìœ¨ ë° ë‹¹ì¢Œë¹„ìœ¨ ë¶„ì„")
print("="*80)

if len(existing_liquidity_cols) >= 2:
    # ìœ ë™ë¹„ìœ¨ ê³„ì‚°
    if 'ìœ ë™ìì‚°' in df.columns and 'ìœ ë™ë¶€ì±„' in df.columns:
        df['ìœ ë™ë¹„ìœ¨'] = df['ìœ ë™ìì‚°'] / (df['ìœ ë™ë¶€ì±„'] + 1)  # 0ìœ¼ë¡œ ë‚˜ëˆ„ê¸° ë°©ì§€
        df['ìœ ë™ë¹„ìœ¨'] = df['ìœ ë™ë¹„ìœ¨'].replace([np.inf, -np.inf], np.nan)
        print(f"âœ… ìœ ë™ë¹„ìœ¨ ê³„ì‚° ì™„ë£Œ")
        print(f"  - í‰ê· : {df['ìœ ë™ë¹„ìœ¨'].mean():.3f}")
        print(f"  - ì¤‘ì•™ê°’: {df['ìœ ë™ë¹„ìœ¨'].median():.3f}")
        
    # ë‹¹ì¢Œë¹„ìœ¨ ê³„ì‚°
    if 'ìœ ë™ìì‚°' in df.columns and 'ì¬ê³ ìì‚°' in df.columns and 'ìœ ë™ë¶€ì±„' in df.columns:
        df['ë‹¹ì¢Œë¹„ìœ¨'] = (df['ìœ ë™ìì‚°'] - df['ì¬ê³ ìì‚°']) / (df['ìœ ë™ë¶€ì±„'] + 1)
        df['ë‹¹ì¢Œë¹„ìœ¨'] = df['ë‹¹ì¢Œë¹„ìœ¨'].replace([np.inf, -np.inf], np.nan)
        print(f"âœ… ë‹¹ì¢Œë¹„ìœ¨ ê³„ì‚° ì™„ë£Œ")
        print(f"  - í‰ê· : {df['ë‹¹ì¢Œë¹„ìœ¨'].mean():.3f}")
        print(f"  - ì¤‘ì•™ê°’: {df['ë‹¹ì¢Œë¹„ìœ¨'].median():.3f}")
    
    # ë¶€ë„ê¸°ì—…ê³¼ ì •ìƒê¸°ì—…ì˜ ìœ ë™ì„± ì§€í‘œ ë¹„êµ (í˜„ê¸ˆë¹„ìœ¨ ì œì™¸)
    if target_col in df.columns:
        liquidity_metrics = ['ìœ ë™ë¹„ìœ¨', 'ë‹¹ì¢Œë¹„ìœ¨']
        existing_metrics = [m for m in liquidity_metrics if m in df.columns]
        
        if existing_metrics:
            comparison_data = []
            for metric in existing_metrics:
                # í‰ê· ê³¼ ì¤‘ì•™ê°’ ëª¨ë‘ ê³„ì‚°
                normal_median = df[df[target_col] == 0][metric].median()
                bankrupt_median = df[df[target_col] == 1][metric].median()
                normal_mean = df[df[target_col] == 0][metric].mean()
                bankrupt_mean = df[df[target_col] == 1][metric].mean()
                
                diff_rate = (normal_median - bankrupt_median) / normal_median * 100 if normal_median != 0 else 0
                comparison_data.append([metric, normal_median, bankrupt_median, diff_rate])
            
            comparison_df = pd.DataFrame(comparison_data, 
                                        columns=['ì§€í‘œ', 'ì •ìƒê¸°ì—…(ì¤‘ì•™ê°’)', 'ë¶€ë„ê¸°ì—…(ì¤‘ì•™ê°’)', 'ì°¨ì´ìœ¨(%)'])
            
            print("\nğŸ’§ ìœ ë™ë¹„ìœ¨ ë° ë‹¹ì¢Œë¹„ìœ¨ ë¹„êµ")
            print("-"*60)
            print(comparison_df.to_string(index=False))
            
            # ì‹œê°í™” - ìœ ë™ë¹„ìœ¨ê³¼ ë‹¹ì¢Œë¹„ìœ¨ë§Œ
            fig = go.Figure()
            
            # ì •ìƒê¸°ì—… ë°ì´í„°
            fig.add_trace(go.Bar(
                name='ì •ìƒê¸°ì—…', 
                x=existing_metrics, 
                y=[comparison_df[comparison_df['ì§€í‘œ']==m]['ì •ìƒê¸°ì—…(ì¤‘ì•™ê°’)'].values[0] for m in existing_metrics],
                text=[f"{comparison_df[comparison_df['ì§€í‘œ']==m]['ì •ìƒê¸°ì—…(ì¤‘ì•™ê°’)'].values[0]:.2f}" for m in existing_metrics],
                textposition='outside',
                marker_color='lightblue'
            ))
            
            # ë¶€ë„ê¸°ì—… ë°ì´í„°
            fig.add_trace(go.Bar(
                name='ë¶€ë„ê¸°ì—…', 
                x=existing_metrics, 
                y=[comparison_df[comparison_df['ì§€í‘œ']==m]['ë¶€ë„ê¸°ì—…(ì¤‘ì•™ê°’)'].values[0] for m in existing_metrics],
                text=[f"{comparison_df[comparison_df['ì§€í‘œ']==m]['ë¶€ë„ê¸°ì—…(ì¤‘ì•™ê°’)'].values[0]:.2f}" for m in existing_metrics],
                textposition='outside',
                marker_color='salmon'
            ))
            
            # ë ˆì´ì•„ì›ƒ ì„¤ì •
            fig.update_layout(
                title='ì •ìƒê¸°ì—… vs ë¶€ë„ê¸°ì—…: ìœ ë™ë¹„ìœ¨ ë° ë‹¹ì¢Œë¹„ìœ¨ ë¹„êµ',
                xaxis_title='ìœ ë™ì„± ì§€í‘œ',
                yaxis_title='ë¹„ìœ¨',
                barmode='group',
                height=500,
                showlegend=True,
                legend=dict(
                    orientation="h",
                    yanchor="bottom",
                    y=1.02,
                    xanchor="right",
                    x=1
                ),
                # ì—¬ë°± ì¦ê°€ë¡œ í…ìŠ¤íŠ¸ ê²¹ì¹¨ ë°©ì§€
                margin=dict(t=100, b=50, l=50, r=50)
            )
            
            # yì¶• ë²”ìœ„ ì„¤ì • (í…ìŠ¤íŠ¸ê°€ ì˜ë¦¬ì§€ ì•Šë„ë¡)
            max_value = max(
                comparison_df['ì •ìƒê¸°ì—…(ì¤‘ì•™ê°’)'].max(),
                comparison_df['ë¶€ë„ê¸°ì—…(ì¤‘ì•™ê°’)'].max()
            )
            fig.update_yaxes(range=[0, max_value * 1.2])
            
            fig.show()
            
            # í†µê³„ì  ìœ ì˜ì„± ê²€ì •
            from scipy.stats import mannwhitneyu
            
            print("\nğŸ“ˆ í†µê³„ì  ìœ ì˜ì„± ê²€ì • (Mann-Whitney U test)")
            print("-"*60)
            for metric in existing_metrics:
                normal_values = df[df[target_col] == 0][metric].dropna()
                bankrupt_values = df[df[target_col] == 1][metric].dropna()
                
                if len(normal_values) > 0 and len(bankrupt_values) > 0:
                    statistic, pvalue = mannwhitneyu(normal_values, bankrupt_values, alternative='two-sided')
                    print(f"{metric}:")
                    print(f"  - p-value: {pvalue:.4e}")
                    if pvalue < 0.001:
                        print(f"  - ê²°ë¡ : *** ë§¤ìš° ìœ ì˜í•œ ì°¨ì´ ***")
                    elif pvalue < 0.05:
                        print(f"  - ê²°ë¡ : ìœ ì˜í•œ ì°¨ì´")
                    else:
                        print(f"  - ê²°ë¡ : ìœ ì˜í•œ ì°¨ì´ ì—†ìŒ")
else:
    print("âš ï¸ ìœ ë™ì„± ê´€ë ¨ ì»¬ëŸ¼ì´ ë¶€ì¡±í•©ë‹ˆë‹¤")
```

**ì¶œë ¥:**

```
ğŸ“Š ìœ ë™ë¹„ìœ¨ ë° ë‹¹ì¢Œë¹„ìœ¨ ë¶„ì„
================================================================================
âœ… ìœ ë™ë¹„ìœ¨ ê³„ì‚° ì™„ë£Œ
  - í‰ê· : 275.846
  - ì¤‘ì•™ê°’: 1.805
âœ… ë‹¹ì¢Œë¹„ìœ¨ ê³„ì‚° ì™„ë£Œ
  - í‰ê· : 253.696
  - ì¤‘ì•™ê°’: 1.318

ğŸ’§ ìœ ë™ë¹„ìœ¨ ë° ë‹¹ì¢Œë¹„ìœ¨ ë¹„êµ
------------------------------------------------------------
  ì§€í‘œ  ì •ìƒê¸°ì—…(ì¤‘ì•™ê°’)  ë¶€ë„ê¸°ì—…(ì¤‘ì•™ê°’)  ì°¨ì´ìœ¨(%)
ìœ ë™ë¹„ìœ¨      1.811      1.441  20.451
ë‹¹ì¢Œë¹„ìœ¨      1.325      0.922  30.392

```

```

ğŸ“ˆ í†µê³„ì  ìœ ì˜ì„± ê²€ì • (Mann-Whitney U test)
------------------------------------------------------------
ìœ ë™ë¹„ìœ¨:
  - p-value: 1.3994e-08
  - ê²°ë¡ : *** ë§¤ìš° ìœ ì˜í•œ ì°¨ì´ ***
ë‹¹ì¢Œë¹„ìœ¨:
  - p-value: 7.5448e-16
  - ê²°ë¡ : *** ë§¤ìš° ìœ ì˜í•œ ì°¨ì´ ***

```

--------------------------------------------------------------------------------

## [ì½”ë“œ #6]

```python
# í˜„ê¸ˆë¹„ìœ¨ ê³„ì‚° ë° ë¶„ì„
print("ğŸ’° í˜„ê¸ˆë¹„ìœ¨ ê³„ì‚° ë° ë¶„ì„")
print("="*80)

# í˜„ê¸ˆ ê´€ë ¨ ì»¬ëŸ¼ í™•ì¸ ë° í•©ì‚°
cash_components = []
total_cash_stats = {}

print("\n1ï¸âƒ£ í˜„ê¸ˆ ê´€ë ¨ ì»¬ëŸ¼ í™•ì¸:")
print("-"*60)

if 'í˜„ê¸ˆ' in df.columns:
    cash_components.append('í˜„ê¸ˆ')
    cash_mean = df['í˜„ê¸ˆ'].mean()
    cash_nonzero = (df['í˜„ê¸ˆ'] > 0).mean()*100
    print(f"  â€¢ í˜„ê¸ˆ: í‰ê· ={cash_mean:,.0f}ì›, 0ì´ ì•„ë‹Œ ë¹„ìœ¨={cash_nonzero:.1f}%")
    total_cash_stats['í˜„ê¸ˆ'] = {'í‰ê· ': cash_mean, 'ë¹„ìœ¨': cash_nonzero}
    
if 'í˜„ê¸ˆë“±ê°€ë¬¼' in df.columns:
    cash_components.append('í˜„ê¸ˆë“±ê°€ë¬¼')
    cash_eq_mean = df['í˜„ê¸ˆë“±ê°€ë¬¼'].mean()
    cash_eq_nonzero = (df['í˜„ê¸ˆë“±ê°€ë¬¼'] > 0).mean()*100
    print(f"  â€¢ í˜„ê¸ˆë“±ê°€ë¬¼: í‰ê· ={cash_eq_mean:,.0f}ì›, 0ì´ ì•„ë‹Œ ë¹„ìœ¨={cash_eq_nonzero:.1f}%")
    total_cash_stats['í˜„ê¸ˆë“±ê°€ë¬¼'] = {'í‰ê· ': cash_eq_mean, 'ë¹„ìœ¨': cash_eq_nonzero}
    
if 'í˜„ê¸ˆì„±ìì‚°' in df.columns:
    cash_components.append('í˜„ê¸ˆì„±ìì‚°')
    liquid_mean = df['í˜„ê¸ˆì„±ìì‚°'].mean()
    liquid_nonzero = (df['í˜„ê¸ˆì„±ìì‚°'] > 0).mean()*100
    print(f"  â€¢ í˜„ê¸ˆì„±ìì‚°: í‰ê· ={liquid_mean:,.0f}ì›, 0ì´ ì•„ë‹Œ ë¹„ìœ¨={liquid_nonzero:.1f}%")
    total_cash_stats['í˜„ê¸ˆì„±ìì‚°'] = {'í‰ê· ': liquid_mean, 'ë¹„ìœ¨': liquid_nonzero}

# í˜„ê¸ˆ ì´ì•¡ ê³„ì‚°
if cash_components:
    print(f"\nâœ… í˜„ê¸ˆ ê³„ì‚°ì— ì‚¬ìš©ëœ ì»¬ëŸ¼: {' + '.join(cash_components)}")
    df['í˜„ê¸ˆ_total'] = df[cash_components].fillna(0).sum(axis=1)
    
    # í˜„ê¸ˆë¹„ìœ¨ ê³„ì‚°
    if 'ìœ ë™ë¶€ì±„' in df.columns:
        df['í˜„ê¸ˆë¹„ìœ¨'] = df['í˜„ê¸ˆ_total'] / (df['ìœ ë™ë¶€ì±„'] + 1)
        
        print(f"\n2ï¸âƒ£ í˜„ê¸ˆ ì´ì•¡ ë° í˜„ê¸ˆë¹„ìœ¨ í†µê³„:")
        print("-"*60)
        print(f"  â€¢ í˜„ê¸ˆ ì´ì•¡ í‰ê· : {df['í˜„ê¸ˆ_total'].mean():,.0f}ì›")
        print(f"  â€¢ í˜„ê¸ˆ ì´ì•¡ ì¤‘ì•™ê°’: {df['í˜„ê¸ˆ_total'].median():,.0f}ì›")
        print(f"  â€¢ í˜„ê¸ˆ ë³´ìœ  ê¸°ì—…: {(df['í˜„ê¸ˆ_total'] > 0).sum():,}ê°œ ({(df['í˜„ê¸ˆ_total'] > 0).mean()*100:.1f}%)")
        print(f"  â€¢ í˜„ê¸ˆë¹„ìœ¨ í‰ê· : {df['í˜„ê¸ˆë¹„ìœ¨'].mean():.3f}")
        print(f"  â€¢ í˜„ê¸ˆë¹„ìœ¨ ì¤‘ì•™ê°’: {df['í˜„ê¸ˆë¹„ìœ¨'].median():.3f}")
        
        # ì •ìƒê¸°ì—…ê³¼ ë¶€ë„ê¸°ì—… ë¹„êµ
        if target_col in df.columns:
            print(f"\n3ï¸âƒ£ ì •ìƒê¸°ì—… vs ë¶€ë„ê¸°ì—… í˜„ê¸ˆë¹„ìœ¨:")
            print("-"*60)
            
            normal_cash_ratio = df[df[target_col] == 0]['í˜„ê¸ˆë¹„ìœ¨']
            bankrupt_cash_ratio = df[df[target_col] == 1]['í˜„ê¸ˆë¹„ìœ¨']
            
            print(f"ì „ì²´ ê¸°ì—… ëŒ€ìƒ:")
            print(f"  â€¢ ì •ìƒê¸°ì—…: í‰ê· ={normal_cash_ratio.mean():.3f}, ì¤‘ì•™ê°’={normal_cash_ratio.median():.3f}")
            print(f"  â€¢ ë¶€ë„ê¸°ì—…: í‰ê· ={bankrupt_cash_ratio.mean():.3f}, ì¤‘ì•™ê°’={bankrupt_cash_ratio.median():.3f}")
            
            # í˜„ê¸ˆ ë³´ìœ  ê¸°ì—…ë§Œ ë¶„ì„
            cash_positive = df[df['í˜„ê¸ˆë¹„ìœ¨'] > 0]
            if len(cash_positive) > 0:
                normal_cash_pos = cash_positive[cash_positive[target_col] == 0]['í˜„ê¸ˆë¹„ìœ¨']
                bankrupt_cash_pos = cash_positive[cash_positive[target_col] == 1]['í˜„ê¸ˆë¹„ìœ¨']
                
                print(f"\ní˜„ê¸ˆ ë³´ìœ  ê¸°ì—…ë§Œ ({len(cash_positive):,}ê°œ, {len(cash_positive)/len(df)*100:.1f}%):")
                print(f"  â€¢ ì •ìƒê¸°ì—…: í‰ê· ={normal_cash_pos.mean():.3f}, ì¤‘ì•™ê°’={normal_cash_pos.median():.3f}")
                print(f"  â€¢ ë¶€ë„ê¸°ì—…: í‰ê· ={bankrupt_cash_pos.mean():.3f}, ì¤‘ì•™ê°’={bankrupt_cash_pos.median():.3f}")
                
                diff_rate = (normal_cash_pos.median() - bankrupt_cash_pos.median()) / normal_cash_pos.median() * 100
                print(f"  â€¢ ì¤‘ì•™ê°’ ì°¨ì´ìœ¨: {diff_rate:.1f}%")
else:
    print("âš ï¸ í˜„ê¸ˆ ê´€ë ¨ ì»¬ëŸ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤")
```

**ì¶œë ¥:**

```
ğŸ’° í˜„ê¸ˆë¹„ìœ¨ ê³„ì‚° ë° ë¶„ì„
================================================================================

1ï¸âƒ£ í˜„ê¸ˆ ê´€ë ¨ ì»¬ëŸ¼ í™•ì¸:
------------------------------------------------------------
  â€¢ í˜„ê¸ˆ: í‰ê· =9,325ì›, 0ì´ ì•„ë‹Œ ë¹„ìœ¨=3.0%
  â€¢ í˜„ê¸ˆë“±ê°€ë¬¼: í‰ê· =264,974ì›, 0ì´ ì•„ë‹Œ ë¹„ìœ¨=0.3%
  â€¢ í˜„ê¸ˆì„±ìì‚°: í‰ê· =5,178,356ì›, 0ì´ ì•„ë‹Œ ë¹„ìœ¨=36.3%

âœ… í˜„ê¸ˆ ê³„ì‚°ì— ì‚¬ìš©ëœ ì»¬ëŸ¼: í˜„ê¸ˆ + í˜„ê¸ˆë“±ê°€ë¬¼ + í˜„ê¸ˆì„±ìì‚°

2ï¸âƒ£ í˜„ê¸ˆ ì´ì•¡ ë° í˜„ê¸ˆë¹„ìœ¨ í†µê³„:
------------------------------------------------------------
  â€¢ í˜„ê¸ˆ ì´ì•¡ í‰ê· : 5,452,656ì›
  â€¢ í˜„ê¸ˆ ì´ì•¡ ì¤‘ì•™ê°’: 0ì›
  â€¢ í˜„ê¸ˆ ë³´ìœ  ê¸°ì—…: 18,190ê°œ (36.3%)
  â€¢ í˜„ê¸ˆë¹„ìœ¨ í‰ê· : 0.311
  â€¢ í˜„ê¸ˆë¹„ìœ¨ ì¤‘ì•™ê°’: 0.000

3ï¸âƒ£ ì •ìƒê¸°ì—… vs ë¶€ë„ê¸°ì—… í˜„ê¸ˆë¹„ìœ¨:
------------------------------------------------------------
ì „ì²´ ê¸°ì—… ëŒ€ìƒ:
  â€¢ ì •ìƒê¸°ì—…: í‰ê· =0.315, ì¤‘ì•™ê°’=0.000
  â€¢ ë¶€ë„ê¸°ì—…: í‰ê· =0.070, ì¤‘ì•™ê°’=0.000

í˜„ê¸ˆ ë³´ìœ  ê¸°ì—…ë§Œ (18,169ê°œ, 36.3%):
  â€¢ ì •ìƒê¸°ì—…: í‰ê· =0.875, ì¤‘ì•™ê°’=0.171
  â€¢ ë¶€ë„ê¸°ì—…: í‰ê· =0.216, ì¤‘ì•™ê°’=0.045
  â€¢ ì¤‘ì•™ê°’ ì°¨ì´ìœ¨: 73.6%

```

--------------------------------------------------------------------------------

## [ì½”ë“œ #7]

```python
# í˜„ê¸ˆë¹„ìœ¨ ì‹¬ì¸µ ì‹œê°í™”
if 'í˜„ê¸ˆë¹„ìœ¨' in df.columns and target_col in df.columns:
    print("\n" + "="*60)
    print("ğŸ’° í˜„ê¸ˆë¹„ìœ¨ ì¢…í•© ì‹œê°í™”")
    print("="*60)
    
    # 1. í˜„ê¸ˆë¹„ìœ¨ ë¶„í¬ ì‹œê°í™”
    fig = make_subplots(
        rows=2, cols=2,
        subplot_titles=['í˜„ê¸ˆë¹„ìœ¨ ë¶„í¬ (ì „ì²´ ê¸°ì—…)', 
                       'í˜„ê¸ˆë¹„ìœ¨ ë¶„í¬ (í˜„ê¸ˆë³´ìœ  ê¸°ì—…)',
                       'í˜„ê¸ˆë¹„ìœ¨ êµ¬ê°„ë³„ ë¶€ë„ìœ¨', 
                       'ì •ìƒ vs ë¶€ë„ê¸°ì—… í˜„ê¸ˆë¹„ìœ¨'],
        specs=[[{'type': 'histogram'}, {'type': 'histogram'}],
               [{'type': 'bar'}, {'type': 'box'}]],
        vertical_spacing=0.15,  # ì„œë¸Œí”Œë¡¯ ê°„ ìˆ˜ì§ ê°„ê²© ì¦ê°€
        horizontal_spacing=0.12  # ì„œë¸Œí”Œë¡¯ ê°„ ìˆ˜í‰ ê°„ê²© ì¦ê°€
    )
    
    # [í•µì‹¬ ìˆ˜ì • 1] ë¬´í•œëŒ€ ì œê±° ë° ë°ì´í„° ì „ì²˜ë¦¬ í•¨ìˆ˜
    def clean_data(series):
        # ë¬´í•œëŒ€ë¥¼ NaNìœ¼ë¡œ ë³€í™˜ í›„ ì œê±°, ë„ˆë¬´ í° ê°’(ì˜ˆ: 10 ì´ìƒ)ì€ ì‹œê°í™” ì™œê³¡ì„ ë§‰ê¸° ìœ„í•´ ì œì™¸
        return series.replace([np.inf, -np.inf], np.nan).dropna()

    # 1-1. ì „ì²´ ê¸°ì—… í˜„ê¸ˆë¹„ìœ¨ ë¶„í¬ (ë°ì´í„° ì •ì œ ì ìš©)
    # ë²”ìœ„ë¥¼ 0~5 ì •ë„ë¡œ ì œí•œí•˜ì—¬ íˆìŠ¤í† ê·¸ë¨ì´ ì˜ˆì˜ê²Œ ë‚˜ì˜¤ë„ë¡ ìœ ë„
    normal_cash_all = clean_data(df[df[target_col] == 0]['í˜„ê¸ˆë¹„ìœ¨'])
    bankrupt_cash_all = clean_data(df[df[target_col] == 1]['í˜„ê¸ˆë¹„ìœ¨'])
    
    # [í•µì‹¬ ìˆ˜ì • 2] xbins ì†ì„±ìœ¼ë¡œ ë§‰ëŒ€ ê°„ê²© ê°•ì œ ì§€ì •
    # start: ì‹œì‘ì , end: ëì , size: ë§‰ëŒ€ í•˜ë‚˜ì˜ ë„ˆë¹„ (0.05 ë‹¨ìœ„ë¡œ ì´˜ì´˜í•˜ê²Œ)
    bin_settings = dict(start=0, end=3, size=0.1)   

    fig.add_trace(
        go.Histogram(x=normal_cash_all, name='ì •ìƒê¸°ì—…', 
                    xbins=bin_settings,
                    marker_color='royalblue', # ìƒ‰ìƒ ëª…ì‹œ
                    opacity=0.6,              # íˆ¬ëª…ë„ ì„¤ì • (ê²¹ì³ ë³´ì´ê²Œ)
                    histnorm='probability'),
        row=1, col=1
    )
    fig.add_trace(
        go.Histogram(x=bankrupt_cash_all, name='ë¶€ë„ê¸°ì—…', 
                    xbins=bin_settings, 
                    marker_color='firebrick', # ìƒ‰ìƒ ëª…ì‹œ
                    opacity=0.6,
                    histnorm='probability'),
        row=1, col=1
    )
    
    # 1-2. í˜„ê¸ˆë³´ìœ  ê¸°ì—…ë§Œ (í˜„ê¸ˆë¹„ìœ¨ > 0)
    cash_positive = df[df['í˜„ê¸ˆë¹„ìœ¨'] > 0]
    normal_cash_pos = clean_data(cash_positive[cash_positive[target_col] == 0]['í˜„ê¸ˆë¹„ìœ¨'])
    bankrupt_cash_pos = clean_data(cash_positive[cash_positive[target_col] == 1]['í˜„ê¸ˆë¹„ìœ¨'])
    
    fig.add_trace(
        go.Histogram(x=normal_cash_pos, name='ì •ìƒ(í˜„ê¸ˆë³´ìœ )', 
                    xbins=bin_settings,
                    opacity=0.6, histnorm='probability',
                    showlegend=False),
        row=1, col=2
    )
    fig.add_trace(
        go.Histogram(x=bankrupt_cash_pos, name='ë¶€ë„(í˜„ê¸ˆë³´ìœ )', 
                    xbins=bin_settings,
                    opacity=0.6, histnorm='probability',
                    showlegend=False),
        row=1, col=2
    )
    
    
    # 1-3. í˜„ê¸ˆë¹„ìœ¨ êµ¬ê°„ë³„ ë¶€ë„ìœ¨
    cash_ratio_bins = [-0.001, 0, 0.1, 0.2, 0.5, 1.0, np.inf]
    cash_ratio_labels = ['0\n(ë¬´í˜„ê¸ˆ)', '0-0.1', '0.1-0.2', '0.2-0.5', '0.5-1.0', '1.0 ì´ìƒ']
    df['í˜„ê¸ˆë¹„ìœ¨êµ¬ê°„'] = pd.cut(df['í˜„ê¸ˆë¹„ìœ¨'], bins=cash_ratio_bins, labels=cash_ratio_labels)
    
    # êµ¬ê°„ë³„ ë¶€ë„ìœ¨ ê³„ì‚°
    cash_bankruptcy = df.groupby('í˜„ê¸ˆë¹„ìœ¨êµ¬ê°„')[target_col].agg(['count', 'mean'])
    cash_bankruptcy['ë¶€ë„ìœ¨(%)'] = cash_bankruptcy['mean'] * 100
    
    fig.add_trace(
        go.Bar(x=cash_bankruptcy.index.astype(str), 
              y=cash_bankruptcy['ë¶€ë„ìœ¨(%)'],
              text=[f"{v:.2f}%" for v in cash_bankruptcy['ë¶€ë„ìœ¨(%)']],
              textposition='outside',
              marker_color=['red', 'orange', 'yellow', 'lightgreen', 'green', 'darkgreen'][:len(cash_bankruptcy)],
              showlegend=False),
        row=2, col=1
    )
    
    # 1-4. Box plot ë¹„êµ (í˜„ê¸ˆë³´ìœ  ê¸°ì—…ë§Œ)
    fig.add_trace(
        go.Box(y=normal_cash_pos, name='ì •ìƒê¸°ì—…', 
              boxmean='sd', showlegend=False,
              marker_color='lightblue'),
        row=2, col=2
    )
    fig.add_trace(
        go.Box(y=bankrupt_cash_pos, name='ë¶€ë„ê¸°ì—…', 
              boxmean='sd', showlegend=False,
              marker_color='salmon'),
        row=2, col=2
    )
    
    # ë ˆì´ì•„ì›ƒ ì—…ë°ì´íŠ¸
    fig.update_xaxes(title_text="í˜„ê¸ˆë¹„ìœ¨", row=1, col=1)
    fig.update_xaxes(title_text="í˜„ê¸ˆë¹„ìœ¨", row=1, col=2)
    fig.update_xaxes(title_text="í˜„ê¸ˆë¹„ìœ¨ êµ¬ê°„", row=2, col=1)
    fig.update_xaxes(title_text="ê¸°ì—… êµ¬ë¶„", row=2, col=2)
    
    fig.update_yaxes(title_text="í™•ë¥ ", row=1, col=1)
    fig.update_yaxes(title_text="í™•ë¥ ", row=1, col=2)
    fig.update_yaxes(title_text="ë¶€ë„ìœ¨ (%)", row=2, col=1)
    fig.update_yaxes(title_text="í˜„ê¸ˆë¹„ìœ¨", row=2, col=2)
    
    # xì¶• ë²”ìœ„ ì œí•œ (ì´ìƒì¹˜ ì œì™¸)
    fig.update_xaxes(range=[0, 2], row=1, col=1)
    fig.update_xaxes(range=[0, 2], row=1, col=2)
    
    # yì¶• ë²”ìœ„ ì„¤ì • - í…ìŠ¤íŠ¸ê°€ ì˜ë¦¬ì§€ ì•Šë„ë¡
    fig.update_yaxes(range=[0, 2], row=2, col=2)
    max_bankruptcy = cash_bankruptcy['ë¶€ë„ìœ¨(%)'].max()
    fig.update_yaxes(range=[0, max_bankruptcy * 1.3], row=2, col=1)
    
    fig.update_layout(
        height=900,  # ë†’ì´ ì¦ê°€
        title_text="í˜„ê¸ˆë¹„ìœ¨ ì¢…í•© ë¶„ì„",
        title_x=0.5,
        showlegend=True,
        barmode='overlay', # ë‹¤ì‹œ overlayë¡œ ë³€ê²½ 
        bargap=0.1,        # ë§‰ëŒ€ ì‚¬ì´ ê°„ê²© ì•½ê°„ ì¶”ê°€True
        legend=dict(
            orientation="h",
            yanchor="bottom",
            y=-0.15,
            xanchor="center",
            x=0.5,
        ),
        # ì—¬ë°± ì¦ê°€ë¡œ í…ìŠ¤íŠ¸ ê²¹ì¹¨ ë°©ì§€
        margin=dict(t=100, b=100, l=80, r=80)
    )
    
    fig.show()
    
    # í†µê³„ ìš”ì•½ í…Œì´ë¸”
    print("\nğŸ“Š í˜„ê¸ˆë¹„ìœ¨ êµ¬ê°„ë³„ ë¶„ì„")
    print("-" * 60)
    print(f"{'êµ¬ê°„':<15} {'ê¸°ì—…ìˆ˜':>10} {'ë¹„ìœ¨':>10} {'ë¶€ë„ìœ¨':>10}")
    print("-" * 60)
    for idx, row in cash_bankruptcy.iterrows():
        pct = row['count'] / len(df) * 100
        print(f"{str(idx).replace(chr(10), ' '):<15} {row['count']:>10,} {pct:>9.1f}% {row['ë¶€ë„ìœ¨(%)']:>9.2f}%")
    
    # í†µê³„ì  ìœ ì˜ì„± ê²€ì •
    from scipy.stats import mannwhitneyu
    
    if len(normal_cash_pos) > 0 and len(bankrupt_cash_pos) > 0:
        statistic, pvalue = mannwhitneyu(normal_cash_pos, bankrupt_cash_pos, alternative='two-sided')
        print(f"\nğŸ“ˆ í†µê³„ì  ìœ ì˜ì„± ê²€ì • (Mann-Whitney U test)")
        print("-" * 60)
        print(f"  â€¢ ê²€ì •í†µê³„ëŸ‰: {statistic:,.0f}")
        print(f"  â€¢ p-value: {pvalue:.4e}")
        if pvalue < 0.001:
            print("  â€¢ ê²°ë¡ : *** ì •ìƒê¸°ì—…ê³¼ ë¶€ë„ê¸°ì—…ì˜ í˜„ê¸ˆë¹„ìœ¨ ì°¨ì´ê°€ í†µê³„ì ìœ¼ë¡œ ë§¤ìš° ìœ ì˜í•¨ ***")
        elif pvalue < 0.05:
            print("  â€¢ ê²°ë¡ : ì •ìƒê¸°ì—…ê³¼ ë¶€ë„ê¸°ì—…ì˜ í˜„ê¸ˆë¹„ìœ¨ ì°¨ì´ê°€ í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•¨")
        else:
            print("  â€¢ ê²°ë¡ : í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•œ ì°¨ì´ê°€ ì—†ìŒ")
    
    # í•µì‹¬ ì¸ì‚¬ì´íŠ¸
    print("\nğŸ’¡ í•µì‹¬ ì¸ì‚¬ì´íŠ¸")
    print("-" * 60)
    zero_cash_bankruptcy = df[df['í˜„ê¸ˆë¹„ìœ¨'] == 0][target_col].mean()*100
    with_cash_bankruptcy = df[df['í˜„ê¸ˆë¹„ìœ¨'] > 0][target_col].mean()*100
    high_cash_bankruptcy = df[df['í˜„ê¸ˆë¹„ìœ¨'] >= 0.5][target_col].mean()*100
    bankrupt_zero_cash = (df[df[target_col] == 1]['í˜„ê¸ˆë¹„ìœ¨'] == 0).mean() * 100
    
    print(f"  1. í˜„ê¸ˆ ë¯¸ë³´ìœ  ê¸°ì—…ì˜ ë¶€ë„ìœ¨: {zero_cash_bankruptcy:.2f}%")
    print(f"  2. í˜„ê¸ˆ ë³´ìœ  ê¸°ì—…ì˜ ë¶€ë„ìœ¨: {with_cash_bankruptcy:.2f}%")
    print(f"  3. í˜„ê¸ˆë¹„ìœ¨ 0.5 ì´ìƒ ê¸°ì—…ì˜ ë¶€ë„ìœ¨: {high_cash_bankruptcy:.2f}%")
    print(f"  4. ë¶€ë„ê¸°ì—… ì¤‘ í˜„ê¸ˆ ë¯¸ë³´ìœ  ë¹„ìœ¨: {bankrupt_zero_cash:.1f}%")
    
    # ë¦¬ìŠ¤í¬ ë°°ìˆ˜ ê³„ì‚°
    if with_cash_bankruptcy > 0:
        risk_multiple = zero_cash_bankruptcy / with_cash_bankruptcy
        print(f"\n  âš ï¸ í˜„ê¸ˆ ë¯¸ë³´ìœ  ê¸°ì—…ì€ í˜„ê¸ˆ ë³´ìœ  ê¸°ì—… ëŒ€ë¹„ {risk_multiple:.1f}ë°° ë†’ì€ ë¶€ë„ ìœ„í—˜")
```

**ì¶œë ¥:**

```

============================================================
ğŸ’° í˜„ê¸ˆë¹„ìœ¨ ì¢…í•© ì‹œê°í™”
============================================================

```

```

ğŸ“Š í˜„ê¸ˆë¹„ìœ¨ êµ¬ê°„ë³„ ë¶„ì„
------------------------------------------------------------
êµ¬ê°„                     ê¸°ì—…ìˆ˜         ë¹„ìœ¨        ë¶€ë„ìœ¨
------------------------------------------------------------
0 (ë¬´í˜„ê¸ˆ)           31,912.0      63.7%      1.60%
0-0.1              7,200.0      14.4%      2.14%
0.1-0.2            2,613.0       5.2%      1.22%
0.2-0.5            3,681.0       7.3%      0.87%
0.5-1.0            2,304.0       4.6%      0.82%
1.0 ì´ìƒ             2,371.0       4.7%      0.42%

ğŸ“ˆ í†µê³„ì  ìœ ì˜ì„± ê²€ì • (Mann-Whitney U test)
------------------------------------------------------------
  â€¢ ê²€ì •í†µê³„ëŸ‰: 2,919,649
  â€¢ p-value: 6.3097e-18
  â€¢ ê²°ë¡ : *** ì •ìƒê¸°ì—…ê³¼ ë¶€ë„ê¸°ì—…ì˜ í˜„ê¸ˆë¹„ìœ¨ ì°¨ì´ê°€ í†µê³„ì ìœ¼ë¡œ ë§¤ìš° ìœ ì˜í•¨ ***

ğŸ’¡ í•µì‹¬ ì¸ì‚¬ì´íŠ¸
------------------------------------------------------------
  1. í˜„ê¸ˆ ë¯¸ë³´ìœ  ê¸°ì—…ì˜ ë¶€ë„ìœ¨: 1.60%
  2. í˜„ê¸ˆ ë³´ìœ  ê¸°ì—…ì˜ ë¶€ë„ìœ¨: 1.36%
  3. í˜„ê¸ˆë¹„ìœ¨ 0.5 ì´ìƒ ê¸°ì—…ì˜ ë¶€ë„ìœ¨: 0.62%
  4. ë¶€ë„ê¸°ì—… ì¤‘ í˜„ê¸ˆ ë¯¸ë³´ìœ  ë¹„ìœ¨: 67.5%

  âš ï¸ í˜„ê¸ˆ ë¯¸ë³´ìœ  ê¸°ì—…ì€ í˜„ê¸ˆ ë³´ìœ  ê¸°ì—… ëŒ€ë¹„ 1.2ë°° ë†’ì€ ë¶€ë„ ìœ„í—˜

```

--------------------------------------------------------------------------------

## [ì½”ë“œ #8]

```python
# ì§€ê¸‰ë¶ˆëŠ¥ ê´€ë ¨ ì§€í‘œ ìƒì„±
solvency_cols = ['ìì‚°ì´ê³„', 'ë¶€ì±„ì´ê³„', 'ìë³¸ì´ê³„', 'ì´ìµì‰ì—¬ê¸ˆ']
existing_solvency_cols = [col for col in solvency_cols if col in df.columns]

if len(existing_solvency_cols) >= 2:
    # [ìˆ˜ì • 1] ìë³¸ì ì‹ ê³ ë ¤í•œ ë¶€ì±„ë¹„ìœ¨ ê³„ì‚° ë° ìë³¸ì ì‹ ì—¬ë¶€ ìƒì„±
    if 'ìë³¸ì´ê³„' in df.columns:
        # 1. ì™„ì „ ìë³¸ì ì‹ ì—¬ë¶€ (ë¶€ë„ ì‹œê·¸ë„)
        df['ìë³¸ì ì‹ì—¬ë¶€'] = np.where(df['ìë³¸ì´ê³„'] <= 0, 1, 0)
        
        # 2. ë¶€ì±„ë¹„ìœ¨ ê³„ì‚° (ìë³¸ì ì‹ ì‹œ ì™œê³¡ ë°©ì§€)
        if 'ë¶€ì±„ì´ê³„' in df.columns:
            CAP_VALUE = 10000.0 # 10000% ë¡œ ìƒí•œì„  ì„¤ì •
            
            df['ë¶€ì±„ë¹„ìœ¨'] = np.where(
                df['ìë³¸ì´ê³„'] > 0,
                df['ë¶€ì±„ì´ê³„'] / df['ìë³¸ì´ê³„'] * 100,
                CAP_VALUE # ìë³¸ì ì‹ì¸ ê²½ìš° ìµœëŒ€ê°’ ë¶€ì—¬
            )
            print("âœ… ë¶€ì±„ë¹„ìœ¨ ê³„ì‚° ì™„ë£Œ (ìë³¸ì ì‹ ê¸°ì—…ì€ ìµœëŒ€ê°’ 10000% ì²˜ë¦¬)")

    # ìê¸°ìë³¸ë¹„ìœ¨ ê³„ì‚°
    if 'ìë³¸ì´ê³„' in df.columns and 'ìì‚°ì´ê³„' in df.columns:
        df['ìê¸°ìë³¸ë¹„ìœ¨'] = df['ìë³¸ì´ê³„'] / (df['ìì‚°ì´ê³„'] + 1) * 100
    if target_col in df.columns:
        # ìë³¸ì ì‹ê³¼ ë¶€ë„ì˜ ê´€ê³„
        if 'ìë³¸ì ì‹ì—¬ë¶€' in df.columns:
            crosstab = pd.crosstab(df['ìë³¸ì ì‹ì—¬ë¶€'], df[target_col], 
                                  rownames=['ìë³¸ì ì‹'], colnames=['ë¶€ë„ì—¬ë¶€'],
                                  normalize='columns') * 100
            
            print("\nğŸ’° ì§€ê¸‰ë¶ˆëŠ¥(ìë³¸ì ì‹) ë¶„ì„")
            print("="*60)
            print("\nìë³¸ì ì‹ê³¼ ë¶€ë„ì˜ ê´€ê³„ (%)")
            print(crosstab)
        
# ë¶€ì±„ë¹„ìœ¨ ë¶„í¬ ë¹„êµ ë¶€ë¶„ ìˆ˜ì •
        if 'ë¶€ì±„ë¹„ìœ¨' in df.columns:
            # [1] ë°ì´í„° ì •ì œ: ë¬´í•œëŒ€ ì œê±° ë° ì‹œê°í™”ìš© ë²”ìœ„ ì„¤ì •
            # ìë³¸ì ì‹(ë¶€ì±„ë¹„ìœ¨ ìŒìˆ˜)ì´ë‚˜ ì´ìƒì¹˜ëŠ” ì‹œê°í™”ì—ì„œ ì™œê³¡ì„ ì£¼ë¯€ë¡œ
            # ë¶„ì„ ëª©ì ì— ë”°ë¼ í•„í„°ë§í•©ë‹ˆë‹¤. (ì—¬ê¸°ì„œëŠ” ì‹œê°í™”ë¥¼ ìœ„í•´ ê·¹ë‹¨ê°’ë§Œ ì œì™¸)
            def clean_debt_ratio(series):
                # inf ì œê±°
                series = series.replace([np.inf, -np.inf], np.nan).dropna()
                return series

            normal_debt = clean_debt_ratio(df[df[target_col] == 0]['ë¶€ì±„ë¹„ìœ¨'])
            bankrupt_debt = clean_debt_ratio(df[df[target_col] == 1]['ë¶€ì±„ë¹„ìœ¨'])
            
            # ë¶€ì±„ë¹„ìœ¨ êµ¬ê°„ë³„ ë¶€ë„ìœ¨ (ì´ ë¶€ë¶„ì€ ê·¸ëŒ€ë¡œ ìœ ì§€)
            df['ë¶€ì±„ë¹„ìœ¨êµ¬ê°„'] = pd.cut(df['ë¶€ì±„ë¹„ìœ¨'], 
                                     bins=[-np.inf, 100, 200, 300, 500, np.inf],
                                     labels=['100% ë¯¸ë§Œ', '100-200%', '200-300%', '300-500%', '500% ì´ìƒ'])
            
            debt_bankruptcy = df.groupby('ë¶€ì±„ë¹„ìœ¨êµ¬ê°„')[target_col].mean() * 100
            
            # ì‹œê°í™”
            fig = make_subplots(rows=1, cols=2,
                              subplot_titles=['ë¶€ì±„ë¹„ìœ¨ ë¶„í¬ (2000% ì´í•˜ í™•ëŒ€)', 'ë¶€ì±„ë¹„ìœ¨ êµ¬ê°„ë³„ ë¶€ë„ìœ¨'])
            
            # [2] ë°•ìŠ¤í”Œë¡¯ ê°œì„ 
            fig.add_trace(go.Box(
                y=normal_debt, 
                name='ì •ìƒê¸°ì—…', 
                boxpoints=False,  # [í•µì‹¬] ì§€ì €ë¶„í•œ ì´ìƒì¹˜ ì (Outlier)ë“¤ì„ ìˆ¨ê¹€
                boxmean=True,
                marker_color='royalblue'
            ), row=1, col=1)
            
            fig.add_trace(go.Box(
                y=bankrupt_debt, 
                name='ë¶€ë„ê¸°ì—…', 
                boxpoints=False,  # [í•µì‹¬] ì  ìˆ¨ê¹€
                boxmean=True,
                marker_color='salmon'
            ), row=1, col=1)
            
            # ë¶€ë„ìœ¨ ë§‰ëŒ€ê·¸ë˜í”„
            fig.add_trace(go.Bar(x=debt_bankruptcy.index.astype(str), 
                                y=debt_bankruptcy.values,
                                text=[f"{v:.1f}%" for v in debt_bankruptcy.values],
                                textposition='outside',
                                marker_color='teal'), row=1, col=2)
            
            # [3] Yì¶• ë²”ìœ„ ê°•ì œ ê³ ì • (Zoom In)
            # ë°•ìŠ¤í”Œë¡¯ì´ ìˆëŠ” ì²« ë²ˆì§¸ ì„œë¸Œí”Œë¡¯ì˜ Yì¶•ë§Œ ì œí•œí•©ë‹ˆë‹¤.
            # ìë³¸ì ì‹ ë“±ì„ ê³ ë ¤í•´ -50% ë¶€í„°, ìƒí•œì„ ì€ 1000%~2000% ì •ë„ë¡œ ì¡ëŠ” ê²Œ ì¼ë°˜ì ì…ë‹ˆë‹¤.
            fig.update_yaxes(range=[-50, 2000], title="ë¶€ì±„ë¹„ìœ¨(%)", row=1, col=1)
            
            # ë‘ ë²ˆì§¸ ê·¸ë˜í”„ Yì¶• ì„¤ì •
            fig.update_yaxes(title="ë¶€ë„ìœ¨(%)", row=1, col=2)
            max_val = debt_bankruptcy.max()
            fig.update_yaxes(range=[0, max_val * 1.2], row=1, col=2) # í…ìŠ¤íŠ¸ ì˜ë¦¼ ë°©ì§€

            fig.update_layout(height=500, showlegend=True, 
                            title_text="ë¶€ì±„ë¹„ìœ¨ê³¼ ë¶€ë„ ìœ„í—˜ì˜ ê´€ê³„")
            fig.show()
else:
    print("âš ï¸ ì§€ê¸‰ë¶ˆëŠ¥ ê´€ë ¨ ì»¬ëŸ¼ì´ ë¶€ì¡±í•©ë‹ˆë‹¤")
```

**ì¶œë ¥:**

```
âœ… ë¶€ì±„ë¹„ìœ¨ ê³„ì‚° ì™„ë£Œ (ìë³¸ì ì‹ ê¸°ì—…ì€ ìµœëŒ€ê°’ 10000% ì²˜ë¦¬)

ğŸ’° ì§€ê¸‰ë¶ˆëŠ¥(ìë³¸ì ì‹) ë¶„ì„
============================================================

ìë³¸ì ì‹ê³¼ ë¶€ë„ì˜ ê´€ê³„ (%)
ë¶€ë„ì—¬ë¶€      0      1
ìë³¸ì ì‹              
0    93.130 82.477
1     6.870 17.523

```

--------------------------------------------------------------------------------

## [ë§ˆí¬ë‹¤ìš´ #6]

### 3.2 ìˆ˜ìµì„± ì•…í™” ë¶„ì„

--------------------------------------------------------------------------------

## [ì½”ë“œ #9]

```python
# ìˆ˜ìµì„± ê´€ë ¨ ì§€í‘œ ë¶„ì„
# [ìˆ˜ì •] 'ì´ìë¹„ìš©' ì»¬ëŸ¼ì„ ë¶„ì„ ëŒ€ìƒì— ì¶”ê°€
profitability_cols = ['ë§¤ì¶œì•¡', 'ì˜ì—…ì†ìµ', 'ë‹¹ê¸°ìˆœì´ìµ', 'ìì‚°ì´ê³„', 'ìë³¸ì´ê³„', 'ì´ìë¹„ìš©']
existing_prof_cols = [col for col in profitability_cols if col in df.columns]

if len(existing_prof_cols) >= 2:
    # 1. ROE (ìê¸°ìë³¸ì´ìµë¥ ) - ìë³¸ì ì‹ ì°©ì‹œ ì œê±°
    # ìë³¸ì´ 0 ì´í•˜ì¸ ê²½ìš° ROEë¥¼ ê³„ì‚°í•˜ì§€ ì•Šê³  NaN(ê²°ì¸¡) ì²˜ë¦¬í•˜ê±°ë‚˜
    # í˜¹ì€ ë¶„ì„ ëª©ì ì— ë”°ë¼ -9999% ë“± ìµœí•˜ìœ„ ê°’ì„ ë¶€ì—¬í•´ì•¼ í•¨ (ì—¬ê¸°ì„  NaN ì²˜ë¦¬ í›„ ë³„ë„ ì»¬ëŸ¼ìœ¼ë¡œ í”Œë˜ê·¸)
    if 'ë‹¹ê¸°ìˆœì´ìµ' in df.columns and 'ìë³¸ì´ê³„' in df.columns:
        df['ROE'] = np.where(
            df['ìë³¸ì´ê³„'] > 0, 
            df['ë‹¹ê¸°ìˆœì´ìµ'] / df['ìë³¸ì´ê³„'] * 100, 
            np.nan  # ìë³¸ì ì‹ ê¸°ì—…ì˜ ROEëŠ” 'ì •ì˜ë˜ì§€ ì•ŠìŒ' ì²˜ë¦¬
        )
        # ëª¨ë¸ë§ì„ ìœ„í•´ ê²°ì¸¡ì¹˜ë¥¼ ì±„ì›Œì•¼ í•œë‹¤ë©´, ìµœì•…ì˜ ê°’ìœ¼ë¡œ ëŒ€ì²´ (ì„ íƒì‚¬í•­)
        # df['ROE'] = df['ROE'].fillna(-100.0) 

    # 2. ROA (ì´ìì‚°ìˆœì´ìµë¥ ) - '+1' ì œê±° ë° 0 ì²˜ë¦¬
    if 'ë‹¹ê¸°ìˆœì´ìµ' in df.columns and 'ìì‚°ì´ê³„' in df.columns:
        df['ROA'] = np.where(
            df['ìì‚°ì´ê³„'] > 0,
            df['ë‹¹ê¸°ìˆœì´ìµ'] / df['ìì‚°ì´ê³„'] * 100,
            np.nan
        )

    # 3. ì˜ì—…ì´ìµë¥  - '+1' ì œê±°
    if 'ì˜ì—…ì†ìµ' in df.columns and 'ë§¤ì¶œì•¡' in df.columns:
        df['ì˜ì—…ì´ìµë¥ '] = np.where(
            df['ë§¤ì¶œì•¡'] > 0,
            df['ì˜ì—…ì†ìµ'] / df['ë§¤ì¶œì•¡'] * 100,
            np.nan # ë§¤ì¶œì´ 0ì¸ë° ì˜ì—…ì´ìµì´ ë‚˜ëŠ” ê²½ìš°(ê¸°íƒ€ìˆ˜ìµ ë“±) ë¹„ìœ¨ ê³„ì‚° ì œì™¸
        )

    # 4. ìˆœì´ìµë¥  - '+1' ì œê±°
    if 'ë‹¹ê¸°ìˆœì´ìµ' in df.columns and 'ë§¤ì¶œì•¡' in df.columns:
        df['ìˆœì´ìµë¥ '] = np.where(
            df['ë§¤ì¶œì•¡'] > 0,
            df['ë‹¹ê¸°ìˆœì´ìµ'] / df['ë§¤ì¶œì•¡'] * 100,
            np.nan
        )

    # 5. ì´ìë³´ìƒë°°ìœ¨ (ì•ì„œ ìˆ˜ì •í•œ ì™„ë²½í•œ ë¡œì§ ìœ ì§€)
    if 'ì˜ì—…ì†ìµ' in df.columns and 'ì´ìë¹„ìš©' in df.columns:
        def calculate_corrected_icr(row):
            op_income = row['ì˜ì—…ì†ìµ']
            int_expense = row['ì´ìë¹„ìš©']
            if int_expense <= 0: return 100.0 # ë¬´ì°¨ì…/ì´ììˆ˜ìµ ê¸°ì—…
            icr = op_income / int_expense
            if icr > 100.0: return 100.0
            if icr < -100.0: return -100.0
            return icr

        df['ì´ìë³´ìƒë°°ìœ¨'] = df.apply(calculate_corrected_icr, axis=1)

    print("âœ… ì¬ë¬´ì§€í‘œ ê³„ì‚° ì™„ë£Œ: ìë³¸ì ì‹ ì°©ì‹œ ì œê±° ë° ë¶„ëª¨ 0 ì²˜ë¦¬ ë¡œì§ ì ìš©ë¨")

    
    # 3. ë¶€ë„ìœ¨ ë¶„ì„ ë° ì‹œê°í™”
    if target_col in df.columns:
        # [ìˆ˜ì •] ë¶„ì„ ëŒ€ìƒ ì§€í‘œ ë¦¬ìŠ¤íŠ¸ì— 'ì´ìë³´ìƒë°°ìœ¨' ì¶”ê°€
        profitability_metrics = ['ROA', 'ROE', 'ì˜ì—…ì´ìµë¥ ', 'ìˆœì´ìµë¥ ', 'ì´ìë³´ìƒë°°ìœ¨']
        existing_prof_metrics = [m for m in profitability_metrics if m in df.columns]
        
        if existing_prof_metrics:
            # (1) ì ì(ìŒìˆ˜) ê¸°ì—… ë¹„ìœ¨ ë¶„ì„
            deficit_analysis = []
            for metric in existing_prof_metrics:
                normal_deficit = (df[df[target_col] == 0][metric] < 0).mean() * 100
                bankrupt_deficit = (df[df[target_col] == 1][metric] < 0).mean() * 100
                deficit_analysis.append([metric, normal_deficit, bankrupt_deficit])
            
            deficit_df = pd.DataFrame(deficit_analysis, 
                                     columns=['ì§€í‘œ', 'ì •ìƒê¸°ì—… ìŒìˆ˜ë¹„ìœ¨(%)', 'ë¶€ë„ê¸°ì—… ìŒìˆ˜ë¹„ìœ¨(%)'])
            
            print("\nğŸ“‰ ìˆ˜ìµì„± ë° ì´ìë³´ìƒë°°ìœ¨ ë¶„ì„ (ìŒìˆ˜ ë¹„ìœ¨)")
            print("="*60)
            print(deficit_df.to_string(index=False))
            
            # (2) ìƒì„¸ í†µê³„ ìš”ì•½
            print("\n" + "="*80)
            print("ğŸ“Š ì§€í‘œë³„ ìƒì„¸ í†µê³„ (ì •ìƒ vs ë¶€ë„)")
            print("="*80)
            
            stats_data = []
            for metric in existing_prof_metrics:
                normal = df[df[target_col] == 0][metric].dropna()
                bankrupt = df[df[target_col] == 1][metric].dropna()
                
                stats_data.append([
                    metric,
                    normal.median(), bankrupt.median(),
                    normal.mean(), bankrupt.mean(),
                    normal.quantile(0.05), bankrupt.quantile(0.05),
                    normal.quantile(0.95), bankrupt.quantile(0.95)
                ])
            
            stats_df = pd.DataFrame(stats_data, 
                                   columns=['ì§€í‘œ', 'ì •ìƒ ì¤‘ì•™ê°’', 'ë¶€ë„ ì¤‘ì•™ê°’', 
                                          'ì •ìƒ í‰ê· ', 'ë¶€ë„ í‰ê· ',
                                          'ì •ìƒ 5%', 'ë¶€ë„ 5%',
                                          'ì •ìƒ 95%', 'ë¶€ë„ 95%'])
            print(stats_df.round(2).to_string(index=False))
            
            # (3) ì‹œê°í™” (ë™ì  ë ˆì´ì•„ì›ƒ ì ìš©)
            num_metrics = len(existing_prof_metrics)
            titles = []
            for m in existing_prof_metrics:
                titles.append(f'{m} ë¶„í¬ (5-95 Pctl)') 
                titles.append(f'{m} Box Plot')           
            
            fig = make_subplots(
                rows=num_metrics, cols=2,
                subplot_titles=titles,
                specs=[[{'type': 'histogram'}, {'type': 'box'}] for _ in range(num_metrics)],
                vertical_spacing=0.05,
                horizontal_spacing=0.12
            )
            
            colors_normal = 'lightblue'
            colors_bankrupt = 'salmon'
            
            for i, metric in enumerate(existing_prof_metrics):
                if metric in df.columns:
                    normal = df[df[target_col] == 0][metric].dropna()
                    bankrupt = df[df[target_col] == 1][metric].dropna()
                    
                    # 5-95 ë°±ë¶„ìœ„ ë²”ìœ„ ê³„ì‚° (ì‹œê°í™” ê¹”ë”í•˜ê²Œ í•˜ê¸° ìœ„í•¨)
                    if len(normal) > 0 and len(bankrupt) > 0:
                        combined = np.concatenate([normal, bankrupt])
                        p5 = np.percentile(combined, 5)
                        p95 = np.percentile(combined, 95)
                        
                        normal_filtered = normal[(normal >= p5) & (normal <= p95)]
                        bankrupt_filtered = bankrupt[(bankrupt >= p5) & (bankrupt <= p95)]
                        
                        row = i + 1
                        
                        # íˆìŠ¤í† ê·¸ë¨
                        fig.add_trace(go.Histogram(x=normal_filtered, name='ì •ìƒ', 
                                                nbinsx=40, opacity=0.7, histnorm='probability density',
                                                marker_color=colors_normal, showlegend=(i==0), legendgroup='1'), row=row, col=1)
                        fig.add_trace(go.Histogram(x=bankrupt_filtered, name='ë¶€ë„', 
                                                nbinsx=40, opacity=0.7, histnorm='probability density',
                                                marker_color=colors_bankrupt, showlegend=(i==0), legendgroup='2'), row=row, col=1)
                        
                        # Box plot (ê·¹ë‹¨ê°’ ì œì™¸í•œ Yì¶• ì„¤ì •)
                        fig.add_trace(go.Box(y=normal, name='ì •ìƒ', boxmean='sd', 
                                            marker_color=colors_normal, showlegend=False, legendgroup='1'), row=row, col=2)
                        fig.add_trace(go.Box(y=bankrupt, name='ë¶€ë„', boxmean='sd', 
                                            marker_color=colors_bankrupt, showlegend=False, legendgroup='2'), row=row, col=2)
                        
                        # ì¶• ì„¤ì • (ì´ìƒì¹˜ ì œê±°ëœ ë²”ìœ„ë¡œ Zoom)
                        fig.update_xaxes(range=[p5, p95], title_text=metric, row=row, col=1)
                        fig.update_yaxes(range=[p5, p95], title_text=metric, row=row, col=2)
                        
                        # ê¸°ì¤€ì„  (0)
                        fig.add_vline(x=0, line_dash="dash", line_color="red", line_width=1, row=row, col=1)

            fig.update_layout(height=300*num_metrics, title_text="ìˆ˜ìµì„± ë° ì´ìë³´ìƒë°°ìœ¨ ë¶„í¬ ë¹„êµ", showlegend=True)
            fig.show()
            
            # (4) ê·¹ë‹¨ê°’ í†µê³„ ì¶œë ¥
            print("\n" + "="*80)
            print("âš ï¸ ê·¹ë‹¨ê°’ ë¶„ì„ (5% ë¯¸ë§Œ & 95% ì´ˆê³¼)")
            print("="*80)
            for metric in existing_prof_metrics:
                data = df[metric].dropna()
                p5 = data.quantile(0.05)
                p95 = data.quantile(0.95)
                outliers = ((data < p5) | (data > p95)).sum()
                print(f"{metric}: 5%({p5:.2f}) ~ 95%({p95:.2f}), ê·¹ë‹¨ê°’ {outliers}ê°œ í¬í•¨ë¨")

else:
    print("âš ï¸ ìˆ˜ìµì„± ê´€ë ¨ ì»¬ëŸ¼ì´ ë¶€ì¡±í•©ë‹ˆë‹¤")
```

**ì¶œë ¥:**

```
âœ… ì¬ë¬´ì§€í‘œ ê³„ì‚° ì™„ë£Œ: ìë³¸ì ì‹ ì°©ì‹œ ì œê±° ë° ë¶„ëª¨ 0 ì²˜ë¦¬ ë¡œì§ ì ìš©ë¨

ğŸ“‰ ìˆ˜ìµì„± ë° ì´ìë³´ìƒë°°ìœ¨ ë¶„ì„ (ìŒìˆ˜ ë¹„ìœ¨)
============================================================
    ì§€í‘œ  ì •ìƒê¸°ì—… ìŒìˆ˜ë¹„ìœ¨(%)  ë¶€ë„ê¸°ì—… ìŒìˆ˜ë¹„ìœ¨(%)
   ROA        36.576        50.329
   ROE        31.806        37.286
 ì˜ì—…ì´ìµë¥         33.766        44.137
  ìˆœì´ìµë¥         35.879        48.485
ì´ìë³´ìƒë°°ìœ¨        30.661        42.556

================================================================================
ğŸ“Š ì§€í‘œë³„ ìƒì„¸ í†µê³„ (ì •ìƒ vs ë¶€ë„)
================================================================================
    ì§€í‘œ  ì •ìƒ ì¤‘ì•™ê°’  ë¶€ë„ ì¤‘ì•™ê°’    ì •ìƒ í‰ê·     ë¶€ë„ í‰ê·    ì •ìƒ 5%    ë¶€ë„ 5%  ì •ìƒ 95%  ë¶€ë„ 95%
   ROA   2.820  -0.060    3.160  -45.400 -26.790  -45.020  31.590  22.850
   ROE   7.410   3.140   -2.450 -362.740 -71.850 -180.030  88.420 108.130
 ì˜ì—…ì´ìµë¥    3.520   0.940 -364.730 -138.590 -58.800 -146.760  24.930  21.870
  ìˆœì´ìµë¥    2.980   0.130 -271.220 -179.640 -62.020 -172.610  27.720  23.270
ì´ìë³´ìƒë°°ìœ¨   4.160   0.790   18.460    8.950 -42.580  -43.140 100.000 100.000

```

```

================================================================================
âš ï¸ ê·¹ë‹¨ê°’ ë¶„ì„ (5% ë¯¸ë§Œ & 95% ì´ˆê³¼)
================================================================================
ROA: 5%(-26.97) ~ 95%(31.47), ê·¹ë‹¨ê°’ 5010ê°œ í¬í•¨ë¨
ROE: 5%(-72.80) ~ 95%(88.65), ê·¹ë‹¨ê°’ 4660ê°œ í¬í•¨ë¨
ì˜ì—…ì´ìµë¥ : 5%(-60.18) ~ 95%(24.89), ê·¹ë‹¨ê°’ 4968ê°œ í¬í•¨ë¨
ìˆœì´ìµë¥ : 5%(-63.74) ~ 95%(27.68), ê·¹ë‹¨ê°’ 4968ê°œ í¬í•¨ë¨
ì´ìë³´ìƒë°°ìœ¨: 5%(-42.60) ~ 95%(100.00), ê·¹ë‹¨ê°’ 2506ê°œ í¬í•¨ë¨

```

--------------------------------------------------------------------------------

## [ë§ˆí¬ë‹¤ìš´ #7]

## 4. í•œêµ­ ì‹œì¥ íŠ¹í™” ë¶€ë„ íŒ¨í„´

--------------------------------------------------------------------------------

## [ë§ˆí¬ë‹¤ìš´ #8]

### 4.1 ì—…ì¢…ë³„ ë¶€ë„ìœ¨ ë¶„ì„

--------------------------------------------------------------------------------

## [ì½”ë“œ #10]

```python
# ì—…ì¢… ê´€ë ¨ ì»¬ëŸ¼ ì°¾ê¸° ë° í•œêµ­í‘œì¤€ì‚°ì—…ë¶„ë¥˜(KSIC) ë§¤í•‘
industry_cols = [col for col in df.columns if 'ì—…ì¢…' in col]

if industry_cols and target_col in df.columns:
    industry_col = industry_cols[0]
    
    print("\n" + "="*80)
    print("ğŸ“Š í•œêµ­í‘œì¤€ì‚°ì—…ë¶„ë¥˜(KSIC) ë°ì´í„° ë¡œë”© ë° ë§¤í•‘")
    print("="*80)
    
    # KSIC íŒŒì¼ ì½ê¸°
    ksic_file = '../data/[ë¶™ì„3-3] í•œêµ­í‘œì¤€ì‚°ì—…ë¶„ë¥˜(10ì°¨)_í‘œ.xlsx'
    
    try:
        # ì—‘ì…€ íŒŒì¼ì˜ ëª¨ë“  ì‹œíŠ¸ í™•ì¸
        xl_file = pd.ExcelFile(ksic_file)
        print(f"âœ… KSIC íŒŒì¼ ë°œê²¬. ì‹œíŠ¸ ëª©ë¡: {xl_file.sheet_names}")
        
        # ì²« ë²ˆì§¸ ì‹œíŠ¸ ì½ê¸° (ë³´í†µ ì—¬ê¸°ì— ë¶„ë¥˜í‘œê°€ ìˆìŒ)
        ksic_df = pd.read_excel(ksic_file, sheet_name=0)
        print(f"âœ… KSIC ë°ì´í„° ë¡œë”© ì™„ë£Œ: {ksic_df.shape}")
        print(f"   ì»¬ëŸ¼: {list(ksic_df.columns)}")
        
        # KSIC ì»¬ëŸ¼ëª… ì •ë¦¬
        ksic_df.columns = [str(col).strip() for col in ksic_df.columns]
        
        # ì½”ë“œì™€ ì—…ì¢…ëª… ì»¬ëŸ¼ ì°¾ê¸°
        code_col = None
        name_col = None
        
        for col in ksic_df.columns:
            if 'ì½”ë“œ' in col or 'code' in col.lower():
                code_col = col
            if 'ëª…' in col or 'name' in col.lower() or 'ë¶„ë¥˜' in col:
                if name_col is None:  # ì²« ë²ˆì§¸ ë§¤ì¹­ë˜ëŠ” ì»¬ëŸ¼ ì‚¬ìš©
                    name_col = col
        
        print(f"   ë§¤í•‘ ì»¬ëŸ¼ - ì½”ë“œ: {code_col}, ì—…ì¢…ëª…: {name_col}")
        
        # ë§¤í•‘ ë”•ì…”ë„ˆë¦¬ ìƒì„±
        if code_col and name_col:
            # KSIC ì½”ë“œë¥¼ ë¬¸ìì—´ë¡œ ë³€í™˜í•˜ê³  ì •ë¦¬
            ksic_df[code_col] = ksic_df[code_col].astype(str).str.strip()
            ksic_mapping_dict = dict(zip(ksic_df[code_col], ksic_df[name_col]))
            
            # ë°ì´í„°í”„ë ˆì„ì˜ ì—…ì¢… ì½”ë“œë„ ë¬¸ìì—´ë¡œ ë³€í™˜
            df[industry_col] = df[industry_col].astype(str).str.strip()
            
            # ì—…ì¢…ëª… ë§¤í•‘
            df['ì—…ì¢…_ìƒì„¸ëª…'] = df[industry_col].map(ksic_mapping_dict)
            
            # ë§¤í•‘ ì„±ê³µ ë¹„ìœ¨ í™•ì¸
            mapped_count = df['ì—…ì¢…_ìƒì„¸ëª…'].notna().sum()
            total_count = len(df)
            mapping_rate = (mapped_count / total_count) * 100
            
            print(f"\nğŸ“Š ë§¤í•‘ ê²°ê³¼:")
            print(f"   - ì „ì²´ ê¸°ì—…ìˆ˜: {total_count:,}")
            print(f"   - ë§¤í•‘ ì„±ê³µ: {mapped_count:,} ({mapping_rate:.1f}%)")
            print(f"   - ë§¤í•‘ ì‹¤íŒ¨: {total_count - mapped_count:,} ({100-mapping_rate:.1f}%)")
            
            # ë§¤í•‘ ì˜ˆì‹œ ì¶œë ¥
            sample_mapped = df[df['ì—…ì¢…_ìƒì„¸ëª…'].notna()].sample(min(5, mapped_count))
            print("\nğŸ“‹ ë§¤í•‘ ì˜ˆì‹œ:")
            for idx, row in sample_mapped.iterrows():
                print(f"   {row[industry_col]} â†’ {row['ì—…ì¢…_ìƒì„¸ëª…']}")
        
        else:
            print("âš ï¸ KSIC íŒŒì¼ì—ì„œ ì ì ˆí•œ ì½”ë“œ/ì—…ì¢…ëª… ì»¬ëŸ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
            df['ì—…ì¢…_ìƒì„¸ëª…'] = None
            
    except Exception as e:
        print(f"âš ï¸ KSIC íŒŒì¼ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜: {e}")
        df['ì—…ì¢…_ìƒì„¸ëª…'] = None
    
    # ì—…ì¢…ë³„ ë¶€ë„ìœ¨ ê³„ì‚° (ê¸°ë³¸)
    industry_stats = df.groupby(industry_col).agg({
        target_col: ['count', 'sum', 'mean']
    }).round(4)
    
    industry_stats.columns = ['ê¸°ì—…ìˆ˜', 'ë¶€ë„ê¸°ì—…ìˆ˜', 'ë¶€ë„ìœ¨']
    industry_stats['ë¶€ë„ìœ¨(%)'] = industry_stats['ë¶€ë„ìœ¨'] * 100
    industry_stats = industry_stats.sort_values('ë¶€ë„ìœ¨(%)', ascending=False)
    
    print("\n" + "="*80)
    print("ğŸ­ ì—…ì¢…ë³„ ë¶€ë„ìœ¨ ë¶„ì„ (KSIC ì—…ì¢…ëª… í¬í•¨)")
    print("="*80)
    
    # ì—…ì¢…ëª…ì´ ë§¤í•‘ëœ ê²½ìš° í•¨ê»˜ í‘œì‹œ
    if 'ì—…ì¢…_ìƒì„¸ëª…' in df.columns and df['ì—…ì¢…_ìƒì„¸ëª…'].notna().any():
        # ì—…ì¢…ëª… ì •ë³´ë¥¼ industry_statsì— ì¶”ê°€
        ì—…ì¢…ëª…_dict = df.groupby(industry_col)['ì—…ì¢…_ìƒì„¸ëª…'].first()
        industry_stats['ì—…ì¢…ëª…'] = industry_stats.index.map(ì—…ì¢…ëª…_dict)
        
        print("\nìƒìœ„ 15ê°œ ê³ ìœ„í—˜ ì—…ì¢…:")
        print("-"*80)
        print(f"{'ì½”ë“œ':<8} {'ì—…ì¢…ëª…':<40} {'ê¸°ì—…ìˆ˜':>8} {'ë¶€ë„ê¸°ì—…':>8} {'ë¶€ë„ìœ¨(%)':>10}")
        print("-"*80)
        
        for idx, row in industry_stats.head(15).iterrows():
            ì—…ì¢…ëª… = row['ì—…ì¢…ëª…'] if pd.notna(row['ì—…ì¢…ëª…']) else '(ë¯¸ë¶„ë¥˜)'
            ì—…ì¢…ëª… = ì—…ì¢…ëª…[:38] + '..' if len(ì—…ì¢…ëª…) > 38 else ì—…ì¢…ëª…
            print(f"{idx:<8} {ì—…ì¢…ëª…:<40} {row['ê¸°ì—…ìˆ˜']:>8,} {row['ë¶€ë„ê¸°ì—…ìˆ˜']:>8.0f} {row['ë¶€ë„ìœ¨(%)']:>10.2f}")
    else:
        print("\nìƒìœ„ 10ê°œ ê³ ìœ„í—˜ ì—…ì¢…:")
        print(industry_stats[['ê¸°ì—…ìˆ˜', 'ë¶€ë„ê¸°ì—…ìˆ˜', 'ë¶€ë„ìœ¨(%)']].head(10))
    
    # ëŒ€ë¶„ë¥˜ ë¶„ì„
    print("\n" + "="*80)
    print("ğŸ“Š ì—…ì¢… ëŒ€ë¶„ë¥˜ë³„ ë¶€ë„ìœ¨ ë¶„ì„")
    print("="*80)
    
    # ì—…ì¢… ì½”ë“œì˜ ì²« ê¸€ìë¡œ ëŒ€ë¶„ë¥˜ ì¶”ì¶œ
    df['ì—…ì¢…_ëŒ€ë¶„ë¥˜'] = df[industry_col].astype(str).str[0]
    
    # ëŒ€ë¶„ë¥˜ ì„¤ëª… (í•œêµ­í‘œì¤€ì‚°ì—…ë¶„ë¥˜ 10ì°¨ ê¸°ì¤€)
    ëŒ€ë¶„ë¥˜_ì„¤ëª… = {
        'A': 'ë†ì—…, ì„ì—… ë° ì–´ì—…',
        'B': 'ê´‘ì—…',
        'C': 'ì œì¡°ì—…',
        'D': 'ì „ê¸°, ê°€ìŠ¤, ì¦ê¸° ë° ê³µê¸°ì¡°ì ˆ ê³µê¸‰ì—…',
        'E': 'ìˆ˜ë„, í•˜ìˆ˜ ë° íê¸°ë¬¼ ì²˜ë¦¬, ì›ë£Œ ì¬ìƒì—…',
        'F': 'ê±´ì„¤ì—…',
        'G': 'ë„ë§¤ ë° ì†Œë§¤ì—…',
        'H': 'ìš´ìˆ˜ ë° ì°½ê³ ì—…',
        'I': 'ìˆ™ë°• ë° ìŒì‹ì ì—…',
        'J': 'ì •ë³´í†µì‹ ì—…',
        'K': 'ê¸ˆìœµ ë° ë³´í—˜ì—…',
        'L': 'ë¶€ë™ì‚°ì—…',
        'M': 'ì „ë¬¸, ê³¼í•™ ë° ê¸°ìˆ  ì„œë¹„ìŠ¤ì—…',
        'N': 'ì‚¬ì—…ì‹œì„¤ ê´€ë¦¬, ì‚¬ì—… ì§€ì› ë° ì„ëŒ€ ì„œë¹„ìŠ¤ì—…',
        'O': 'ê³µê³µí–‰ì •, êµ­ë°© ë° ì‚¬íšŒë³´ì¥ í–‰ì •',
        'P': 'êµìœ¡ ì„œë¹„ìŠ¤ì—…',
        'Q': 'ë³´ê±´ì—… ë° ì‚¬íšŒë³µì§€ ì„œë¹„ìŠ¤ì—…',
        'R': 'ì˜ˆìˆ , ìŠ¤í¬ì¸  ë° ì—¬ê°€ê´€ë ¨ ì„œë¹„ìŠ¤ì—…',
        'S': 'í˜‘íšŒ ë° ë‹¨ì²´, ìˆ˜ë¦¬ ë° ê¸°íƒ€ ê°œì¸ ì„œë¹„ìŠ¤ì—…',
        'T': 'ê°€êµ¬ ë‚´ ê³ ìš©í™œë™ ë° ë‹¬ë¦¬ ë¶„ë¥˜ë˜ì§€ ì•Šì€ ìê°€ì†Œë¹„ ìƒì‚°í™œë™',
        'U': 'êµ­ì œ ë° ì™¸êµ­ê¸°ê´€'
    }
    
    # ëŒ€ë¶„ë¥˜ë³„ í†µê³„
    major_stats = df.groupby('ì—…ì¢…_ëŒ€ë¶„ë¥˜').agg({
        target_col: ['count', 'sum', 'mean'],
        'ìì‚°ì´ê³„': 'median',
        'ë§¤ì¶œì•¡': 'median'
    }).round(2)
    
    major_stats.columns = ['ê¸°ì—…ìˆ˜', 'ë¶€ë„ê¸°ì—…ìˆ˜', 'ë¶€ë„ìœ¨', 'ìì‚°ì¤‘ì•™ê°’', 'ë§¤ì¶œì¤‘ì•™ê°’']
    major_stats['ë¶€ë„ìœ¨(%)'] = major_stats['ë¶€ë„ìœ¨'] * 100
    major_stats['ëŒ€ë¶„ë¥˜ëª…'] = major_stats.index.map(ëŒ€ë¶„ë¥˜_ì„¤ëª…)
    major_stats = major_stats.sort_values('ë¶€ë„ìœ¨(%)', ascending=False)
    
    print("\nëŒ€ë¶„ë¥˜ë³„ ë¶€ë„ìœ¨ ë° ê·œëª¨:")
    print("-"*100)
    print(f"{'ëŒ€ë¶„ë¥˜':<6} {'ì—…ì¢…ëª…':<35} {'ê¸°ì—…ìˆ˜':>8} {'ë¶€ë„ê¸°ì—…':>8} {'ë¶€ë„ìœ¨(%)':>10} {'ìì‚°ì¤‘ì•™ê°’':>15} {'ë§¤ì¶œì¤‘ì•™ê°’':>15}")
    print("-"*100)
    
    for idx, row in major_stats.head(10).iterrows():
        ëŒ€ë¶„ë¥˜ëª… = row['ëŒ€ë¶„ë¥˜ëª…'] if pd.notna(row['ëŒ€ë¶„ë¥˜ëª…']) else '(ë¯¸ë¶„ë¥˜)'
        ëŒ€ë¶„ë¥˜ëª… = ëŒ€ë¶„ë¥˜ëª…[:33] + '..' if len(ëŒ€ë¶„ë¥˜ëª…) > 33 else ëŒ€ë¶„ë¥˜ëª…
        print(f"{idx:<6} {ëŒ€ë¶„ë¥˜ëª…:<35} {row['ê¸°ì—…ìˆ˜']:>8.0f} {row['ë¶€ë„ê¸°ì—…ìˆ˜']:>8.0f} "
              f"{row['ë¶€ë„ìœ¨(%)']:>10.2f} {row['ìì‚°ì¤‘ì•™ê°’']:>15,.0f} {row['ë§¤ì¶œì¤‘ì•™ê°’']:>15,.0f}")
```

**ì¶œë ¥:**

```

================================================================================
ğŸ“Š í•œêµ­í‘œì¤€ì‚°ì—…ë¶„ë¥˜(KSIC) ë°ì´í„° ë¡œë”© ë° ë§¤í•‘
================================================================================
âœ… KSIC íŒŒì¼ ë°œê²¬. ì‹œíŠ¸ ëª©ë¡: ['10ì°¨ê°œì •í•œêµ­í‘œì¤€ì‚°ì—…ë¶„ë¥˜']
âœ… KSIC ë°ì´í„° ë¡œë”© ì™„ë£Œ: (1199, 10)
   ì»¬ëŸ¼: ['ê°œì • ë¶„ë¥˜ì²´ê³„(ì œ10ì°¨ ê¸°ì¤€)', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', 'Unnamed: 7', 'Unnamed: 8', 'Unnamed: 9']
   ë§¤í•‘ ì»¬ëŸ¼ - ì½”ë“œ: None, ì—…ì¢…ëª…: ê°œì • ë¶„ë¥˜ì²´ê³„(ì œ10ì°¨ ê¸°ì¤€)
âš ï¸ KSIC íŒŒì¼ì—ì„œ ì ì ˆí•œ ì½”ë“œ/ì—…ì¢…ëª… ì»¬ëŸ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

================================================================================
ğŸ­ ì—…ì¢…ë³„ ë¶€ë„ìœ¨ ë¶„ì„ (KSIC ì—…ì¢…ëª… í¬í•¨)
================================================================================

ìƒìœ„ 10ê°œ ê³ ìœ„í—˜ ì—…ì¢…:
          ê¸°ì—…ìˆ˜  ë¶€ë„ê¸°ì—…ìˆ˜  ë¶€ë„ìœ¨(%)
ì—…ì¢…(ì¤‘ë¶„ë¥˜)                     
B08         3      1  33.330
A01       384     15   3.910
J59       220      7   3.180
C11       127      4   3.150
I56       561     17   3.030
L68      2459     71   2.890
J63       215      6   2.790
S94        72      2   2.780
R91       463     11   2.380
C10      1917     40   2.090

================================================================================
ğŸ“Š ì—…ì¢… ëŒ€ë¶„ë¥˜ë³„ ë¶€ë„ìœ¨ ë¶„ì„
================================================================================

ëŒ€ë¶„ë¥˜ë³„ ë¶€ë„ìœ¨ ë° ê·œëª¨:
----------------------------------------------------------------------------------------------------
ëŒ€ë¶„ë¥˜    ì—…ì¢…ëª…                                      ê¸°ì—…ìˆ˜     ë¶€ë„ê¸°ì—…     ë¶€ë„ìœ¨(%)           ìì‚°ì¤‘ì•™ê°’           ë§¤ì¶œì¤‘ì•™ê°’
----------------------------------------------------------------------------------------------------
A      ë†ì—…, ì„ì—… ë° ì–´ì—…                              454       15       3.00       3,514,542       2,786,088
L      ë¶€ë™ì‚°ì—…                                    2459       71       3.00      20,457,121       3,179,163
I      ìˆ™ë°• ë° ìŒì‹ì ì—…                                837       21       3.00       2,397,133       1,226,831
F      ê±´ì„¤ì—…                                     6277      106       2.00       4,422,646       3,978,100
R      ì˜ˆìˆ , ìŠ¤í¬ì¸  ë° ì—¬ê°€ê´€ë ¨ ì„œë¹„ìŠ¤ì—…                      562       12       2.00      14,670,492       3,755,098
M      ì „ë¬¸, ê³¼í•™ ë° ê¸°ìˆ  ì„œë¹„ìŠ¤ì—…                        2563       40       2.00       2,200,483       1,950,893
D      ì „ê¸°, ê°€ìŠ¤, ì¦ê¸° ë° ê³µê¸°ì¡°ì ˆ ê³µê¸‰ì—…                    172        2       1.00      59,090,492      22,081,578
E      ìˆ˜ë„, í•˜ìˆ˜ ë° íê¸°ë¬¼ ì²˜ë¦¬, ì›ë£Œ ì¬ìƒì—…                  512        5       1.00       4,979,718       4,154,071
G      ë„ë§¤ ë° ì†Œë§¤ì—…                               10942      158       1.00       2,761,228       4,224,395
H      ìš´ìˆ˜ ë° ì°½ê³ ì—…                                1433       20       1.00       6,255,816       6,615,142

```

--------------------------------------------------------------------------------

## [ì½”ë“œ #11]

```python
# 1. ì—…ì¢… ì»¬ëŸ¼ í™•ì¸
industry_cols = [col for col in df.columns if 'ì—…ì¢…' in col]

if industry_cols and target_col in df.columns:
    industry_col = industry_cols[0]
    
    print("âš™ï¸ ì—…ì¢…ë³„ ëª¨ë“  ì¬ë¬´ì§€í‘œ ì¬ì§‘ê³„ ì¤‘...")
    
    # ì§‘ê³„í•  ì»¬ëŸ¼ ì •ì˜
    # ë¶€ë„ìœ¨ì€ í‰ê· , ê¸°ì—…ìˆ˜ëŠ” ì¹´ìš´íŠ¸, ë‚˜ë¨¸ì§€ëŠ” ì¤‘ì•™ê°’(Median)
    agg_dict = {target_col: ['mean', 'count']} 
    
    # í•„ìš”í•œ ì»¬ëŸ¼ì´ ìˆëŠ”ì§€ í™•ì¸ í›„ ì¶”ê°€
    metrics = ['ë¶€ì±„ë¹„ìœ¨', 'ROA', 'ìœ ë™ë¹„ìœ¨', 'í˜„ê¸ˆë¹„ìœ¨']
    for m in metrics:
        if m in df.columns:
            agg_dict[m] = 'median'
            
    # ì—…ì¢…ë³„ ê·¸ë£¹í™” ë° ì§‘ê³„
    industry_financial = df.groupby(industry_col).agg(agg_dict)
    
    # MultiIndex ì»¬ëŸ¼ í‰íƒ„í™” (ì˜ˆ: ('ë¶€ë„', 'mean') -> 'ë¶€ë„')
    industry_financial.columns = [
        'ê¸°ì—…ìˆ˜' if col[1] == 'count' else 
        col[0] if col[1] == '' or col[1] == 'median' else col[0] 
        for col in industry_financial.columns
    ]
    
    # ì»¬ëŸ¼ëª… ì¤‘ë³µ ë°©ì§€ë¥¼ ìœ„í•´ ëª…ì‹œì  ì§€ì •
    # ìˆœì„œê°€ ë³´ì¥ë˜ì§€ ì•Šì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì•ˆì „í•˜ê²Œ ë§¤í•‘
    temp_cols = {}
    if (target_col, 'mean') in df.groupby(industry_col).agg(agg_dict).columns:
         # ìœ„ ì½”ë“œë¡œ í‰íƒ„í™”ê°€ ë˜ì—ˆìœ¼ë¯€ë¡œ, ì‹¤ì œ ì»¬ëŸ¼ëª… í™•ì¸ í•„ìš”
         pass 

    # ê°€ì¥ í™•ì‹¤í•œ ë°©ë²•: ì»¬ëŸ¼ ì´ë¦„ ì •ë¦¬
    # agg ê²°ê³¼ì˜ ì»¬ëŸ¼ ìˆœì„œëŠ” ë”•ì…”ë„ˆë¦¬ í‚¤ ìˆœì„œì™€ ê°™ê±°ë‚˜ ì•ŒíŒŒë²³ìˆœì¼ ìˆ˜ ìˆìŒ
    # ë”°ë¼ì„œ ì§ì ‘ ì»¬ëŸ¼ì„ í™•ì¸í•˜ê³  ì¬í• ë‹¹í•˜ëŠ” ê²ƒì´ ì•ˆì „í•¨.
    
    # ë‹¤ì‹œ ì‹¬í”Œí•˜ê²Œ ì ‘ê·¼
    industry_financial = pd.DataFrame()
    industry_financial['ë¶€ë„ìœ¨'] = df.groupby(industry_col)[target_col].mean()
    industry_financial['ê¸°ì—…ìˆ˜'] = df.groupby(industry_col)[target_col].count()
    
    for m in metrics:
        if m in df.columns:
            industry_financial[m] = df.groupby(industry_col)[m].median()

    # ì—…ì¢…ëª… ë§¤í•‘ (ì—…ì¢…_ìƒì„¸ëª… ì»¬ëŸ¼ì´ ìˆë‹¤ë©´)
    if 'ì—…ì¢…_ìƒì„¸ëª…' in df.columns:
        code_to_name = df.dropna(subset=[industry_col, 'ì—…ì¢…_ìƒì„¸ëª…']).set_index(industry_col)['ì—…ì¢…_ìƒì„¸ëª…'].to_dict()
        industry_financial.index = industry_financial.index.map(lambda x: code_to_name.get(x, x))

    print(f"âœ… ì§‘ê³„ ì™„ë£Œ. í¬í•¨ëœ ì»¬ëŸ¼: {list(industry_financial.columns)}")
else:
    print("âš ï¸ ì—…ì¢… ì»¬ëŸ¼ì´ ì—†ìŠµë‹ˆë‹¤.")
```

**ì¶œë ¥:**

```
âš™ï¸ ì—…ì¢…ë³„ ëª¨ë“  ì¬ë¬´ì§€í‘œ ì¬ì§‘ê³„ ì¤‘...
âœ… ì§‘ê³„ ì™„ë£Œ. í¬í•¨ëœ ì»¬ëŸ¼: ['ë¶€ë„ìœ¨', 'ê¸°ì—…ìˆ˜', 'ë¶€ì±„ë¹„ìœ¨', 'ROA', 'ìœ ë™ë¹„ìœ¨', 'í˜„ê¸ˆë¹„ìœ¨']

```

--------------------------------------------------------------------------------

## [ì½”ë“œ #12]

```python
# ê°œë³„ ì‹œê°í™” - 2. ì—…ì¢…ë³„ ë¦¬ìŠ¤í¬ ë§¤í•‘ (ë¶€ì±„ë¹„ìœ¨ vs ROA)
# í•„ìˆ˜ ì»¬ëŸ¼ í™•ì¸
if 'ë¶€ì±„ë¹„ìœ¨' in industry_financial.columns and 'ROA' in industry_financial.columns:
    print("\n" + "="*60)
    print("ğŸ“Š [ì°¨íŠ¸ 2] ì—…ì¢…ë³„ ë¦¬ìŠ¤í¬ ë§¤í•‘ - ë¶€ì±„ë¹„ìœ¨ vs ROA")
    print("="*60)
    
    fig2 = go.Figure()
    
    # í…ìŠ¤íŠ¸ í‘œì‹œ ê¸°ì¤€: ë¶€ë„ìœ¨ì´ ë†’ê±°ë‚˜(ìƒìœ„ê¶Œ) íŠ¹ì • ê¸°ì¤€ ì´ìƒì¸ ê²½ìš°
    # ëª¨ë“  ì ì— í…ìŠ¤íŠ¸ë¥¼ ë„£ìœ¼ë©´ ì§€ì €ë¶„í•˜ë¯€ë¡œ í•„í„°ë§
    texts = []
    avg_bankruptcy = df[target_col].mean() # ì „ì²´ í‰ê·  ë¶€ë„ìœ¨
    
    for idx in industry_financial.index:
        # ë¶€ë„ìœ¨ì´ í‰ê· ë³´ë‹¤ 1.5ë°° ë†’ê±°ë‚˜, ë¶€ì±„ë¹„ìœ¨ì´ 200% ë„˜ìœ¼ë©´ì„œ ì ìì¸ ê²½ìš° í‘œì‹œ
        is_risky = (industry_financial.loc[idx, 'ë¶€ë„ìœ¨'] > avg_bankruptcy * 1.5)
        is_bad_financial = (industry_financial.loc[idx, 'ë¶€ì±„ë¹„ìœ¨'] > 200) and (industry_financial.loc[idx, 'ROA'] < 0)
        
        if is_risky or is_bad_financial:
            # í…ìŠ¤íŠ¸ê°€ ë„ˆë¬´ ê¸¸ë©´ ì¤„ì„ (...)
            txt = str(idx)
            if len(txt) > 12: txt = txt[:12] + ".."
            texts.append(txt)
        else:
            texts.append('')
    
    # ë²„ë¸” ì°¨íŠ¸ ìƒì„±
    fig2.add_trace(
        go.Scatter(
            x=industry_financial['ë¶€ì±„ë¹„ìœ¨'],
            y=industry_financial['ROA'],
            mode='markers+text',
            marker=dict(
                # ë²„ë¸” í¬ê¸°: ë¶€ë„ìœ¨ì— ë¹„ë¡€ (ê°•ì¡° íš¨ê³¼)
                # ê°’ì´ ë„ˆë¬´ ì‘ìœ¼ë©´ ì•ˆ ë³´ì´ë¯€ë¡œ ê¸°ë³¸ê°’(5) + ê°€ì¤‘ì¹˜
                size=industry_financial['ë¶€ë„ìœ¨'] * 1000 + 8, 
                
                # ìƒ‰ìƒ: ë¶€ë„ìœ¨ (ì§„í•œ ë¹¨ê°•ì¼ìˆ˜ë¡ ìœ„í—˜)
                color=industry_financial['ë¶€ë„ìœ¨'] * 100,
                colorscale='Reds',
                showscale=True,
                colorbar=dict(
                    title="ë¶€ë„ìœ¨(%)",
                    tickformat=".1f"
                ),
                line=dict(color='white', width=1), # í…Œë‘ë¦¬
                opacity=0.85
            ),
            text=texts,
            textposition='top center',
            textfont=dict(size=10, color='black'),
            
            # í˜¸ë²„ ì •ë³´ ì„¤ì •
            hovertemplate='<b>%{hovertext}</b><br>' +
                          'ë¶€ì±„ë¹„ìœ¨: %{x:.0f}%<br>' +
                          'ROA: %{y:.2f}%<br>' +
                          'ë¶€ë„ìœ¨: %{customdata:.2f}%<extra></extra>',
            hovertext=industry_financial.index,
            customdata=industry_financial['ë¶€ë„ìœ¨'] * 100,
            showlegend=False
        )
    )
    
    # ì°¸ì¡°ì„  ì¶”ê°€
    fig2.add_hline(y=0, line_dash="dash", line_color="gray", line_width=1,
                   annotation_text="ì†ìµë¶„ê¸°ì  (ROA 0%)")
    fig2.add_vline(x=200, line_dash="dash", line_color="gray", line_width=1,
                   annotation_text="ë¶€ì±„ë¹„ìœ¨ 200% ê²½ê³„")
    
    # ì°¨íŠ¸ ë²”ìœ„ ì„¤ì • (ì´ìƒì¹˜ë¡œ ì¸í•œ ì°Œê·¸ëŸ¬ì§ ë°©ì§€)
    # 95% ë°±ë¶„ìœ„ìˆ˜ ë“±ì„ í™œìš©í•´ ì ì ˆí•œ ì¤Œì¸(Zoom-in) ë²”ìœ„ ì„¤ì •
    max_debt = min(industry_financial['ë¶€ì±„ë¹„ìœ¨'].quantile(0.95) * 1.3, 1000)
    min_roa = max(industry_financial['ROA'].quantile(0.05) * 1.3, -50)
    max_roa = min(industry_financial['ROA'].quantile(0.95) * 1.3, 50)
    
    fig2.update_xaxes(range=[0, max_debt], title='ë¶€ì±„ë¹„ìœ¨ (%, ì¤‘ì•™ê°’)')
    fig2.update_yaxes(range=[min_roa, max_roa], title='ROA (%, ì¤‘ì•™ê°’)')
    
    # ê³ ìœ„í—˜ êµ¬ì—­ í‘œì‹œ (ìš°ì¸¡ í•˜ë‹¨: ê³ ë¶€ì±„ & ì ì)
    fig2.add_shape(
        type="rect",
        x0=200, x1=max_debt,
        y0=min_roa, y1=0,
        fillcolor="red", opacity=0.08,
        line=dict(width=0),
        layer="below"
    )
    
    # ë ˆì´ì•„ì›ƒ ì„¤ì •
    fig2.update_layout(
        title='<b>ì—…ì¢…ë³„ ë¦¬ìŠ¤í¬ ë§¤í•‘ (ë¶€ì±„ë¹„ìœ¨ vs ROA)</b><br><sub>(ì› í¬ê¸°/ìƒ‰ìƒ = ë¶€ë„ìœ¨, ìš°í•˜ë‹¨ ë¶‰ì€ ì˜ì—­ = ê³ ìœ„í—˜êµ°)</sub>',
        height=700,
        width=900,
        template='plotly_white',
        margin=dict(l=80, r=80, t=100, b=80),
        annotations=[
            dict(
                x=max_debt * 0.9,
                y=min_roa * 0.9,
                text="<b>ê³ ìœ„í—˜ êµ¬ì¡°</b><br>(ê³ ë¶€ì±„ & ìˆ˜ìµì„± ì•…í™”)",
                showarrow=False,
                font=dict(color="red", size=12),
                bgcolor="rgba(255,255,255,0.8)",
                bordercolor="red",
                borderwidth=1
            )
        ]
    )
    
    fig2.show()
    
    # í…ìŠ¤íŠ¸ ë¦¬í¬íŠ¸: ê³ ìœ„í—˜ êµ¬ì—­ ì—…ì¢… ì¶œë ¥
    high_risk_zone = industry_financial[
        (industry_financial['ë¶€ì±„ë¹„ìœ¨'] > 200) & 
        (industry_financial['ROA'] < 0)
    ].sort_values('ë¶€ë„ìœ¨', ascending=False)
    
    if len(high_risk_zone) > 0:
        print("\nâš ï¸ [ê²½ê³ ] êµ¬ì¡°ì  ê³ ìœ„í—˜ ì—…ì¢… (ë¶€ì±„ë¹„ìœ¨ > 200% & ROA < 0):")
        print(f"{'ì—…ì¢…':<20} {'ë¶€ë„ìœ¨(%)':>10} {'ë¶€ì±„ë¹„ìœ¨':>10} {'ROA':>8}")
        print("-" * 60)
        for idx in high_risk_zone.index:
            name = str(idx)
            if len(name) > 18: name = name[:18] + ".."
            
            print(f"{name:<20} {high_risk_zone.loc[idx, 'ë¶€ë„ìœ¨']*100:>10.2f} "
                  f"{high_risk_zone.loc[idx, 'ë¶€ì±„ë¹„ìœ¨']:>10.0f} "
                  f"{high_risk_zone.loc[idx, 'ROA']:>8.1f}")
else:
    print("âš ï¸ ë¶€ì±„ë¹„ìœ¨ ë˜ëŠ” ROA ì»¬ëŸ¼ì´ ì—†ì–´ ì°¨íŠ¸ 2ë¥¼ ê·¸ë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
```

**ì¶œë ¥:**

```

============================================================
ğŸ“Š [ì°¨íŠ¸ 2] ì—…ì¢…ë³„ ë¦¬ìŠ¤í¬ ë§¤í•‘ - ë¶€ì±„ë¹„ìœ¨ vs ROA
============================================================

```

```

âš ï¸ [ê²½ê³ ] êµ¬ì¡°ì  ê³ ìœ„í—˜ ì—…ì¢… (ë¶€ì±„ë¹„ìœ¨ > 200% & ROA < 0):
ì—…ì¢…                       ë¶€ë„ìœ¨(%)       ë¶€ì±„ë¹„ìœ¨      ROA
------------------------------------------------------------
B08                       33.33      10000     -7.3
L68                        2.89        405     -0.2
I55                        1.45        496     -1.8
O84                        0.00        490     -1.4
S96                        0.00        284     -0.1

```

--------------------------------------------------------------------------------

## [ì½”ë“œ #13]

```python
# ê°œë³„ ì‹œê°í™” - 3. ì—…ì¢…ë³„ ìœ ë™ì„± vs ë¶€ë„ìœ¨
# ë°ì´í„° ì¤€ë¹„ ë‹¨ê³„ì—ì„œ 'ìœ ë™ë¹„ìœ¨'ê³¼ 'í˜„ê¸ˆë¹„ìœ¨'ì´ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸
if 'ìœ ë™ë¹„ìœ¨' in industry_financial.columns and 'í˜„ê¸ˆë¹„ìœ¨' in industry_financial.columns:
    print("\n" + "="*60)
    print("ğŸ“Š [ì°¨íŠ¸ 3] ì—…ì¢…ë³„ ìœ ë™ì„± ë¶„ì„ - ìœ ë™ë¹„ìœ¨ vs ë¶€ë„ìœ¨")
    print("="*60)
    
    fig3 = go.Figure()
    
    # ìœ ë™ì„± ìœ„ê¸° ì—…ì¢… ì‹ë³„ (ìœ ë™ë¹„ìœ¨ 100% ë¯¸ë§Œ)
    # ë°ì´í„° ìŠ¤ì¼€ì¼ í™•ì¸: ìœ ë™ë¹„ìœ¨ì´ 1.0 ë‹¨ìœ„ì¸ì§€ 100 ë‹¨ìœ„ì¸ì§€ í™•ì¸ í•„ìš”
    # ë³´í†µ ë¹„ìœ¨ì€ 1.0, 0.5 ë“±ìœ¼ë¡œ ë˜ì–´ìˆë‹¤ê³  ê°€ì • (1.0 = 100%)
    threshold = 1.0 
    if industry_financial['ìœ ë™ë¹„ìœ¨'].median() > 50: # ë§Œì•½ 100ë‹¨ìœ„ë¼ë©´
        threshold = 100
        
    liquidity_crisis = industry_financial['ìœ ë™ë¹„ìœ¨'] < threshold
    
    # ìƒ‰ìƒ ë° ì‹¬ë³¼ ì„¤ì •
    symbols = ['diamond' if crisis else 'circle' for crisis in liquidity_crisis]
    
    fig3.add_trace(
        go.Scatter(
            x=industry_financial['ìœ ë™ë¹„ìœ¨'],
            y=industry_financial['ë¶€ë„ìœ¨'] * 100, # ë¶€ë„ìœ¨ì„ %ë¡œ ë³€í™˜
            mode='markers+text',
            marker=dict(
                # ë²„ë¸” í¬ê¸°: ê¸°ì—…ìˆ˜ ë¹„ë¡€ (ìµœì†Œ í¬ê¸° ë³´ì¥)
                size=industry_financial['ê¸°ì—…ìˆ˜'].apply(lambda x: max(5, x/30)),  
                color=industry_financial['í˜„ê¸ˆë¹„ìœ¨'],
                colorscale='Blues',
                showscale=True,
                colorbar=dict(
                    title="í˜„ê¸ˆë¹„ìœ¨",
                    tickformat=".2f"
                ),
                symbol=symbols,
                line=dict(color='darkblue', width=1),
                opacity=0.8
            ),
            # í…ìŠ¤íŠ¸: ìœ ë™ì„± ìœ„ê¸°ê±°ë‚˜ ë¶€ë„ìœ¨ì´ ë†’ì€(2.5% ì´ìƒ) ê²½ìš°ë§Œ í‘œì‹œ
            text=[idx if (industry_financial.loc[idx, 'ìœ ë™ë¹„ìœ¨'] < threshold) or 
                      (industry_financial.loc[idx, 'ë¶€ë„ìœ¨'] > 0.025) 
                  else '' for idx in industry_financial.index],
            textposition='top center',
            textfont=dict(size=10),
            hovertemplate='<b>%{hovertext}</b><br>' +
                          'ìœ ë™ë¹„ìœ¨: %{x:.2f}<br>' +
                          'ë¶€ë„ìœ¨: %{y:.2f}%<br>' +
                          'ê¸°ì—…ìˆ˜: %{customdata:,}ê°œ<extra></extra>',
            hovertext=industry_financial.index,
            customdata=industry_financial['ê¸°ì—…ìˆ˜'],
            showlegend=False
        )
    )
    
    # ìœ„í—˜ì„  ì¶”ê°€ (ìœ ë™ë¹„ìœ¨ 1.0 or 100)
    fig3.add_vline(x=threshold, line_dash="dash", line_color="red", line_width=2,
                   annotation_text="ìœ ë™ë¹„ìœ¨ ìœ„í—˜ì„ ")
    
    # ì „ì²´ í‰ê·  ë¶€ë„ìœ¨ ì„ 
    avg_rate = df[target_col].mean() * 100
    fig3.add_hline(y=avg_rate, line_dash="dot", line_color="green", 
                   line_width=1,
                   annotation_text=f"í‰ê·  ë¶€ë„ìœ¨ ({avg_rate:.2f}%)")
    
    # ìœ„í—˜ êµ¬ì—­ í‘œì‹œ (ë°°ê²½)
    max_y = industry_financial['ë¶€ë„ìœ¨'].max() * 100
    fig3.add_shape(
        type="rect",
        x0=0, x1=threshold,
        y0=0, y1=max_y * 1.1,
        fillcolor="red", opacity=0.1,
        line=dict(width=0),
        layer="below"
    )
    
    # Xì¶• ë²”ìœ„ ì„¤ì • (ì´ìƒì¹˜ë¡œ ì¸í•œ ê·¸ë˜í”„ ì™œê³¡ ë°©ì§€)
    max_x = industry_financial['ìœ ë™ë¹„ìœ¨'].quantile(0.95) * 1.5
    fig3.update_xaxes(range=[0, max_x])
    
    fig3.update_layout(
        title='<b>ì—…ì¢…ë³„ ìœ ë™ì„± vs ë¶€ë„ìœ¨</b><br><sub>(ë²„ë¸” í¬ê¸°=ê¸°ì—…ìˆ˜, ì§„í•œ íŒŒë‘=ë†’ì€ í˜„ê¸ˆë¹„ìœ¨)</sub>',
        xaxis_title='ìœ ë™ë¹„ìœ¨ (ì¤‘ì•™ê°’)',
        yaxis_title='ë¶€ë„ìœ¨ (%)',
        height=600,
        width=900,
        template='plotly_white',
        margin=dict(l=80, r=150, t=80, b=80),
        annotations=[
            dict(
                x=threshold * 0.5,
                y=max_y * 0.9,
                text="<b>ìœ ë™ì„± ìœ„ê¸° êµ¬ì—­</b><br>(ë‹¨ê¸° ì§€ê¸‰ëŠ¥ë ¥ ë¶€ì¡±)",
                showarrow=False,
                font=dict(color="red", size=12),
                bgcolor="rgba(255,255,255,0.8)",
                bordercolor="red",
                borderwidth=1
            )
        ]
    )
    
    fig3.show()
    
    # ìœ ë™ì„± ìœ„ê¸° ì—…ì¢… ìƒì„¸ ë¦¬í¬íŠ¸
    crisis_industries = industry_financial[industry_financial['ìœ ë™ë¹„ìœ¨'] < threshold].sort_values('ë¶€ë„ìœ¨', ascending=False)
    
    if len(crisis_industries) > 0:
        print("\nğŸ’§ [ê²½ê³ ] ìœ ë™ì„± ë¶€ì¡± ì—…ì¢… (ìœ ë™ë¹„ìœ¨ < 1.0):")
        print(f"{'ì—…ì¢…':<20} {'ìœ ë™ë¹„ìœ¨':>10} {'í˜„ê¸ˆë¹„ìœ¨':>10} {'ë¶€ë„ìœ¨(%)':>12} {'ê¸°ì—…ìˆ˜':>8}")
        print("-" * 70)
        for idx in crisis_industries.index:
            # ì—…ì¢…ëª… ê¸¸ì´ ì¡°ì ˆ
            name = str(idx)
            if len(name) > 18: name = name[:18] + ".."
            
            print(f"{name:<20} {crisis_industries.loc[idx, 'ìœ ë™ë¹„ìœ¨']:>10.2f} "
                  f"{crisis_industries.loc[idx, 'í˜„ê¸ˆë¹„ìœ¨']:>10.3f} "
                  f"{crisis_industries.loc[idx, 'ë¶€ë„ìœ¨']*100:>12.2f} "
                  f"{crisis_industries.loc[idx, 'ê¸°ì—…ìˆ˜']:>8.0f}")
else:
    print("âš ï¸ ìœ ë™ë¹„ìœ¨ ë˜ëŠ” í˜„ê¸ˆë¹„ìœ¨ ì»¬ëŸ¼ì´ ì—†ì–´ ì°¨íŠ¸ 3ì„ ê·¸ë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
```

**ì¶œë ¥:**

```

============================================================
ğŸ“Š [ì°¨íŠ¸ 3] ì—…ì¢…ë³„ ìœ ë™ì„± ë¶„ì„ - ìœ ë™ë¹„ìœ¨ vs ë¶€ë„ìœ¨
============================================================

```

```

ğŸ’§ [ê²½ê³ ] ìœ ë™ì„± ë¶€ì¡± ì—…ì¢… (ìœ ë™ë¹„ìœ¨ < 1.0):
ì—…ì¢…                         ìœ ë™ë¹„ìœ¨       í˜„ê¸ˆë¹„ìœ¨       ë¶€ë„ìœ¨(%)      ê¸°ì—…ìˆ˜
----------------------------------------------------------------------
B08                        0.05      0.037        33.33        3
R91                        0.61      0.028         2.38      463
I55                        0.32      0.006         1.45      276
H51                        0.50      0.074         0.00       19
O84                        0.90      0.000         0.00        3

```

--------------------------------------------------------------------------------

## [ì½”ë“œ #14]

```python


# [í•µì‹¬ ìˆ˜ì •] target_col(ê¸´ ì´ë¦„) ëŒ€ì‹  'ë¶€ë„ìœ¨'ê³¼ 'ê¸°ì—…ìˆ˜' ì»¬ëŸ¼ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.
# ë°ì´í„°ê°€ ë¬¸ìë¡œ ì¸ì‹ë˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ê°•ì œ ìˆ«ì ë³€í™˜
if 'ê¸°ì—…ìˆ˜' in industry_financial.columns:
    industry_financial['ê¸°ì—…ìˆ˜'] = pd.to_numeric(industry_financial['ê¸°ì—…ìˆ˜'], errors='coerce')

if 'ë¶€ë„ìœ¨' in industry_financial.columns:
    industry_financial['ë¶€ë„ìœ¨'] = pd.to_numeric(industry_financial['ë¶€ë„ìœ¨'], errors='coerce')

# 0 ì´í•˜ì¸ ê°’ ì œê±° (ë¡œê·¸ ìŠ¤ì¼€ì¼ ì˜¤ë¥˜ ë°©ì§€)
valid_data = industry_financial[industry_financial['ê¸°ì—…ìˆ˜'] > 0].copy()

if 'ê¸°ì—…ìˆ˜' in valid_data.columns and not valid_data.empty:
    print("\n" + "="*60)
    print("ğŸ“Š [ì°¨íŠ¸ 4] ì—…ì¢… ê·œëª¨ì™€ ë¶€ë„ìœ¨ ê´€ê³„ (ìµœì¢… ìˆ˜ì •)")
    print("="*60)
    
    fig4 = go.Figure()
    
    # [ê°•ì œ í•´ê²° 2] Xì¶• ë²”ìœ„ë¥¼ ë°ì´í„°ì— ë§ì¶° ë¯¸ë¦¬ ê³„ì‚° (ë¡œê·¸ ìŠ¤ì¼€ì¼ìš©)
    x_min_val = valid_data['ê¸°ì—…ìˆ˜'].min()
    x_max_val = valid_data['ê¸°ì—…ìˆ˜'].max()
    
    # ë¡œê·¸ ìŠ¤ì¼€ì¼ range ê³„ì‚° (ì—¬ìœ  ê³µê°„ í™•ë³´)
    # x_min_valì´ 0ì´ë©´ log10(0)ì€ -infê°€ ë˜ë¯€ë¡œ ë°©ì–´ ì½”ë“œ ì¶”ê°€
    if x_min_val <= 0: x_min_val = 1
        
    log_range_min = np.log10(x_min_val) - 0.2 
    log_range_max = np.log10(x_max_val) + 0.5
    
    # í…ìŠ¤íŠ¸ í‘œì‹œ ê¸°ì¤€
    median_count = valid_data['ê¸°ì—…ìˆ˜'].median()
    # ì „ì²´ í‰ê·  ë¶€ë„ìœ¨ (ì›ë³¸ dfì—ì„œ ê³„ì‚°)
    avg_bankruptcy = df[target_col].mean() * 100
    
    texts = []
    for idx in valid_data.index:
        cnt = valid_data.loc[idx, 'ê¸°ì—…ìˆ˜']
        # [ìˆ˜ì •] ì—¬ê¸°ì„œë„ 'ë¶€ë„ìœ¨' ì»¬ëŸ¼ ì‚¬ìš©
        rate = valid_data.loc[idx, 'ë¶€ë„ìœ¨'] * 100
        
        if cnt > 1000 or rate > 2.5:
            txt = str(idx)
            texts.append(txt[:10] + ".." if len(txt) > 10 else txt)
        else:
            texts.append('')
            
    # ë¶€ì±„ë¹„ìœ¨ ìƒ‰ìƒ ì„¤ì •
    marker_color = 'royalblue'
    colorbar_dict = None
    custom_data = [0] * len(valid_data)
    
    if 'ë¶€ì±„ë¹„ìœ¨' in valid_data.columns:
        marker_color = valid_data['ë¶€ì±„ë¹„ìœ¨']
        custom_data = valid_data['ë¶€ì±„ë¹„ìœ¨']
        colorbar_dict = dict(title="ë¶€ì±„ë¹„ìœ¨(%)", tickformat=".0f")
    
    # ì‚°ì ë„ ê·¸ë¦¬ê¸°
    fig4.add_trace(
        go.Scatter(
            x=valid_data['ê¸°ì—…ìˆ˜'],
            y=valid_data['ë¶€ë„ìœ¨'] * 100, # [ìˆ˜ì •] 'ë¶€ë„ìœ¨' ì»¬ëŸ¼ ì‚¬ìš©
            mode='markers+text',
            marker=dict(
                size=valid_data['ê¸°ì—…ìˆ˜'].apply(lambda x: np.log10(x+1)*8 + 5),
                color=marker_color,
                colorscale='Viridis',
                showscale=('ë¶€ì±„ë¹„ìœ¨' in valid_data.columns),
                colorbar=colorbar_dict,
                line=dict(color='white', width=1),
                opacity=0.85
            ),
            text=texts,
            textposition='top center',
            textfont=dict(size=10),
            hovertemplate='<b>%{hovertext}</b><br>' +
                          'ê¸°ì—…ìˆ˜: %{x:,}ê°œ<br>' +
                          'ë¶€ë„ìœ¨: %{y:.2f}%<br>' +
                          'ë¶€ì±„ë¹„ìœ¨: %{customdata:.0f}%<extra></extra>',
            hovertext=valid_data.index,
            customdata=custom_data,
            showlegend=False
        )
    )
    
    # ê¸°ì¤€ì„  ì¶”ê°€
    fig4.add_hline(y=avg_bankruptcy, line_dash="dash", line_color="red", 
                   line_width=1, annotation_text="í‰ê·  ë¶€ë„ìœ¨")
    
    fig4.add_vline(x=median_count, line_dash="dot", line_color="gray", 
                   line_width=1, annotation_text="ê·œëª¨ ì¤‘ì•™ê°’")
    
    # Annotation (Paper ê¸°ì¤€ ì¢Œí‘œ)
    fig4.add_annotation(
        xref="paper", yref="paper",
        x=0.95, y=0.95,
        text="<b>ëŒ€ê·œëª¨ ê³ ìœ„í—˜</b>",
        showarrow=False,
        font=dict(color="crimson", size=12),
        align="right",
        bgcolor="rgba(255,255,255,0.6)"
    )
    
    fig4.add_annotation(
        xref="paper", yref="paper",
        x=0.05, y=0.95,
        text="<b>ì†Œê·œëª¨ ê³ ìœ„í—˜</b>",
        showarrow=False,
        font=dict(color="orange", size=12),
        align="left",
        bgcolor="rgba(255,255,255,0.6)"
    )
    
    # ë ˆì´ì•„ì›ƒ ì„¤ì •
    fig4.update_layout(
        title='<b>ì—…ì¢… ê·œëª¨ vs ë¶€ë„ìœ¨</b><br><sub>(Xì¶• ë¡œê·¸ìŠ¤ì¼€ì¼, ìš°ì¸¡ìœ¼ë¡œ ê°ˆìˆ˜ë¡ ê¸°ì—… ìˆ˜ ë§ìŒ)</sub>',
        xaxis_title='ì—…ì¢…ë³„ ê¸°ì—… ìˆ˜ (Log Scale)',
        yaxis_title='ë¶€ë„ìœ¨ (%)',
        height=600,
        width=900,
        template='plotly_white',
        margin=dict(l=80, r=150, t=80, b=80),
        xaxis=dict(
            type="log",
            range=[log_range_min, log_range_max] # [í•µì‹¬] ê³„ì‚°ëœ ë²”ìœ„ ê°•ì œ ì ìš©
        )
    )
    
    fig4.show()
    
    # í…ìŠ¤íŠ¸ ë¦¬í¬íŠ¸
    # [ìˆ˜ì •] 'ë¶€ë„ìœ¨' ì»¬ëŸ¼ ì‚¬ìš©
    large_high_risk = valid_data[
        (valid_data['ê¸°ì—…ìˆ˜'] > median_count) & 
        (valid_data['ë¶€ë„ìœ¨'] > df[target_col].mean())
    ].sort_values('ë¶€ë„ìœ¨', ascending=False)
    
    if len(large_high_risk) > 0:
        print("\nğŸ”´ [ê´€ì‹¬] ëŒ€ê·œëª¨-ê³ ìœ„í—˜ ì—…ì¢… (ìƒìœ„ 5ê°œ):")
        print(f"{'ì—…ì¢…':<20} {'ê¸°ì—…ìˆ˜':>10} {'ë¶€ë„ìœ¨(%)':>12}")
        print("-" * 50)
        for idx in large_high_risk.head(5).index:
            name = str(idx)
            if len(name) > 18: name = name[:18] + ".."
            print(f"{name:<20} {large_high_risk.loc[idx, 'ê¸°ì—…ìˆ˜']:>10,.0f} "
                  f"{large_high_risk.loc[idx, 'ë¶€ë„ìœ¨']*100:>12.2f}")
else:
    print("âš ï¸ í‘œì‹œí•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.")
```

**ì¶œë ¥:**

```

============================================================
ğŸ“Š [ì°¨íŠ¸ 4] ì—…ì¢… ê·œëª¨ì™€ ë¶€ë„ìœ¨ ê´€ê³„ (ìµœì¢… ìˆ˜ì •)
============================================================

```

```

ğŸ”´ [ê´€ì‹¬] ëŒ€ê·œëª¨-ê³ ìœ„í—˜ ì—…ì¢… (ìƒìœ„ 5ê°œ):
ì—…ì¢…                          ê¸°ì—…ìˆ˜       ë¶€ë„ìœ¨(%)
--------------------------------------------------
A01                         384         3.91
I56                         561         3.03
L68                       2,459         2.89
R91                         463         2.38
C17                         335         2.09

```

--------------------------------------------------------------------------------

## [ì½”ë“œ #15]

```python
# ê°œë³„ ì‹œê°í™” - 5. ì—…ì¢…ë³„ ì¢…í•© íˆíŠ¸ë§µ
# í•„ìš”í•œ ì»¬ëŸ¼ì´ ëª¨ë‘ ìˆëŠ”ì§€ í™•ì¸
required_cols = ['ë¶€ë„ìœ¨', 'ë¶€ì±„ë¹„ìœ¨', 'ROA', 'ìœ ë™ë¹„ìœ¨', 'í˜„ê¸ˆë¹„ìœ¨']
missing_cols = [c for c in required_cols if c not in industry_financial.columns]

if len(missing_cols) == 0 and len(industry_financial) > 0:
    print("\n" + "="*60)
    print("ğŸ“Š [ì°¨íŠ¸ 5] ì—…ì¢…ë³„ ì£¼ìš” ì§€í‘œ íˆíŠ¸ë§µ ë° ìœ„í—˜ ì ìˆ˜")
    print("="*60)
    
    # ë¶„ì„ ëŒ€ìƒ: ë¶€ë„ìœ¨ ìƒìœ„ 20ê°œ ì—…ì¢…
    top20_industries = industry_financial.nlargest(20, 'ë¶€ë„ìœ¨')
    
    # íˆíŠ¸ë§µìš© ë°ì´í„° ì¤€ë¹„ (NaN 0 ì²˜ë¦¬)
    heatmap_data = top20_industries[required_cols].fillna(0).copy()
    heatmap_data['ë¶€ë„ìœ¨'] = heatmap_data['ë¶€ë„ìœ¨'] * 100 # % ë³€í™˜
    # í˜„ê¸ˆë¹„ìœ¨ì€ ì´ë¯¸ ë¹„ìœ¨(0.x)ì¸ì§€ %ì¸ì§€ í™•ì¸ í›„ í•„ìš”í•˜ë©´ ë³€í™˜
    # ë³´í†µ ë°ì´í„°ê°€ 0.xë¡œ ë˜ì–´ìˆë‹¤ë©´ 100ì„ ê³±í•¨
    if heatmap_data['í˜„ê¸ˆë¹„ìœ¨'].max() < 5: 
        heatmap_data['í˜„ê¸ˆë¹„ìœ¨'] = heatmap_data['í˜„ê¸ˆë¹„ìœ¨'] * 100
    
    # ì •ê·œí™” (Min-Max Scaling) - 0~1 ì‚¬ì´ ê°’ìœ¼ë¡œ ë³€í™˜
    heatmap_normalized = pd.DataFrame(index=heatmap_data.index)
    
    for col in heatmap_data.columns:
        col_data = heatmap_data[col]
        min_val = col_data.min()
        max_val = col_data.max()
        
        if max_val - min_val == 0:
            heatmap_normalized[col] = 0.5
        else:
            heatmap_normalized[col] = (col_data - min_val) / (max_val - min_val)
    
    # ì‹œê°í™”
    fig5 = go.Figure(data=go.Heatmap(
        z=heatmap_normalized.values,
        x=heatmap_normalized.columns,
        y=heatmap_normalized.index,
        colorscale='RdYlBu_r',  # ë¹¨ê°•(ìœ„í—˜, 1ì— ê°€ê¹Œì›€) - íŒŒë‘(ì•ˆì „, 0ì— ê°€ê¹Œì›€)
        # ì£¼ì˜: ROA, ìœ ë™ë¹„ìœ¨ ë“±ì€ ë†’ì„ìˆ˜ë¡ ì•ˆì „í•˜ë¯€ë¡œ ì•„ë˜ ì ìˆ˜ ê³„ì‚°ì—ì„œ ë°˜ì „ í•„ìš”
        # ì—¬ê¸°ì„œëŠ” ë‹¨ìˆœíˆ ê°’ì˜ í¬ê¸°ë§Œ ë³´ì—¬ì¤Œ
        showscale=True,
        colorbar=dict(title="ì§€í‘œ ìƒëŒ€ê°’<br>(0=ìµœì†Œ, 1=ìµœëŒ€)"),
        text=heatmap_data.round(2).values,
        texttemplate='%{text}',
        textfont={"size": 10}
    ))
    
    fig5.update_layout(
        title='<b>ìƒìœ„ 20ê°œ ë¶€ë„ìœ¨ ì—…ì¢…ì˜ ì£¼ìš” ì§€í‘œ íˆíŠ¸ë§µ</b>',
        xaxis_title='ì¬ë¬´ ì§€í‘œ',
        yaxis_title='ì—…ì¢…',
        height=800,
        width=900,
        margin=dict(l=150, r=50, t=80, b=80),
        xaxis={'side': 'top'} # Xì¶• ë¼ë²¨ì„ ìœ„ë¡œ
    )
    
    fig5.show()
    
    # ---- ìœ„í—˜ ì ìˆ˜ ìŠ¤ì½”ì–´ë§ ëª¨ë¸ ----
    print("\nğŸ“Š ì—…ì¢…ë³„ ì¢…í•© ìœ„í—˜ ì ìˆ˜ (Risk Scoring)")
    print("-" * 60)
    
    risk_scores = pd.DataFrame(index=heatmap_data.index)
    
    # ê°€ì¤‘ì¹˜ ì„¤ì • (ì´í•© 100)
    w_default = 35  # ë¶€ë„ìœ¨
    w_debt = 20     # ë¶€ì±„ë¹„ìœ¨
    w_roa = 20      # ROA
    w_liq = 15      # ìœ ë™ë¹„ìœ¨
    w_cash = 10     # í˜„ê¸ˆë¹„ìœ¨
    
    # ì ìˆ˜ ê³„ì‚° (ë†’ì„ìˆ˜ë¡ ìœ„í—˜í•˜ë„ë¡ ë°©í–¥ ì¡°ì •)
    # ë¶€ë„ìœ¨, ë¶€ì±„ë¹„ìœ¨: ë†’ì„ìˆ˜ë¡ ìœ„í—˜ (+)
    # ROA, ìœ ë™ë¹„ìœ¨, í˜„ê¸ˆë¹„ìœ¨: ë‚®ì„ìˆ˜ë¡ ìœ„í—˜ (1 - ê°’)
    
    risk_scores['ì ìˆ˜'] = (
        heatmap_normalized['ë¶€ë„ìœ¨'] * w_default +
        heatmap_normalized['ë¶€ì±„ë¹„ìœ¨'] * w_debt +
        (1 - heatmap_normalized['ROA']) * w_roa +
        (1 - heatmap_normalized['ìœ ë™ë¹„ìœ¨']) * w_liq +
        (1 - heatmap_normalized['í˜„ê¸ˆë¹„ìœ¨']) * w_cash
    )
    
    # ë“±ê¸‰ ë¶€ì—¬
    def get_grade(score):
        if score >= 70: return 'ğŸ”´ ê³ ìœ„í—˜'
        if score >= 40: return 'ğŸŸ  ì£¼ì˜'
        return 'ğŸŸ¢ ë³´í†µ'
        
    risk_scores['ë“±ê¸‰'] = risk_scores['ì ìˆ˜'].apply(get_grade)
    risk_scores = risk_scores.sort_values('ì ìˆ˜', ascending=False)
    
    # ê²°ê³¼ ì¶œë ¥ (ì¬ë¬´ì§€í‘œ ì›ë³¸ ê°’ê³¼ í•¨ê»˜)
    final_report = pd.concat([risk_scores, heatmap_data], axis=1).loc[risk_scores.index]
    
    print(f"{'ì—…ì¢…':<20} {'ìœ„í—˜ì ìˆ˜':>8} {'ë“±ê¸‰':<8} {'ë¶€ë„ìœ¨(%)':>10} {'ë¶€ì±„ë¹„ìœ¨':>10} {'ROA':>8}")
    print("-" * 70)
    
    for idx in final_report.head(10).index:
        name = str(idx)
        if len(name) > 18: name = name[:18] + ".."
        
        row = final_report.loc[idx]
        print(f"{name:<20} {row['ì ìˆ˜']:>8.1f} {row['ë“±ê¸‰']:<8} "
              f"{row['ë¶€ë„ìœ¨']:>10.2f} {row['ë¶€ì±„ë¹„ìœ¨']:>10.0f} {row['ROA']:>8.1f}")

else:
    print(f"âš ï¸ í•„ìˆ˜ ì»¬ëŸ¼ ë¶€ì¡±ìœ¼ë¡œ íˆíŠ¸ë§µì„ ê·¸ë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (ëˆ„ë½: {missing_cols})")
```

**ì¶œë ¥:**

```

============================================================
ğŸ“Š [ì°¨íŠ¸ 5] ì—…ì¢…ë³„ ì£¼ìš” ì§€í‘œ íˆíŠ¸ë§µ ë° ìœ„í—˜ ì ìˆ˜
============================================================

```

```

ğŸ“Š ì—…ì¢…ë³„ ì¢…í•© ìœ„í—˜ ì ìˆ˜ (Risk Scoring)
------------------------------------------------------------
ì—…ì¢…                       ìœ„í—˜ì ìˆ˜ ë“±ê¸‰           ë¶€ë„ìœ¨(%)       ë¶€ì±„ë¹„ìœ¨      ROA
----------------------------------------------------------------------
B08                      92.3 ğŸ”´ ê³ ìœ„í—˜         33.33      10000     -7.3
I56                      26.5 ğŸŸ¢ ë³´í†µ           3.03        307      0.3
J59                      23.7 ğŸŸ¢ ë³´í†µ           3.18        157      0.6
A01                      22.1 ğŸŸ¢ ë³´í†µ           3.91        208      1.9
R91                      22.0 ğŸŸ¢ ë³´í†µ           2.38        210      0.8
L68                      20.6 ğŸŸ¢ ë³´í†µ           2.89        405     -0.2
J63                      19.6 ğŸŸ¢ ë³´í†µ           2.79        132      2.2
S94                      19.2 ğŸŸ¢ ë³´í†µ           2.78        126      1.5
C17                      18.1 ğŸŸ¢ ë³´í†µ           2.09        159      2.8
C10                      17.6 ğŸŸ¢ ë³´í†µ           2.09        188      2.5

```

--------------------------------------------------------------------------------

## [ë§ˆí¬ë‹¤ìš´ #9]

### 4.2 ê·œëª¨ë³„ ë¶€ë„ íŒ¨í„´

--------------------------------------------------------------------------------

## [ì½”ë“œ #16]

```python
# ê¸°ì—… ê·œëª¨ ê´€ë ¨ ë¶„ì„
size_indicators = ['ìì‚°ì´ê³„', 'ë§¤ì¶œì•¡', 'ì¢…ì—…ì›ìˆ˜']
existing_size_cols = [col for col in size_indicators if col in df.columns]

if existing_size_cols and target_col in df.columns:
    for size_col in existing_size_cols:
        if df[size_col].notna().sum() > 0:
            # ê·œëª¨ë³„ êµ¬ê°„ ìƒì„± (ë¶„ìœ„ìˆ˜ ê¸°ì¤€)
            quantiles = df[size_col].quantile([0.25, 0.5, 0.75])
            
            bins = [-np.inf, quantiles[0.25], quantiles[0.5], quantiles[0.75], np.inf]
            labels = ['ì†Œê·œëª¨(í•˜ìœ„25%)', 'ì¤‘ì†Œê·œëª¨(25-50%)', 'ì¤‘ê·œëª¨(50-75%)', 'ëŒ€ê·œëª¨(ìƒìœ„25%)']
            
            df[f'{size_col}_ê·œëª¨'] = pd.cut(df[size_col], bins=bins, labels=labels)
            
            # ê·œëª¨ë³„ ë¶€ë„ìœ¨
            size_bankruptcy = df.groupby(f'{size_col}_ê·œëª¨')[target_col].agg(['count', 'sum', 'mean'])
            size_bankruptcy.columns = ['ê¸°ì—…ìˆ˜', 'ë¶€ë„ê¸°ì—…ìˆ˜', 'ë¶€ë„ìœ¨']
            size_bankruptcy['ë¶€ë„ìœ¨(%)'] = size_bankruptcy['ë¶€ë„ìœ¨'] * 100
            
            print(f"\nğŸ“ {size_col} ê¸°ì¤€ ê·œëª¨ë³„ ë¶€ë„ìœ¨")
            print("="*60)
            print(size_bankruptcy)
            
            # ì‹œê°í™”
            fig = go.Figure()
            fig.add_trace(go.Bar(
                x=size_bankruptcy.index,
                y=size_bankruptcy['ë¶€ë„ìœ¨(%)'],
                text=[f"{v:.2f}%" for v in size_bankruptcy['ë¶€ë„ìœ¨(%)']],
                textposition='outside',
                marker_color=['lightblue', 'blue', 'darkblue', 'navy']
            ))
            
            fig.update_layout(
                title=f'{size_col} ê¸°ì¤€ ê¸°ì—… ê·œëª¨ë³„ ë¶€ë„ìœ¨',
                xaxis_title='ê¸°ì—… ê·œëª¨',
                yaxis_title='ë¶€ë„ìœ¨ (%)',
                showlegend=False
            )
            fig.show()
            break
```

**ì¶œë ¥:**

```

ğŸ“ ìì‚°ì´ê³„ ê¸°ì¤€ ê·œëª¨ë³„ ë¶€ë„ìœ¨
============================================================
                ê¸°ì—…ìˆ˜  ë¶€ë„ê¸°ì—…ìˆ˜   ë¶€ë„ìœ¨  ë¶€ë„ìœ¨(%)
ìì‚°ì´ê³„_ê·œëª¨                                 
ì†Œê·œëª¨(í•˜ìœ„25%)    12527    205 0.016   1.636
ì¤‘ì†Œê·œëª¨(25-50%)  12526    209 0.017   1.669
ì¤‘ê·œëª¨(50-75%)   12526    201 0.016   1.605
ëŒ€ê·œëª¨(ìƒìœ„25%)    12526    144 0.011   1.150

```

--------------------------------------------------------------------------------

## [ë§ˆí¬ë‹¤ìš´ #10]

### 4.3 ì™¸ê° ì—¬ë¶€ë³„ ë¶€ë„ íŒ¨í„´

--------------------------------------------------------------------------------

## [ì½”ë“œ #17]

```python
# ì™¸ê° ì—¬ë¶€ ë¶„ì„
audit_cols = [col for col in df.columns if 'ì™¸ê°' in col]

if audit_cols and target_col in df.columns:
    audit_col = audit_cols[0]
    
    # ì™¸ê° ì—¬ë¶€ë³„ ë¶€ë„ìœ¨
    audit_bankruptcy = pd.crosstab(df[audit_col], df[target_col], 
                                  normalize='index') * 100
    
    print("\nğŸ“‹ ì™¸ê° ì—¬ë¶€ë³„ ë¶€ë„ìœ¨ ë¶„ì„")
    print("="*60)
    print(audit_bankruptcy)
    
    # ì™¸ê° ì—¬ë¶€ë³„ ì£¼ìš” ì¬ë¬´ì§€í‘œ ë¹„êµ
    if 'ë¶€ì±„ë¹„ìœ¨' in df.columns and 'ROA' in df.columns:
        audit_comparison = df.groupby(audit_col).agg({
            'ë¶€ì±„ë¹„ìœ¨': ['mean', 'median'],
            'ROA': ['mean', 'median'],
            target_col: 'mean'
        }).round(2)
        
        print("\nì™¸ê° ì—¬ë¶€ë³„ ì¬ë¬´ì§€í‘œ ë¹„êµ")
        print(audit_comparison)
```

**ì¶œë ¥:**

```

ğŸ“‹ ì™¸ê° ì—¬ë¶€ë³„ ë¶€ë„ìœ¨ ë¶„ì„
============================================================
ëª¨í˜•ê°œë°œìš©Performance(í–¥í›„1ë…„ë‚´ë¶€ë„ì—¬ë¶€)      0     1
ì™¸ê°êµ¬ë¶„                                    
1                           98.637 1.363
2                           98.399 1.601

ì™¸ê° ì—¬ë¶€ë³„ ì¬ë¬´ì§€í‘œ ë¹„êµ
         ë¶€ì±„ë¹„ìœ¨           ROA        ëª¨í˜•ê°œë°œìš©Performance(í–¥í›„1ë…„ë‚´ë¶€ë„ì—¬ë¶€)
         mean  median  mean median                        mean
ì™¸ê°êµ¬ë¶„                                                          
1    1478.280 133.750 2.410  2.140                       0.010
2    1404.460 144.220 2.440  3.130                       0.020

```

--------------------------------------------------------------------------------

## [ì½”ë“œ #18]

```python
# ì™¸ê° ì—¬ë¶€ ë¶„ì„ ë° ì‹œê°í™”
audit_cols = [col for col in df.columns if 'ì™¸ê°' in col]

if audit_cols and target_col in df.columns:
    audit_col = audit_cols[0]
    
    print("\n" + "="*60)
    print("ğŸ“‹ ì™¸ê° ì—¬ë¶€ë³„ ë¶€ë„ìœ¨ ë° ì¬ë¬´ì§€í‘œ ë¶„ì„")
    print("="*60)
    
    # 1. ê¸°ì´ˆ í†µê³„ ê³„ì‚°
    # ì™¸ê° ì—¬ë¶€ë³„ ë¶€ë„ìœ¨ ë° ê¸°ì—… ìˆ˜ ì§‘ê³„
    audit_stats = df.groupby(audit_col)[target_col].agg(['count', 'mean'])
    audit_stats['ë¶€ë„ìœ¨(%)'] = audit_stats['mean'] * 100
    
    print("\n1. ì™¸ê° ì—¬ë¶€ë³„ ë¶€ë„ìœ¨ í˜„í™©")
    print(audit_stats[['count', 'ë¶€ë„ìœ¨(%)']].round(2))

    # ---------------------------------------------------------
    # [ì‹œê°í™” 1] ì™¸ê° ì—¬ë¶€ë³„ ë¶€ë„ìœ¨ (ë§‰ëŒ€ ê·¸ë˜í”„)
    # ---------------------------------------------------------
    fig1 = go.Figure()
    
    # ìƒ‰ìƒ íŒ”ë ˆíŠ¸ (íŒŒë‘/ì£¼í™© ê³„ì—´)
    colors = ['#1f77b4', '#ff7f0e', '#2ca02c'] 
    
    fig1.add_trace(go.Bar(
        x=audit_stats.index.astype(str),
        y=audit_stats['ë¶€ë„ìœ¨(%)'],
        # ë§‰ëŒ€ ìœ„ì— 'ë¶€ë„ìœ¨'ê³¼ '(ê¸°ì—…ìˆ˜)'ë¥¼ í•¨ê»˜ í‘œì‹œ
        text=[f"<b>{val:.2f}%</b><br>({cnt:,}ê°œì‚¬)" 
              for val, cnt in zip(audit_stats['ë¶€ë„ìœ¨(%)'], audit_stats['count'])],
        textposition='auto',
        marker_color=colors[:len(audit_stats)],
        opacity=0.8
    ))
    
    fig1.update_layout(
        title='<b>ì™¸ê° ì—¬ë¶€ì— ë”°ë¥¸ ë¶€ë„ìœ¨ ë¹„êµ</b>',
        xaxis_title='ì™¸ê° ëŒ€ìƒ ì—¬ë¶€',
        yaxis_title='ë¶€ë„ìœ¨ (%)',
        height=500,
        width=800,
        template='plotly_white',
        margin=dict(t=80, b=50, l=50, r=50),
        showlegend=False
    )
    
    # Yì¶• ë²”ìœ„ë¥¼ ë„‰ë„‰í•˜ê²Œ ì„¤ì •í•˜ì—¬ í…ìŠ¤íŠ¸ ì˜ë¦¼ ë°©ì§€
    max_rate = audit_stats['ë¶€ë„ìœ¨(%)'].max()
    fig1.update_yaxes(range=[0, max_rate * 1.2])
    
    fig1.show()

    # ---------------------------------------------------------
    # [ì‹œê°í™” 2] ì£¼ìš” ì¬ë¬´ì§€í‘œ ë¶„í¬ ë¹„êµ (Box Plot)
    # ---------------------------------------------------------
    if 'ë¶€ì±„ë¹„ìœ¨' in df.columns and 'ROA' in df.columns:
        print("\n2. ì¬ë¬´ì§€í‘œ ë¶„í¬ ë¹„êµ ë¶„ì„")
        
        # ì„œë¸Œí”Œë¡¯ ìƒì„± (ì¢Œ: ë¶€ì±„ë¹„ìœ¨, ìš°: ROA)
        fig2 = make_subplots(
            rows=1, cols=2,
            subplot_titles=['<b>ë¶€ì±„ë¹„ìœ¨ ë¶„í¬</b> (ë‚®ì„ìˆ˜ë¡ ì¢‹ìŒ)', '<b>ROA ë¶„í¬</b> (ë†’ì„ìˆ˜ë¡ ì¢‹ìŒ)'],
            horizontal_spacing=0.15
        )
        
        # ë°ì´í„° ì •ì œ í•¨ìˆ˜ (ë¬´í•œëŒ€ ì œê±°)
        def clean_series(s):
            return s.replace([np.inf, -np.inf], np.nan).dropna()
            
        unique_cats = df[audit_col].dropna().unique()
        
        for i, cat in enumerate(unique_cats):
            # í•´ë‹¹ ê·¸ë£¹ ë°ì´í„° í•„í„°ë§
            mask = (df[audit_col] == cat)
            cat_name = str(cat)
            color = colors[i % len(colors)]
            
            # 1) ë¶€ì±„ë¹„ìœ¨ Box Plot
            debt_data = clean_series(df.loc[mask, 'ë¶€ì±„ë¹„ìœ¨'])
            fig2.add_trace(
                go.Box(
                    y=debt_data,
                    name=cat_name,
                    boxpoints=False,  # [í•µì‹¬] ì´ìƒì¹˜ ì  ìˆ¨ê¹€ (ê¹”ë”í•˜ê²Œ)
                    boxmean=True,     # ì ì„ ìœ¼ë¡œ í‰ê·  í‘œì‹œ
                    marker_color=color,
                    legendgroup=cat_name,
                    showlegend=True
                ),
                row=1, col=1
            )
            
            # 2) ROA Box Plot
            roa_data = clean_series(df.loc[mask, 'ROA'])
            fig2.add_trace(
                go.Box(
                    y=roa_data,
                    name=cat_name,
                    boxpoints=False,  # [í•µì‹¬] ì´ìƒì¹˜ ì  ìˆ¨ê¹€
                    boxmean=True,
                    marker_color=color,
                    legendgroup=cat_name,
                    showlegend=False  # ë²”ë¡€ ì¤‘ë³µ ë°©ì§€
                ),
                row=1, col=2
            )

        # [ì¤‘ìš”] Yì¶• ë²”ìœ„ ê°•ì œ ì„¤ì • (ì´ìƒì¹˜ë¡œ ì¸í•œ ê·¸ë˜í”„ ì°Œê·¸ëŸ¬ì§ ë°©ì§€)
        # ë¶€ì±„ë¹„ìœ¨: 0 ~ 600% êµ¬ê°„ ì§‘ì¤‘
        fig2.update_yaxes(range=[-10, 600], title='ë¶€ì±„ë¹„ìœ¨ (%)', row=1, col=1)
        
        # ROA: -50 ~ 50% êµ¬ê°„ ì§‘ì¤‘
        fig2.update_yaxes(range=[-50, 50], title='ROA (%)', row=1, col=2)
        
        fig2.update_layout(
            title='<b>ì™¸ê° ì—¬ë¶€ì— ë”°ë¥¸ ì¬ë¬´ ê±´ì „ì„± ë¹„êµ</b><br><sub>(Box Plot: ì¤‘ì•™ê°’ ë° ë¶„í¬ ë²”ìœ„, ì ì„ =í‰ê· )</sub>',
            height=500,
            width=900,
            template='plotly_white',
            margin=dict(t=100, b=50, l=60, r=50),
            legend=dict(
                orientation="h", 
                yanchor="bottom", y=1.1, 
                xanchor="center", x=0.5,
                title_text="êµ¬ë¶„"
            )
        )
        
        fig2.show()
        
        # ìš”ì•½ í…Œì´ë¸” ì¶œë ¥
        summary = df.groupby(audit_col)[['ë¶€ì±„ë¹„ìœ¨', 'ROA']].agg(['median', 'mean']).round(2)
        print("\nğŸ“Š ìƒì„¸ í†µê³„ (ì¤‘ì•™ê°’ vs í‰ê· )")
        print("-" * 60)
        print(summary)
        
else:
    print("âš ï¸ ì™¸ê° ê´€ë ¨ ì»¬ëŸ¼ ë˜ëŠ” íƒ€ê²Ÿ ì»¬ëŸ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
```

**ì¶œë ¥:**

```

============================================================
ğŸ“‹ ì™¸ê° ì—¬ë¶€ë³„ ë¶€ë„ìœ¨ ë° ì¬ë¬´ì§€í‘œ ë¶„ì„
============================================================

1. ì™¸ê° ì—¬ë¶€ë³„ ë¶€ë„ìœ¨ í˜„í™©
      count  ë¶€ë„ìœ¨(%)
ì™¸ê°êµ¬ë¶„               
1     18192   1.360
2     31913   1.600

```

```

2. ì¬ë¬´ì§€í‘œ ë¶„í¬ ë¹„êµ ë¶„ì„

```

```

ğŸ“Š ìƒì„¸ í†µê³„ (ì¤‘ì•™ê°’ vs í‰ê· )
------------------------------------------------------------
        ë¶€ì±„ë¹„ìœ¨             ROA      
      median     mean median  mean
ì™¸ê°êµ¬ë¶„                              
1    133.750 1478.280  2.140 2.410
2    144.220 1404.460  3.130 2.440

```

--------------------------------------------------------------------------------

## [ë§ˆí¬ë‹¤ìš´ #11]

## 4.4 ì—…ì¢…ë³„ ë¦¬ìŠ¤í¬ ë¶„ì„

í•œêµ­í‘œì¤€ì‚°ì—…ë¶„ë¥˜(10ì°¨)ë¥¼ í™œìš©í•œ ì—…ì¢…ë³„ ë¶€ë„ íŒ¨í„´ ë° ì¬ë¬´ ë¦¬ìŠ¤í¬ ë¶„ì„

--------------------------------------------------------------------------------

## [ì½”ë“œ #19]

```python
# ì‚°ì—…ë¶„ë¥˜ ë§¤í•‘ í…Œì´ë¸” ë¡œë“œ
mapping = pd.read_csv('../data/ksic_mapping.csv')

# ê¸°ì—… ë°ì´í„°ì™€ ì—…ì¢… ë§¤í•‘
df_industry = df.merge(mapping, left_on='ì—…ì¢…(ì¤‘ë¶„ë¥˜)', right_on='ì—…ì¢…ì½”ë“œ', how='left')

print("=== ì—…ì¢… ë§¤í•‘ ê²°ê³¼ ===")
print(f"ë§¤í•‘ ì„±ê³µ: {df_industry['ëŒ€ë¶„ë¥˜ì½”ë“œ'].notna().sum():,}ê±´ ({df_industry['ëŒ€ë¶„ë¥˜ì½”ë“œ'].notna().sum()/len(df)*100:.1f}%)")
print(f"ë§¤í•‘ ì‹¤íŒ¨: {df_industry['ëŒ€ë¶„ë¥˜ì½”ë“œ'].isna().sum():,}ê±´")

print("\n=== ëŒ€ë¶„ë¥˜ë³„ ê¸°ì—… ìˆ˜ ===")
print(df_industry['ëŒ€ë¶„ë¥˜ëª…'].value_counts())
```

**ì¶œë ¥:**

```
=== ì—…ì¢… ë§¤í•‘ ê²°ê³¼ ===
ë§¤í•‘ ì„±ê³µ: 50,100ê±´ (100.0%)
ë§¤í•‘ ì‹¤íŒ¨: 5ê±´

=== ëŒ€ë¶„ë¥˜ë³„ ê¸°ì—… ìˆ˜ ===
ëŒ€ë¶„ë¥˜ëª…
ì œì¡°ì—…(10~34)                         18687
ë„ë§¤ ë° ì†Œë§¤ì—…(45~47)                    10942
ê±´ì„¤ì—…(41~42)                          6277
ì „ë¬¸, ê³¼í•™ ë° ê¸°ìˆ  ì„œë¹„ìŠ¤ì—…(70~73)             2563
ë¶€ë™ì‚°ì—…(68)                            2459
ì •ë³´í†µì‹ ì—…(58~63)                        2344
ì‚¬ì—…ì‹œì„¤ ê´€ë¦¬, ì‚¬ì—… ì§€ì› ë° ì„ëŒ€ ì„œë¹„ìŠ¤ì—…(74~76)     1531
ìš´ìˆ˜ ë° ì°½ê³ ì—…(49~52)                     1433
ìˆ™ë°• ë° ìŒì‹ì ì—…(55~56)                     837
í˜‘íšŒ ë° ë‹¨ì²´, ìˆ˜ë¦¬ ë° ê¸°íƒ€ ê°œì¸ ì„œë¹„ìŠ¤ì—…(94~96)      681
ì˜ˆìˆ , ìŠ¤í¬ì¸  ë° ì—¬ê°€ê´€ë ¨ ì„œë¹„ìŠ¤ì—…(90~91)           562
ìˆ˜ë„, í•˜ìˆ˜ ë° íê¸°ë¬¼ ì²˜ë¦¬, ì›ë£Œ ì¬ìƒì—…(36~39)       512
ë†ì—…, ì„ì—… ë° ì–´ì—…(01~03)                   454
êµìœ¡ ì„œë¹„ìŠ¤ì—…(85)                          383
ì „ê¸°, ê°€ìŠ¤, ì¦ê¸° ë° ê³µê¸° ì¡°ì ˆ ê³µê¸‰ì—…(35)           172
ë³´ê±´ì—… ë° ì‚¬íšŒë³µì§€ ì„œë¹„ìŠ¤ì—…(86~87)               147
ê´‘ì—…(05~08)                            104
ê¸ˆìœµ ë° ë³´í—˜ì—…(64~66)                        9
ê³µê³µ í–‰ì •, êµ­ë°© ë° ì‚¬íšŒë³´ì¥ í–‰ì •(84)                3
Name: count, dtype: int64

```

--------------------------------------------------------------------------------

## [ë§ˆí¬ë‹¤ìš´ #12]

### 4.4.1 ì—…ì¢…ë³„ ë¶€ë„ìœ¨ ë¶„ì„

--------------------------------------------------------------------------------

## [ì½”ë“œ #20]

```python
import plotly.graph_objects as go
from plotly.subplots import make_subplots

# ëŒ€ë¶„ë¥˜ë³„ ë¶€ë„ìœ¨
major_default = df_industry.groupby('ëŒ€ë¶„ë¥˜ëª…').agg({
    target_col: ['sum', 'count', 'mean']
}).round(4)
major_default.columns = ['ë¶€ë„ê¸°ì—…ìˆ˜', 'ì „ì²´ê¸°ì—…ìˆ˜', 'ë¶€ë„ìœ¨']
major_default = major_default.sort_values('ë¶€ë„ìœ¨', ascending=False)

print("=== ëŒ€ë¶„ë¥˜ë³„ ë¶€ë„ìœ¨ ===")
print(major_default)

# ì¤‘ë¶„ë¥˜ë³„ ë¶€ë„ìœ¨ (ìƒìœ„ 20ê°œ)
minor_default = df_industry.groupby(['ëŒ€ë¶„ë¥˜ëª…', 'ì¤‘ë¶„ë¥˜ëª…']).agg({
    target_col: ['sum', 'count', 'mean']
}).round(4)
minor_default.columns = ['ë¶€ë„ê¸°ì—…ìˆ˜', 'ì „ì²´ê¸°ì—…ìˆ˜', 'ë¶€ë„ìœ¨']
minor_default = minor_default[minor_default['ì „ì²´ê¸°ì—…ìˆ˜'] >= 50]  # ìµœì†Œ 50ê°œ ê¸°ì—… ì´ìƒ
minor_default = minor_default.sort_values('ë¶€ë„ìœ¨', ascending=False)

print("\n=== ì¤‘ë¶„ë¥˜ë³„ ë¶€ë„ìœ¨ (ìƒìœ„ 20ê°œ, ìµœì†Œ 50ê°œ ê¸°ì—…) ===")
print(minor_default.head(20))
```

**ì¶œë ¥:**

```
=== ëŒ€ë¶„ë¥˜ë³„ ë¶€ë„ìœ¨ ===
                                 ë¶€ë„ê¸°ì—…ìˆ˜  ì „ì²´ê¸°ì—…ìˆ˜   ë¶€ë„ìœ¨
ëŒ€ë¶„ë¥˜ëª…                                               
ë†ì—…, ì„ì—… ë° ì–´ì—…(01~03)                  15    454 0.033
ë¶€ë™ì‚°ì—…(68)                            71   2459 0.029
ìˆ™ë°• ë° ìŒì‹ì ì—…(55~56)                    21    837 0.025
ì˜ˆìˆ , ìŠ¤í¬ì¸  ë° ì—¬ê°€ê´€ë ¨ ì„œë¹„ìŠ¤ì—…(90~91)          12    562 0.021
ê±´ì„¤ì—…(41~42)                         106   6277 0.017
ì „ë¬¸, ê³¼í•™ ë° ê¸°ìˆ  ì„œë¹„ìŠ¤ì—…(70~73)             40   2563 0.016
ë„ë§¤ ë° ì†Œë§¤ì—…(45~47)                    158  10942 0.014
ìš´ìˆ˜ ë° ì°½ê³ ì—…(49~52)                     20   1433 0.014
ì œì¡°ì—…(10~34)                         256  18687 0.014
êµìœ¡ ì„œë¹„ìŠ¤ì—…(85)                          5    383 0.013
ì „ê¸°, ê°€ìŠ¤, ì¦ê¸° ë° ê³µê¸° ì¡°ì ˆ ê³µê¸‰ì—…(35)           2    172 0.012
ì •ë³´í†µì‹ ì—…(58~63)                        27   2344 0.011
ì‚¬ì—…ì‹œì„¤ ê´€ë¦¬, ì‚¬ì—… ì§€ì› ë° ì„ëŒ€ ì„œë¹„ìŠ¤ì—…(74~76)     15   1531 0.010
ìˆ˜ë„, í•˜ìˆ˜ ë° íê¸°ë¬¼ ì²˜ë¦¬, ì›ë£Œ ì¬ìƒì—…(36~39)       5    512 0.010
ê´‘ì—…(05~08)                            1    104 0.010
ë³´ê±´ì—… ë° ì‚¬íšŒë³µì§€ ì„œë¹„ìŠ¤ì—…(86~87)               1    147 0.007
í˜‘íšŒ ë° ë‹¨ì²´, ìˆ˜ë¦¬ ë° ê¸°íƒ€ ê°œì¸ ì„œë¹„ìŠ¤ì—…(94~96)      4    681 0.006
ê³µê³µ í–‰ì •, êµ­ë°© ë° ì‚¬íšŒë³´ì¥ í–‰ì •(84)              0      3 0.000
ê¸ˆìœµ ë° ë³´í—˜ì—…(64~66)                      0      9 0.000

=== ì¤‘ë¶„ë¥˜ë³„ ë¶€ë„ìœ¨ (ìƒìœ„ 20ê°œ, ìµœì†Œ 50ê°œ ê¸°ì—…) ===
                                                         ë¶€ë„ê¸°ì—…ìˆ˜  ì „ì²´ê¸°ì—…ìˆ˜   ë¶€ë„ìœ¨
ëŒ€ë¶„ë¥˜ëª…                            ì¤‘ë¶„ë¥˜ëª…                                       
ë†ì—…, ì„ì—… ë° ì–´ì—…(01~03)              ë†ì—…                          15    384 0.039
ì •ë³´í†µì‹ ì—…(58~63)                    ì˜ìƒã†ì˜¤ë””ì˜¤ ê¸°ë¡ë¬¼ ì œì‘ ë° ë°°ê¸‰ì—…          7    220 0.032
ì œì¡°ì—…(10~34)                      ìŒë£Œ ì œì¡°ì—…                       4    127 0.032
ìˆ™ë°• ë° ìŒì‹ì ì—…(55~56)                ìŒì‹ì  ë° ì£¼ì ì—…                   17    561 0.030
ë¶€ë™ì‚°ì—…(68)                        ë¶€ë™ì‚°ì—…                        71   2459 0.029
ì •ë³´í†µì‹ ì—…(58~63)                    ì •ë³´ì„œë¹„ìŠ¤ì—…                       6    215 0.028
í˜‘íšŒ ë° ë‹¨ì²´, ìˆ˜ë¦¬ ë° ê¸°íƒ€ ê°œì¸ ì„œë¹„ìŠ¤ì—…(94~96) í˜‘íšŒ ë° ë‹¨ì²´                      2     72 0.028
ì˜ˆìˆ , ìŠ¤í¬ì¸  ë° ì—¬ê°€ê´€ë ¨ ì„œë¹„ìŠ¤ì—…(90~91)      ìŠ¤í¬ì¸  ë° ì˜¤ë½ê´€ë ¨ ì„œë¹„ìŠ¤ì—…             11    463 0.024
ì œì¡°ì—…(10~34)                      í„í”„, ì¢…ì´ ë° ì¢…ì´ì œí’ˆ ì œì¡°ì—…            7    335 0.021
                                ì‹ë£Œí’ˆ ì œì¡°ì—…                     40   1917 0.021
ì „ë¬¸, ê³¼í•™ ë° ê¸°ìˆ  ì„œë¹„ìŠ¤ì—…(70~73)         ê¸°íƒ€ ì „ë¬¸, ê³¼í•™ ë° ê¸°ìˆ  ì„œë¹„ìŠ¤ì—…          7    347 0.020
                                ì „ë¬¸ ì„œë¹„ìŠ¤ì—…                     20   1018 0.020
ì œì¡°ì—…(10~34)                      ê°€êµ¬ ì œì¡°ì—…                       4    206 0.019
ê±´ì„¤ì—…(41~42)                      ì¢…í•© ê±´ì„¤ì—…                      49   2706 0.018
ì œì¡°ì—…(10~34)                      ì˜ë³µ, ì˜ë³µ ì•¡ì„¸ì„œë¦¬ ë° ëª¨í”¼ì œí’ˆ ì œì¡°ì—…       7    396 0.018
                                ê¸ˆì† ê°€ê³µì œí’ˆ ì œì¡°ì—…; ê¸°ê³„ ë° ê°€êµ¬ ì œì™¸     32   1842 0.017
ë„ë§¤ ë° ì†Œë§¤ì—…(45~47)                 ì†Œë§¤ì—…; ìë™ì°¨ ì œì™¸                 64   3699 0.017
ìš´ìˆ˜ ë° ì°½ê³ ì—…(49~52)                 ì°½ê³  ë° ìš´ì†¡ê´€ë ¨ ì„œë¹„ìŠ¤ì—…              11    661 0.017
ì œì¡°ì—…(10~34)                      ê¸°íƒ€ ìš´ì†¡ì¥ë¹„ ì œì¡°ì—…                  6    369 0.016
ìš´ìˆ˜ ë° ì°½ê³ ì—…(49~52)                 ìˆ˜ìƒ ìš´ì†¡ì—…                       2    123 0.016

```

--------------------------------------------------------------------------------

## [ì½”ë“œ #21]

```python
# ëŒ€ë¶„ë¥˜ë³„ ë¶€ë„ìœ¨ ì‹œê°í™”
fig = go.Figure()

fig.add_trace(go.Bar(
    x=major_default.index,
    y=major_default['ë¶€ë„ìœ¨'] * 100,
    text=[f"{v:.2f}%" for v in major_default['ë¶€ë„ìœ¨'] * 100],
    textposition='outside',
    marker_color='indianred',
    name='ë¶€ë„ìœ¨'
))

fig.update_layout(
    title='ëŒ€ë¶„ë¥˜ë³„ ë¶€ë„ìœ¨',
    xaxis_title='ì‚°ì—… ëŒ€ë¶„ë¥˜',
    yaxis_title='ë¶€ë„ìœ¨ (%)',
    height=500,
    font=dict(family='Malgun Gothic', size=12),
    xaxis={'tickangle': -45}
)

fig.show()
```

**ì¶œë ¥:**

--------------------------------------------------------------------------------

## [ì½”ë“œ #22]

```python
# ì¤‘ë¶„ë¥˜ë³„ ë¶€ë„ìœ¨ ì‹œê°í™” (ìƒìœ„ 20ê°œ)
top_20_minor = minor_default.head(20)

# ì¸ë±ìŠ¤ë¥¼ ë¬¸ìì—´ë¡œ ë³€í™˜ (ëŒ€ë¶„ë¥˜ëª… + ì¤‘ë¶„ë¥˜ëª…)
labels = [f"{major}\n{minor}" for major, minor in top_20_minor.index]

fig = go.Figure()

fig.add_trace(go.Bar(
    x=labels,
    y=top_20_minor['ë¶€ë„ìœ¨'] * 100,
    text=[f"{v:.2f}%" for v in top_20_minor['ë¶€ë„ìœ¨'] * 100],
    textposition='outside',
    marker_color='coral',
    name='ë¶€ë„ìœ¨'
))

fig.update_layout(
    title='ì¤‘ë¶„ë¥˜ë³„ ë¶€ë„ìœ¨ Top 20 (ìµœì†Œ 50ê°œ ê¸°ì—… ì´ìƒ)',
    xaxis_title='ì‚°ì—… ì¤‘ë¶„ë¥˜',
    yaxis_title='ë¶€ë„ìœ¨ (%)',
    height=600,
    font=dict(family='Malgun Gothic', size=10),
    xaxis={'tickangle': -45}
)

fig.show()
```

**ì¶œë ¥:**

--------------------------------------------------------------------------------

## [ë§ˆí¬ë‹¤ìš´ #13]

### 4.4.2 ì—…ì¢…ë³„ ì¬ë¬´ì§€í‘œ ë¦¬ìŠ¤í¬ ë¶„ì„

--------------------------------------------------------------------------------

## [ì½”ë“œ #23]

```python
# ì£¼ìš” ì¬ë¬´ì§€í‘œë³„ ì—…ì¢… í‰ê· 
key_ratios = [
    'ì¬ë¬´ë¹„ìœ¨_ë¶€ì±„ë¹„ìœ¨',
    'ì¬ë¬´ë¹„ìœ¨_ìœ ë™ë¹„ìœ¨',
    'ì¬ë¬´ë¹„ìœ¨_ìê¸°ìë³¸ë¹„ìœ¨',
    'ì¬ë¬´ë¹„ìœ¨_ì˜ì—…ì´ìµìœ¨',
    'ì¬ë¬´ë¹„ìœ¨_ë‹¹ê¸°ìˆœì´ìµìœ¨',
    'ì¬ë¬´ë¹„ìœ¨_ìê¸°ìë³¸ì´ìµë¥ (ROE)',
    'ë‹¹ì¢Œë¹„ìœ¨',
    'ì´ìë³´ìƒë°°ìœ¨'
]

# ëŒ€ë¶„ë¥˜ë³„ ì¬ë¬´ì§€í‘œ í‰ê·  (ë¶€ë„ê¸°ì—… vs ì •ìƒê¸°ì—…)
industry_risk = {}

for ratio in key_ratios:
    if ratio in df_industry.columns:
        industry_comparison = df_industry.groupby(['ëŒ€ë¶„ë¥˜ëª…', target_col])[ratio].agg(['mean', 'median', 'std']).round(2)
        industry_risk[ratio] = industry_comparison
        
        print(f"\n=== {ratio} - ëŒ€ë¶„ë¥˜ë³„ ë¹„êµ ===")
        print(industry_comparison)
```

**ì¶œë ¥:**

```

=== ì¬ë¬´ë¹„ìœ¨_ë¶€ì±„ë¹„ìœ¨ - ëŒ€ë¶„ë¥˜ë³„ ë¹„êµ ===
                                                                  mean  \
ëŒ€ë¶„ë¥˜ëª…                            ëª¨í˜•ê°œë°œìš©Performance(í–¥í›„1ë…„ë‚´ë¶€ë„ì—¬ë¶€)              
ê±´ì„¤ì—…(41~42)                      0                             -524.600   
                                1                              371.210   
ê³µê³µ í–‰ì •, êµ­ë°© ë° ì‚¬íšŒë³´ì¥ í–‰ì •(84)         0                              366.080   
ê´‘ì—…(05~08)                       0                             1113.370   
                                1                              -52.520   
êµìœ¡ ì„œë¹„ìŠ¤ì—…(85)                     0                              209.770   
                                1                              -23.890   
ê¸ˆìœµ ë° ë³´í—˜ì—…(64~66)                 0                             1010.430   
ë†ì—…, ì„ì—… ë° ì–´ì—…(01~03)              0                               60.330   
                                1                              187.560   
ë„ë§¤ ë° ì†Œë§¤ì—…(45~47)                 0                             -197.790   
                                1                              351.030   
ë³´ê±´ì—… ë° ì‚¬íšŒë³µì§€ ì„œë¹„ìŠ¤ì—…(86~87)          0                              -34.660   
                                1                               77.130   
ë¶€ë™ì‚°ì—…(68)                        0                            -4800.670   
                                1                              496.950   
ì‚¬ì—…ì‹œì„¤ ê´€ë¦¬, ì‚¬ì—… ì§€ì› ë° ì„ëŒ€ ì„œë¹„ìŠ¤ì—…(74~76) 0                             1603.670   
                                1                              182.720   
ìˆ˜ë„, í•˜ìˆ˜ ë° íê¸°ë¬¼ ì²˜ë¦¬, ì›ë£Œ ì¬ìƒì—…(36~39)  0                             1280.050   
                                1                              109.410   
ìˆ™ë°• ë° ìŒì‹ì ì—…(55~56)                0                             -211.850   
                                1                           282213.690   
ì˜ˆìˆ , ìŠ¤í¬ì¸  ë° ì—¬ê°€ê´€ë ¨ ì„œë¹„ìŠ¤ì—…(90~91)      0                              587.410   
                                1                               -5.430   
ìš´ìˆ˜ ë° ì°½ê³ ì—…(49~52)                 0                              635.760   
                                1                              207.390   

... (705ì¤„ ìƒëµ) ...

ì˜ˆìˆ , ìŠ¤í¬ì¸  ë° ì—¬ê°€ê´€ë ¨ ì„œë¹„ìŠ¤ì—…(90~91)      0                           45.630  
                                1                           42.230  
ìš´ìˆ˜ ë° ì°½ê³ ì—…(49~52)                 0                           47.750  
                                1                           32.010  
ì „ê¸°, ê°€ìŠ¤, ì¦ê¸° ë° ê³µê¸° ì¡°ì ˆ ê³µê¸‰ì—…(35)      0                           38.370  
                                1                           65.240  
ì „ë¬¸, ê³¼í•™ ë° ê¸°ìˆ  ì„œë¹„ìŠ¤ì—…(70~73)         0                           54.290  
                                1                           56.560  
ì •ë³´í†µì‹ ì—…(58~63)                    0                           51.570  
                                1                           51.000  
ì œì¡°ì—…(10~34)                      0                           40.440  
                                1                           35.180  
í˜‘íšŒ ë° ë‹¨ì²´, ìˆ˜ë¦¬ ë° ê¸°íƒ€ ê°œì¸ ì„œë¹„ìŠ¤ì—…(94~96) 0                           51.780  
                                1                           63.730  

```

--------------------------------------------------------------------------------

## [ì½”ë“œ #24]

```python
# ì—…ì¢…ë³„ ë¶€ì±„ë¹„ìœ¨ ë¹„êµ (ë¶€ë„ vs ì •ìƒ)
if 'ì¬ë¬´ë¹„ìœ¨_ë¶€ì±„ë¹„ìœ¨' in df_industry.columns:
    debt_ratio_by_industry = df_industry.groupby(['ëŒ€ë¶„ë¥˜ëª…', target_col])['ì¬ë¬´ë¹„ìœ¨_ë¶€ì±„ë¹„ìœ¨'].median().unstack()
    
    fig = go.Figure()
    
    fig.add_trace(go.Bar(
        name='ì •ìƒê¸°ì—…',
        x=debt_ratio_by_industry.index,
        y=debt_ratio_by_industry[0],
        marker_color='lightblue'
    ))
    
    fig.add_trace(go.Bar(
        name='ë¶€ë„ê¸°ì—…',
        x=debt_ratio_by_industry.index,
        y=debt_ratio_by_industry[1],
        marker_color='darkred'
    ))
    
    fig.update_layout(
        title='ì—…ì¢…ë³„ ë¶€ì±„ë¹„ìœ¨ ë¹„êµ (ì¤‘ì•™ê°’)',
        xaxis_title='ì‚°ì—… ëŒ€ë¶„ë¥˜',
        yaxis_title='ë¶€ì±„ë¹„ìœ¨ (%)',
        barmode='group',
        height=500,
        font=dict(family='Malgun Gothic', size=12),
        xaxis={'tickangle': -45}
    )
    
    fig.show()
```

**ì¶œë ¥:**

--------------------------------------------------------------------------------

## [ì½”ë“œ #25]

```python
# ì—…ì¢…ë³„ ìœ ë™ë¹„ìœ¨ ë¹„êµ (ë¶€ë„ vs ì •ìƒ)
if 'ì¬ë¬´ë¹„ìœ¨_ìœ ë™ë¹„ìœ¨' in df_industry.columns:
    current_ratio_by_industry = df_industry.groupby(['ëŒ€ë¶„ë¥˜ëª…', target_col])['ì¬ë¬´ë¹„ìœ¨_ìœ ë™ë¹„ìœ¨'].median().unstack()
    
    fig = go.Figure()
    
    fig.add_trace(go.Bar(
        name='ì •ìƒê¸°ì—…',
        x=current_ratio_by_industry.index,
        y=current_ratio_by_industry[0],
        marker_color='lightgreen'
    ))
    
    fig.add_trace(go.Bar(
        name='ë¶€ë„ê¸°ì—…',
        x=current_ratio_by_industry.index,
        y=current_ratio_by_industry[1],
        marker_color='orange'
    ))
    
    fig.update_layout(
        title='ì—…ì¢…ë³„ ìœ ë™ë¹„ìœ¨ ë¹„êµ (ì¤‘ì•™ê°’)',
        xaxis_title='ì‚°ì—… ëŒ€ë¶„ë¥˜',
        yaxis_title='ìœ ë™ë¹„ìœ¨ (%)',
        barmode='group',
        height=500,
        font=dict(family='Malgun Gothic', size=12),
        xaxis={'tickangle': -45}
    )
    
    fig.show()
```

**ì¶œë ¥:**

--------------------------------------------------------------------------------

## [ë§ˆí¬ë‹¤ìš´ #14]

### 4.4.3 ì—…ì¢…ë³„ ìœ ë™ì„± ìœ„ê¸° ë¶„ì„

--------------------------------------------------------------------------------

## [ì½”ë“œ #26]

```python
# ìœ ë™ì„± ì§€í‘œ
liquidity_cols = [
    'ì¬ë¬´ë¹„ìœ¨_ìœ ë™ë¹„ìœ¨',
    'ë‹¹ì¢Œë¹„ìœ¨',
    'ìˆœìš´ì „ìë³¸',
    'í˜„ê¸ˆ',
    'í˜„ê¸ˆë“±ê°€ë¬¼',
    'í˜„ê¸ˆì„±ìì‚°'
]

available_liquidity = [col for col in liquidity_cols if col in df_industry.columns]

if available_liquidity:
    # ëŒ€ë¶„ë¥˜ë³„ ìœ ë™ì„± ì§€í‘œ í‰ê· 
    liquidity_by_industry = df_industry.groupby(['ëŒ€ë¶„ë¥˜ëª…', target_col])[available_liquidity].median().round(2)
    
    print("=== ì—…ì¢…ë³„ ìœ ë™ì„± ì§€í‘œ (ì¤‘ì•™ê°’) ===")
    print(liquidity_by_industry)
```

**ì¶œë ¥:**

```
=== ì—…ì¢…ë³„ ìœ ë™ì„± ì§€í‘œ (ì¤‘ì•™ê°’) ===
                                                             ì¬ë¬´ë¹„ìœ¨_ìœ ë™ë¹„ìœ¨  ë‹¹ì¢Œë¹„ìœ¨  \
ëŒ€ë¶„ë¥˜ëª…                            ëª¨í˜•ê°œë°œìš©Performance(í–¥í›„1ë…„ë‚´ë¶€ë„ì—¬ë¶€)                    
ê±´ì„¤ì—…(41~42)                      0                              292.830 2.300   
                                1                              229.230 1.670   
ê³µê³µ í–‰ì •, êµ­ë°© ë° ì‚¬íšŒë³´ì¥ í–‰ì •(84)         0                               89.690 0.860   
ê´‘ì—…(05~08)                       0                              191.230 1.730   
                                1                                3.640 0.040   
êµìœ¡ ì„œë¹„ìŠ¤ì—…(85)                     0                              145.340 1.170   
                                1                              113.000 0.370   
ê¸ˆìœµ ë° ë³´í—˜ì—…(64~66)                 0                              162.790 1.550   
ë†ì—…, ì„ì—… ë° ì–´ì—…(01~03)              0                              154.720 1.180   
                                1                              160.100 1.220   
ë„ë§¤ ë° ì†Œë§¤ì—…(45~47)                 0                              186.980 1.350   
                                1                              169.740 1.140   
ë³´ê±´ì—… ë° ì‚¬íšŒë³µì§€ ì„œë¹„ìŠ¤ì—…(86~87)          0                              106.490 0.880   
                                1                              118.770 1.060   
ë¶€ë™ì‚°ì—…(68)                        0                              165.270 0.680   
                                1                              100.230 0.290   
ì‚¬ì—…ì‹œì„¤ ê´€ë¦¬, ì‚¬ì—… ì§€ì› ë° ì„ëŒ€ ì„œë¹„ìŠ¤ì—…(74~76) 0                              168.010 1.460   
                                1                              121.560 0.980   
ìˆ˜ë„, í•˜ìˆ˜ ë° íê¸°ë¬¼ ì²˜ë¦¬, ì›ë£Œ ì¬ìƒì—…(36~39)  0                              174.290 1.510   
                                1                               76.830 0.620   
ìˆ™ë°• ë° ìŒì‹ì ì—…(55~56)                0                               82.810 0.590   
                                1                              122.670 1.010   
ì˜ˆìˆ , ìŠ¤í¬ì¸  ë° ì—¬ê°€ê´€ë ¨ ì„œë¹„ìŠ¤ì—…(90~91)      0                               69.510 0.610   
                                1                              199.060 0.820   
ìš´ìˆ˜ ë° ì°½ê³ ì—…(49~52)                 0                              133.290 1.190   
                                1                              115.740 0.990   
ì „ê¸°, ê°€ìŠ¤, ì¦ê¸° ë° ê³µê¸° ì¡°ì ˆ ê³µê¸‰ì—…(35)      0                              105.300 0.890   

... (112ì¤„ ìƒëµ) ...

ì˜ˆìˆ , ìŠ¤í¬ì¸  ë° ì—¬ê°€ê´€ë ¨ ì„œë¹„ìŠ¤ì—…(90~91)      0                             67730.500  
                                1                                 0.000  
ìš´ìˆ˜ ë° ì°½ê³ ì—…(49~52)                 0                                 0.000  
                                1                                 0.000  
ì „ê¸°, ê°€ìŠ¤, ì¦ê¸° ë° ê³µê¸° ì¡°ì ˆ ê³µê¸‰ì—…(35)      0                           2161944.500  
                                1                             35311.500  
ì „ë¬¸, ê³¼í•™ ë° ê¸°ìˆ  ì„œë¹„ìŠ¤ì—…(70~73)         0                                 0.000  
                                1                                 0.000  
ì •ë³´í†µì‹ ì—…(58~63)                    0                                 0.000  
                                1                                 0.000  
ì œì¡°ì—…(10~34)                      0                                 0.000  
                                1                                 0.000  
í˜‘íšŒ ë° ë‹¨ì²´, ìˆ˜ë¦¬ ë° ê¸°íƒ€ ê°œì¸ ì„œë¹„ìŠ¤ì—…(94~96) 0                                 0.000  
                                1                                 0.000  

```

--------------------------------------------------------------------------------

## [ì½”ë“œ #27]

```python
# ì—…ì¢…ë³„ ìœ ë™ì„± íˆíŠ¸ë§µ (í…ìŠ¤íŠ¸ ì œê±° ë²„ì „)
if len(available_liquidity) >= 2:
    # ì •ìƒê¸°ì—… ê¸°ì¤€ ì—…ì¢…ë³„ ìœ ë™ì„± ì§€í‘œ
    normal_liquidity = df_industry[df_industry[target_col] == 0].groupby('ëŒ€ë¶„ë¥˜ëª…')[available_liquidity].median()

    # í‘œì¤€í™” (0-1 ìŠ¤ì¼€ì¼)
    from sklearn.preprocessing import MinMaxScaler
    scaler = MinMaxScaler()
    normal_liquidity_scaled = pd.DataFrame(
        scaler.fit_transform(normal_liquidity),
        columns=normal_liquidity.columns,
        index=normal_liquidity.index
    )

    fig = go.Figure(data=go.Heatmap(
        z=normal_liquidity_scaled.T.values,
        x=normal_liquidity_scaled.index,
        y=normal_liquidity_scaled.columns,
        colorscale='RdYlGn',
        text=normal_liquidity.T.values,
        hovertemplate='<b>%{y}</b><br>%{x}<br>ì¤‘ì•™ê°’: %{text:,.1f}<br>í‘œì¤€í™”: %{z:.3f}<extra></extra>'
    ))

    fig.update_layout(
        title='ì—…ì¢…ë³„ ìœ ë™ì„± ì§€í‘œ íˆíŠ¸ë§µ (ì •ìƒê¸°ì—… ì¤‘ì•™ê°’, í‘œì¤€í™”)<br><sub>ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦¬ë©´ ìƒì„¸ ê°’ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</sub>',
        xaxis_title='ì‚°ì—… ëŒ€ë¶„ë¥˜',
        yaxis_title='ìœ ë™ì„± ì§€í‘œ',
        height=500,
        width=1200,
        font=dict(family='Malgun Gothic', size=11),
        xaxis={'tickangle': -45},
        margin=dict(l=150, r=50, t=100, b=150)  # ì—¬ë°± ì¡°ì •
    )

    fig.show()
```

**ì¶œë ¥:**

--------------------------------------------------------------------------------

## [ë§ˆí¬ë‹¤ìš´ #15]

### 4.4.4 ì—…ì¢…ë³„ ë¦¬ìŠ¤í¬ ìŠ¤ì½”ì–´

--------------------------------------------------------------------------------

## [ì½”ë“œ #28]

```python
# ì—…ì¢…ë³„ ì¢…í•© ë¦¬ìŠ¤í¬ ìŠ¤ì½”ì–´ ê³„ì‚°
industry_risk_score = pd.DataFrame()

# 1. ë¶€ë„ìœ¨ (ë†’ì„ìˆ˜ë¡ ìœ„í—˜)
industry_risk_score['ë¶€ë„ìœ¨'] = major_default['ë¶€ë„ìœ¨']

# 2. í‰ê·  ë¶€ì±„ë¹„ìœ¨ (ë†’ì„ìˆ˜ë¡ ìœ„í—˜)
if 'ì¬ë¬´ë¹„ìœ¨_ë¶€ì±„ë¹„ìœ¨' in df_industry.columns:
    industry_risk_score['í‰ê· ë¶€ì±„ë¹„ìœ¨'] = df_industry.groupby('ëŒ€ë¶„ë¥˜ëª…')['ì¬ë¬´ë¹„ìœ¨_ë¶€ì±„ë¹„ìœ¨'].median()

# 3. í‰ê·  ìœ ë™ë¹„ìœ¨ (ë‚®ì„ìˆ˜ë¡ ìœ„í—˜, ì—­ìˆ˜ ì·¨í•¨)
if 'ì¬ë¬´ë¹„ìœ¨_ìœ ë™ë¹„ìœ¨' in df_industry.columns:
    avg_current = df_industry.groupby('ëŒ€ë¶„ë¥˜ëª…')['ì¬ë¬´ë¹„ìœ¨_ìœ ë™ë¹„ìœ¨'].median()
    industry_risk_score['ìœ ë™ë¹„ìœ¨ì—­ìˆ˜'] = 1 / (avg_current / 100 + 0.01)  # 0ìœ¼ë¡œ ë‚˜ëˆ„ê¸° ë°©ì§€

# 4. í‰ê·  ì˜ì—…ì´ìµë¥  (ë‚®ì„ìˆ˜ë¡ ìœ„í—˜, ìŒìˆ˜ë©´ ë” ìœ„í—˜)
if 'ì¬ë¬´ë¹„ìœ¨_ì˜ì—…ì´ìµìœ¨' in df_industry.columns:
    industry_risk_score['ì˜ì—…ì´ìµë¥ '] = -df_industry.groupby('ëŒ€ë¶„ë¥˜ëª…')['ì¬ë¬´ë¹„ìœ¨_ì˜ì—…ì´ìµìœ¨'].median()  # ìŒìˆ˜ ì·¨í•¨

# í‘œì¤€í™” ë° ì¢…í•© ìŠ¤ì½”ì–´
from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()
risk_scaled = pd.DataFrame(
    scaler.fit_transform(industry_risk_score.fillna(0)),
    columns=industry_risk_score.columns,
    index=industry_risk_score.index
)

# ì¢…í•© ë¦¬ìŠ¤í¬ ìŠ¤ì½”ì–´ (í‰ê· )
industry_risk_score['ì¢…í•©ë¦¬ìŠ¤í¬ìŠ¤ì½”ì–´'] = risk_scaled.mean(axis=1)
industry_risk_score = industry_risk_score.sort_values('ì¢…í•©ë¦¬ìŠ¤í¬ìŠ¤ì½”ì–´', ascending=False)

print("=== ì—…ì¢…ë³„ ì¢…í•© ë¦¬ìŠ¤í¬ ìŠ¤ì½”ì–´ ===")
print(industry_risk_score.round(3))
```

**ì¶œë ¥:**

```
=== ì—…ì¢…ë³„ ì¢…í•© ë¦¬ìŠ¤í¬ ìŠ¤ì½”ì–´ ===
                                  ë¶€ë„ìœ¨  í‰ê· ë¶€ì±„ë¹„ìœ¨  ìœ ë™ë¹„ìœ¨ì—­ìˆ˜  ì˜ì—…ì´ìµë¥   ì¢…í•©ë¦¬ìŠ¤í¬ìŠ¤ì½”ì–´
ëŒ€ë¶„ë¥˜ëª…                                                                  
ê³µê³µ í–‰ì •, êµ­ë°© ë° ì‚¬íšŒë³´ì¥ í–‰ì •(84)         0.000 490.443   1.103  4.287     1.822
ìˆ™ë°• ë° ìŒì‹ì ì—…(55~56)                0.025 133.760   1.170 -0.000     1.086
ì˜ˆìˆ , ìŠ¤í¬ì¸  ë° ì—¬ê°€ê´€ë ¨ ì„œë¹„ìŠ¤ì—…(90~91)      0.021 103.060   1.417 -3.548     0.685
ë¶€ë™ì‚°ì—…(68)                        0.029 143.176   0.608 -1.816     0.472
ë†ì—…, ì„ì—… ë° ì–´ì—…(01~03)              0.033 142.181   0.641 -3.180     0.455
ìš´ìˆ˜ ë° ì°½ê³ ì—…(49~52)                 0.014 126.505   0.746 -1.718     0.124
ë³´ê±´ì—… ë° ì‚¬íšŒë³µì§€ ì„œë¹„ìŠ¤ì—…(86~87)          0.007 139.685   0.922 -1.828     0.101
ì „ê¸°, ê°€ìŠ¤, ì¦ê¸° ë° ê³µê¸° ì¡°ì ˆ ê³µê¸‰ì—…(35)      0.012 158.760   0.941 -5.188    -0.097
ì‚¬ì—…ì‹œì„¤ ê´€ë¦¬, ì‚¬ì—… ì§€ì› ë° ì„ëŒ€ ì„œë¹„ìŠ¤ì—…(74~76) 0.010 109.544   0.593 -1.393    -0.153
êµìœ¡ ì„œë¹„ìŠ¤ì—…(85)                     0.013  93.578   0.684 -3.003    -0.213
ë„ë§¤ ë° ì†Œë§¤ì—…(45~47)                 0.014 131.815   0.533 -3.282    -0.242
ì œì¡°ì—…(10~34)                      0.014 124.962   0.606 -3.852    -0.283
í˜‘íšŒ ë° ë‹¨ì²´, ìˆ˜ë¦¬ ë° ê¸°íƒ€ ê°œì¸ ì„œë¹„ìŠ¤ì—…(94~96) 0.006 125.474   0.601 -2.337    -0.332
ì •ë³´í†µì‹ ì—…(58~63)                    0.012  90.989   0.562 -3.250    -0.413
ì „ë¬¸, ê³¼í•™ ë° ê¸°ìˆ  ì„œë¹„ìŠ¤ì—…(70~73)         0.016  82.143   0.455 -3.233    -0.415
ê±´ì„¤ì—…(41~42)                      0.017  68.352   0.341 -3.476    -0.553
ìˆ˜ë„, í•˜ìˆ˜ ë° íê¸°ë¬¼ ì²˜ë¦¬, ì›ë£Œ ì¬ìƒì—…(36~39)  0.010  99.153   0.571 -4.585    -0.596
ê´‘ì—…(05~08)                       0.010  72.589   0.520 -4.020    -0.656
ê¸ˆìœµ ë° ë³´í—˜ì—…(64~66)                 0.000 112.529   0.611 -4.429    -0.792

```

--------------------------------------------------------------------------------

## [ì½”ë“œ #29]

```python
# ì¢…í•© ë¦¬ìŠ¤í¬ ìŠ¤ì½”ì–´ ì‹œê°í™”
fig = go.Figure()

colors = ['red' if score > 0 else 'green' for score in industry_risk_score['ì¢…í•©ë¦¬ìŠ¤í¬ìŠ¤ì½”ì–´']]

fig.add_trace(go.Bar(
    x=industry_risk_score.index,
    y=industry_risk_score['ì¢…í•©ë¦¬ìŠ¤í¬ìŠ¤ì½”ì–´'],
    marker_color=colors,
    text=[f"{v:.2f}" for v in industry_risk_score['ì¢…í•©ë¦¬ìŠ¤í¬ìŠ¤ì½”ì–´']],
    textposition='outside'
))

fig.update_layout(
    title='ì—…ì¢…ë³„ ì¢…í•© ë¦¬ìŠ¤í¬ ìŠ¤ì½”ì–´ (í‘œì¤€í™”)',
    xaxis_title='ì‚°ì—… ëŒ€ë¶„ë¥˜',
    yaxis_title='ì¢…í•© ë¦¬ìŠ¤í¬ ìŠ¤ì½”ì–´',
    height=500,
    font=dict(family='Malgun Gothic', size=12),
    xaxis={'tickangle': -45}
)

fig.show()
```

**ì¶œë ¥:**

--------------------------------------------------------------------------------

## [ë§ˆí¬ë‹¤ìš´ #16]

### 4.4.5 ì—…ì¢…ë³„ ì¸ì‚¬ì´íŠ¸ ìš”ì•½

--------------------------------------------------------------------------------

## [ì½”ë“œ #30]

```python
print("\n" + "="*80)
print("ğŸ“Š ì—…ì¢…ë³„ ë¦¬ìŠ¤í¬ ë¶„ì„ - í•µì‹¬ ì¸ì‚¬ì´íŠ¸")
print("="*80)

# 1. ë¶€ë„ìœ¨ ìµœê³ /ìµœì € ì—…ì¢…
print("\n1ï¸âƒ£ ë¶€ë„ìœ¨ ë¶„ì„")
print(f"   - ìµœê³  ë¶€ë„ìœ¨: {major_default.index[0]} ({major_default['ë¶€ë„ìœ¨'].iloc[0]*100:.2f}%)")
print(f"   - ìµœì € ë¶€ë„ìœ¨: {major_default.index[-1]} ({major_default['ë¶€ë„ìœ¨'].iloc[-1]*100:.2f}%)")
print(f"   - ì „ì²´ í‰ê· : {major_default['ë¶€ë„ìœ¨'].mean()*100:.2f}%")

# 2. ë¦¬ìŠ¤í¬ ìŠ¤ì½”ì–´ ìµœê³ /ìµœì € ì—…ì¢…
print("\n2ï¸âƒ£ ì¢…í•© ë¦¬ìŠ¤í¬ ìŠ¤ì½”ì–´")
print(f"   - ìµœê³  ìœ„í—˜: {industry_risk_score.index[0]} (ìŠ¤ì½”ì–´: {industry_risk_score['ì¢…í•©ë¦¬ìŠ¤í¬ìŠ¤ì½”ì–´'].iloc[0]:.3f})")
print(f"   - ìµœì € ìœ„í—˜: {industry_risk_score.index[-1]} (ìŠ¤ì½”ì–´: {industry_risk_score['ì¢…í•©ë¦¬ìŠ¤í¬ìŠ¤ì½”ì–´'].iloc[-1]:.3f})")

# 3. ì—…ì¢…ë³„ ê¸°ì—… ë¶„í¬
print("\n3ï¸âƒ£ ì—…ì¢…ë³„ ê¸°ì—… ë¶„í¬ (ìƒìœ„ 3ê°œ)")
top_3_industries = df_industry['ëŒ€ë¶„ë¥˜ëª…'].value_counts().head(3)
for idx, (industry, count) in enumerate(top_3_industries.items(), 1):
    pct = count / len(df_industry) * 100
    print(f"   {idx}. {industry}: {count:,}ê°œ ê¸°ì—… ({pct:.1f}%)")

# 4. ì¬ë¬´ì§€í‘œ íŠ¹ì„±
if 'ì¬ë¬´ë¹„ìœ¨_ë¶€ì±„ë¹„ìœ¨' in df_industry.columns:
    print("\n4ï¸âƒ£ ì¬ë¬´ íŠ¹ì„±")
    high_debt = df_industry.groupby('ëŒ€ë¶„ë¥˜ëª…')['ì¬ë¬´ë¹„ìœ¨_ë¶€ì±„ë¹„ìœ¨'].median().idxmax()
    high_debt_val = df_industry.groupby('ëŒ€ë¶„ë¥˜ëª…')['ì¬ë¬´ë¹„ìœ¨_ë¶€ì±„ë¹„ìœ¨'].median().max()
    print(f"   - ë¶€ì±„ë¹„ìœ¨ ìµœê³  ì—…ì¢…: {high_debt} ({high_debt_val:.1f}%)")
    
if 'ì¬ë¬´ë¹„ìœ¨_ìœ ë™ë¹„ìœ¨' in df_industry.columns:
    low_liquidity = df_industry.groupby('ëŒ€ë¶„ë¥˜ëª…')['ì¬ë¬´ë¹„ìœ¨_ìœ ë™ë¹„ìœ¨'].median().idxmin()
    low_liquidity_val = df_industry.groupby('ëŒ€ë¶„ë¥˜ëª…')['ì¬ë¬´ë¹„ìœ¨_ìœ ë™ë¹„ìœ¨'].median().min()
    print(f"   - ìœ ë™ë¹„ìœ¨ ìµœì € ì—…ì¢…: {low_liquidity} ({low_liquidity_val:.1f}%)")

print("\n" + "="*80)
```

**ì¶œë ¥:**

```

================================================================================
ğŸ“Š ì—…ì¢…ë³„ ë¦¬ìŠ¤í¬ ë¶„ì„ - í•µì‹¬ ì¸ì‚¬ì´íŠ¸
================================================================================

1ï¸âƒ£ ë¶€ë„ìœ¨ ë¶„ì„
   - ìµœê³  ë¶€ë„ìœ¨: ë†ì—…, ì„ì—… ë° ì–´ì—…(01~03) (3.30%)
   - ìµœì € ë¶€ë„ìœ¨: ê¸ˆìœµ ë° ë³´í—˜ì—…(64~66) (0.00%)
   - ì „ì²´ í‰ê· : 1.37%

2ï¸âƒ£ ì¢…í•© ë¦¬ìŠ¤í¬ ìŠ¤ì½”ì–´
   - ìµœê³  ìœ„í—˜: ê³µê³µ í–‰ì •, êµ­ë°© ë° ì‚¬íšŒë³´ì¥ í–‰ì •(84) (ìŠ¤ì½”ì–´: 1.822)
   - ìµœì € ìœ„í—˜: ê¸ˆìœµ ë° ë³´í—˜ì—…(64~66) (ìŠ¤ì½”ì–´: -0.792)

3ï¸âƒ£ ì—…ì¢…ë³„ ê¸°ì—… ë¶„í¬ (ìƒìœ„ 3ê°œ)
   1. ì œì¡°ì—…(10~34): 18,687ê°œ ê¸°ì—… (37.3%)
   2. ë„ë§¤ ë° ì†Œë§¤ì—…(45~47): 10,942ê°œ ê¸°ì—… (21.8%)
   3. ê±´ì„¤ì—…(41~42): 6,277ê°œ ê¸°ì—… (12.5%)

4ï¸âƒ£ ì¬ë¬´ íŠ¹ì„±
   - ë¶€ì±„ë¹„ìœ¨ ìµœê³  ì—…ì¢…: ê³µê³µ í–‰ì •, êµ­ë°© ë° ì‚¬íšŒë³´ì¥ í–‰ì •(84) (490.4%)
   - ìœ ë™ë¹„ìœ¨ ìµœì € ì—…ì¢…: ì˜ˆìˆ , ìŠ¤í¬ì¸  ë° ì—¬ê°€ê´€ë ¨ ì„œë¹„ìŠ¤ì—…(90~91) (69.6%)

================================================================================

```

--------------------------------------------------------------------------------

## [ë§ˆí¬ë‹¤ìš´ #17]

## 5. ì‹ ìš©ì •ë³´ ê¸°ë°˜ ë¶€ë„ ì˜ˆì¸¡ë ¥ ë¶„ì„

--------------------------------------------------------------------------------

## [ì½”ë“œ #31]

```python
# ì‹ ìš©ì •ë³´ ê´€ë ¨ ì»¬ëŸ¼ ë¶„ì„
credit_cols = [col for col in df.columns if any(keyword in col for keyword in 
                                                ['ì—°ì²´', 'ì²´ë‚©', 'ì‹ ìš©í‰ê°€ë“±ê¸‰', 'ì••ë¥˜', 'ì†Œì†¡'])]

if credit_cols and target_col in df.columns:
    print("\nğŸ’³ ì‹ ìš©ì •ë³´ ê¸°ë°˜ ë¶€ë„ ì˜ˆì¸¡ë ¥ ë¶„ì„")
    print("="*60)
    
    # ì—°ì²´ ê´€ë ¨ ë³€ìˆ˜ ë¶„ì„
    delinquency_cols = [col for col in credit_cols if 'ì—°ì²´' in col]
    
    if delinquency_cols:
        # ì—°ì²´ ì—¬ë¶€ ìƒì„±
        df['ì—°ì²´ì—¬ë¶€'] = (df[delinquency_cols].sum(axis=1) > 0).astype(int)
        
        # ì—°ì²´ì™€ ë¶€ë„ì˜ ê´€ê³„
        delinquency_bankruptcy = pd.crosstab(df['ì—°ì²´ì—¬ë¶€'], df[target_col],
                                           rownames=['ì—°ì²´'], colnames=['ë¶€ë„'],
                                           normalize='columns') * 100
        
        print("\nì—°ì²´ ì—¬ë¶€ì™€ ë¶€ë„ì˜ ê´€ê³„ (%)")
        print(delinquency_bankruptcy)
    
    # ì‹ ìš©ë“±ê¸‰ ë¶„ì„
    rating_cols = [col for col in credit_cols if 'ë“±ê¸‰' in col]
    
    if rating_cols:
        rating_col = rating_cols[0]
        
        # ì‹ ìš©ë“±ê¸‰ë³„ ë¶€ë„ìœ¨
        rating_bankruptcy = df.groupby(rating_col)[target_col].agg(['count', 'sum', 'mean'])
        rating_bankruptcy.columns = ['ê¸°ì—…ìˆ˜', 'ë¶€ë„ê¸°ì—…ìˆ˜', 'ë¶€ë„ìœ¨']
        rating_bankruptcy['ë¶€ë„ìœ¨(%)'] = rating_bankruptcy['ë¶€ë„ìœ¨'] * 100
        rating_bankruptcy = rating_bankruptcy.sort_values('ë¶€ë„ìœ¨(%)', ascending=False)
        
        print(f"\nì‹ ìš©ë“±ê¸‰ë³„ ë¶€ë„ìœ¨ (ìƒìœ„ 10ê°œ)")
        print(rating_bankruptcy.head(10))
        
        # ì‹œê°í™”
        if len(rating_bankruptcy) > 0:
            fig = go.Figure()
            fig.add_trace(go.Bar(
                x=rating_bankruptcy.index[:15],
                y=rating_bankruptcy['ë¶€ë„ìœ¨(%)'][:15],
                text=[f"{v:.2f}%" for v in rating_bankruptcy['ë¶€ë„ìœ¨(%)'][:15]],
                textposition='outside',
                marker_color='crimson'
            ))
            
            fig.update_layout(
                title='ì‹ ìš©ë“±ê¸‰ë³„ ë¶€ë„ìœ¨',
                xaxis_title='ì‹ ìš©ë“±ê¸‰',
                yaxis_title='ë¶€ë„ìœ¨ (%)',
                showlegend=False
            )
            fig.show()
```

**ì¶œë ¥:**

```

ğŸ’³ ì‹ ìš©ì •ë³´ ê¸°ë°˜ ë¶€ë„ ì˜ˆì¸¡ë ¥ ë¶„ì„
============================================================

ì—°ì²´ ì—¬ë¶€ì™€ ë¶€ë„ì˜ ê´€ê³„ (%)
ë¶€ë„      0      1
ì—°ì²´              
0  95.380 57.576
1   4.620 42.424

ì‹ ìš©ë“±ê¸‰ë³„ ë¶€ë„ìœ¨ (ìƒìœ„ 10ê°œ)
                ê¸°ì—…ìˆ˜  ë¶€ë„ê¸°ì—…ìˆ˜   ë¶€ë„ìœ¨  ë¶€ë„ìœ¨(%)
ê¸°ì—…ì‹ ìš©í‰ê°€ë“±ê¸‰(êµ¬ê°„í™”)                           
10              715    107 0.150  14.965
9               774     91 0.118  11.757
8              2758    146 0.053   5.294
7              6053    177 0.029   2.924
6              7312    113 0.015   1.545
5              8296     70 0.008   0.844
3              6992     23 0.003   0.329
4              9211     26 0.003   0.282
1              3515      4 0.001   0.114
2              4443      2 0.000   0.045

```

--------------------------------------------------------------------------------

## [ë§ˆí¬ë‹¤ìš´ #18]

## 6. ì¢…í•© ë¦¬ìŠ¤í¬ ìŠ¤ì½”ì–´ ìƒì„±

--------------------------------------------------------------------------------

## [ì½”ë“œ #32]

```python
def create_risk_score(df):
    """ë„ë©”ì¸ ì§€ì‹ ê¸°ë°˜ ì¢…í•© ë¦¬ìŠ¤í¬ ìŠ¤ì½”ì–´ ìƒì„±"""
    
    risk_score = pd.Series(index=df.index, dtype=float).fillna(0)
    
    # 1. ìœ ë™ì„± ë¦¬ìŠ¤í¬ (30ì )
    if 'ìœ ë™ë¹„ìœ¨' in df.columns:
        risk_score += np.where(df['ìœ ë™ë¹„ìœ¨'] < 1, 10, 0)
        risk_score += np.where(df['ìœ ë™ë¹„ìœ¨'] < 0.5, 10, 0)
    
    if 'í˜„ê¸ˆë¹„ìœ¨' in df.columns:
        risk_score += np.where(df['í˜„ê¸ˆë¹„ìœ¨'] < 0.1, 10, 0)
    
    # 2. ì§€ê¸‰ë¶ˆëŠ¥ ë¦¬ìŠ¤í¬ (30ì )
    if 'ë¶€ì±„ë¹„ìœ¨' in df.columns:
        risk_score += np.where(df['ë¶€ì±„ë¹„ìœ¨'] > 200, 10, 0)
        risk_score += np.where(df['ë¶€ì±„ë¹„ìœ¨'] > 300, 10, 0)
    
    if 'ìë³¸ì ì‹ì—¬ë¶€' in df.columns:
        risk_score += np.where(df['ìë³¸ì ì‹ì—¬ë¶€'] == 1, 10, 0)
    
    # 3. ìˆ˜ìµì„± ë¦¬ìŠ¤í¬ (20ì )
    if 'ROA' in df.columns:
        risk_score += np.where(df['ROA'] < 0, 10, 0)
    
    if 'ì˜ì—…ì´ìµë¥ ' in df.columns:
        risk_score += np.where(df['ì˜ì—…ì´ìµë¥ '] < 0, 10, 0)
    
    # 4. ì‹ ìš© ë¦¬ìŠ¤í¬ (20ì )
    if 'ì—°ì²´ì—¬ë¶€' in df.columns:
        risk_score += np.where(df['ì—°ì²´ì—¬ë¶€'] == 1, 20, 0)
    
    return risk_score

# ë¦¬ìŠ¤í¬ ìŠ¤ì½”ì–´ ê³„ì‚°
df['ì¢…í•©ë¦¬ìŠ¤í¬ìŠ¤ì½”ì–´'] = create_risk_score(df)

# ë¦¬ìŠ¤í¬ ë“±ê¸‰ ë¶„ë¥˜
df['ë¦¬ìŠ¤í¬ë“±ê¸‰'] = pd.cut(df['ì¢…í•©ë¦¬ìŠ¤í¬ìŠ¤ì½”ì–´'], 
                       bins=[0, 20, 40, 60, 100],
                       labels=['ì•ˆì „', 'ì£¼ì˜', 'ê²½ê³ ', 'ìœ„í—˜'])

if target_col in df.columns:
    # ë¦¬ìŠ¤í¬ ë“±ê¸‰ë³„ ë¶€ë„ìœ¨
    risk_bankruptcy = df.groupby('ë¦¬ìŠ¤í¬ë“±ê¸‰')[target_col].agg(['count', 'sum', 'mean'])
    risk_bankruptcy.columns = ['ê¸°ì—…ìˆ˜', 'ë¶€ë„ê¸°ì—…ìˆ˜', 'ë¶€ë„ìœ¨']
    risk_bankruptcy['ë¶€ë„ìœ¨(%)'] = risk_bankruptcy['ë¶€ë„ìœ¨'] * 100
    
    print("\nğŸ¯ ì¢…í•© ë¦¬ìŠ¤í¬ ìŠ¤ì½”ì–´ ê¸°ë°˜ ë¶€ë„ìœ¨")
    print("="*60)
    print(risk_bankruptcy)
    
    # ì‹œê°í™”
    fig = go.Figure()
    
    colors = ['green', 'yellow', 'orange', 'red']
    fig.add_trace(go.Bar(
        x=risk_bankruptcy.index,
        y=risk_bankruptcy['ë¶€ë„ìœ¨(%)'],
        text=[f"{v:.2f}%" for v in risk_bankruptcy['ë¶€ë„ìœ¨(%)']],
        textposition='outside',
        marker_color=colors
    ))
    
    fig.update_layout(
        title='ë„ë©”ì¸ ì§€ì‹ ê¸°ë°˜ ë¦¬ìŠ¤í¬ ë“±ê¸‰ë³„ ë¶€ë„ìœ¨',
        xaxis_title='ë¦¬ìŠ¤í¬ ë“±ê¸‰',
        yaxis_title='ë¶€ë„ìœ¨ (%)',
        showlegend=False
    )
    fig.show()
    
    # ë¦¬ìŠ¤í¬ ìŠ¤ì½”ì–´ì˜ ì˜ˆì¸¡ë ¥ í‰ê°€
    from sklearn.metrics import roc_auc_score, average_precision_score
    
    valid_idx = df['ì¢…í•©ë¦¬ìŠ¤í¬ìŠ¤ì½”ì–´'].notna() & df[target_col].notna()
    if valid_idx.sum() > 0:
        auc = roc_auc_score(df.loc[valid_idx, target_col], 
                          df.loc[valid_idx, 'ì¢…í•©ë¦¬ìŠ¤í¬ìŠ¤ì½”ì–´'] / 100)
        pr_auc = average_precision_score(df.loc[valid_idx, target_col], 
                                       df.loc[valid_idx, 'ì¢…í•©ë¦¬ìŠ¤í¬ìŠ¤ì½”ì–´'] / 100)
        
        print(f"\nğŸ“Š ë„ë©”ì¸ ê¸°ë°˜ ë¦¬ìŠ¤í¬ ìŠ¤ì½”ì–´ ì„±ëŠ¥")
        print(f"ROC-AUC: {auc:.4f}")
        print(f"PR-AUC: {pr_auc:.4f}")
```

**ì¶œë ¥:**

```

ğŸ¯ ì¢…í•© ë¦¬ìŠ¤í¬ ìŠ¤ì½”ì–´ ê¸°ë°˜ ë¶€ë„ìœ¨
============================================================
         ê¸°ì—…ìˆ˜  ë¶€ë„ê¸°ì—…ìˆ˜   ë¶€ë„ìœ¨  ë¶€ë„ìœ¨(%)
ë¦¬ìŠ¤í¬ë“±ê¸‰                            
ì•ˆì „     21098    157 0.007   0.744
ì£¼ì˜     14621    208 0.014   1.423
ê²½ê³       6743    217 0.032   3.218
ìœ„í—˜      2974    161 0.054   5.414

```

```

ğŸ“Š ë„ë©”ì¸ ê¸°ë°˜ ë¦¬ìŠ¤í¬ ìŠ¤ì½”ì–´ ì„±ëŠ¥
ROC-AUC: 0.7083
PR-AUC: 0.0418

```

--------------------------------------------------------------------------------

## [ë§ˆí¬ë‹¤ìš´ #19]

## 7. í•µì‹¬ ì¸ì‚¬ì´íŠ¸ ì •ë¦¬

--------------------------------------------------------------------------------

## [ì½”ë“œ #33]

```python
print("\n" + "="*80)
print("ğŸ“Œ ë„ë©”ì¸ ê¸°ë°˜ ë¶€ë„ ì›ì¸ ë¶„ì„ - í•µì‹¬ ì¸ì‚¬ì´íŠ¸")
print("="*80)

insights = []

# 1. ë¶ˆê· í˜• ë¹„ìœ¨ -> [ìˆ˜ì •] ë¶€ë„ ì‚¬ê±´ì˜ í¬ì†Œì„±ê³¼ ì˜ˆì¸¡ ë‚œì´ë„
if target_col in df.columns:
    bankruptcy_rate = df[target_col].mean() * 100
    insights.append(f"â€¢ [ë¶€ë„ìœ¨] ì „ì²´ ë¶€ë„ìœ¨ {bankruptcy_rate:.2f}%ì˜ ê·¹ë‹¨ì  ë¶ˆê· í˜• ë°ì´í„°ì„. ì´ëŠ” ì¼ë°˜ì ì¸ ì§€ë„í•™ìŠµ ëª¨ë¸ì´ ë‹¤ìˆ˜ í´ë˜ìŠ¤(ì •ìƒ)ì— í¸í–¥ë  ìœ„í—˜ì´ ë§¤ìš° í¼ì„ ì‹œì‚¬í•˜ë©°, ì •êµí•œ ìƒ˜í”Œë§ ê¸°ë²• ì—†ì´ëŠ” ë¶€ë„ íƒì§€ë ¥(Recall) í™•ë³´ê°€ ë¶ˆê°€ëŠ¥í•¨.")

# 2. ìœ ë™ì„± ìœ„ê¸° -> [ìˆ˜ì •] ë‹¨ê¸° ì§€ê¸‰ëŠ¥ë ¥ ìƒì‹¤ (Technical Insolvency)
if 'ìœ ë™ë¹„ìœ¨' in df.columns and target_col in df.columns:
    low_liquidity_bankruptcy = df[df['ìœ ë™ë¹„ìœ¨'] < 1][target_col].mean() * 100 # ìœ ë™ë¹„ìœ¨ 100% ë¯¸ë§Œ
    insights.append(f"â€¢ [ìœ ë™ì„±] ìœ ë™ë¹„ìœ¨ 100% ë¯¸ë§Œ(ìœ ë™ë¶€ì±„ > ìœ ë™ìì‚°)ì¸ 'ì ì¬ì  ìœ ë™ì„± ìœ„ê¸°' ê¸°ì—…ì˜ ë¶€ë„ìœ¨ì€ {low_liquidity_bankruptcy:.2f}%ë¡œ ì „ì²´ í‰ê·  ëŒ€ë¹„ ê¸‰ê²©íˆ ìƒìŠ¹í•¨. íŠ¹íˆ í˜„ê¸ˆì„± ìì‚°ì´ ë¶€ì¡±í•œ ê²½ìš°, í‘ì ë„ì‚°ì˜ ê°€ëŠ¥ì„±ë„ ë°°ì œí•  ìˆ˜ ì—†ëŠ” í•µì‹¬ ìœ„í—˜ ì‹ í˜¸ì„.")

# 3. ìë³¸ì ì‹ -> [ìˆ˜ì •] ë§Œì„±ì  ë¶€ì‹¤ê³¼ ìë³¸ êµ¬ì¡° ì·¨ì•½ì„±
if 'ìë³¸ì ì‹ì—¬ë¶€' in df.columns and target_col in df.columns:
    capital_erosion_bankruptcy = df[df['ìë³¸ì ì‹ì—¬ë¶€'] == 1][target_col].mean() * 100
    insights.append(f"â€¢ [ìë³¸êµ¬ì¡°] ìë³¸ì ì‹(ë¶€ì±„ì´ê³„ > ìì‚°ì´ê³„ ë˜ëŠ” ìë³¸ê¸ˆ ì ì‹) ìƒíƒœì¸ ê¸°ì—…ì˜ ë¶€ë„ìœ¨ì€ {capital_erosion_bankruptcy:.2f}%ì— ë‹¬í•¨. ì´ëŠ” ë‹¨ìˆœí•œ ìœ ë™ì„± ë¬¸ì œë¥¼ ë„˜ì–´ì„  êµ¬ì¡°ì  ë¶€ì‹¤ ìƒíƒœë¡œ, ì™¸ë¶€ ìê¸ˆ ìˆ˜í˜ˆ ì—†ì´ëŠ” ìƒì¡´ì´ ë¶ˆê°€ëŠ¥í•œ 'í•œê³„ ê¸°ì—…'ì˜ ì „í˜•ì ì¸ íŠ¹ì§•ì„.")

# 4. ìˆ˜ìµì„± -> [ìˆ˜ì •] ì˜ì—… í˜„ê¸ˆì°½ì¶œ ëŠ¥ë ¥ í›¼ì†
if 'ROA' in df.columns and target_col in df.columns:
    negative_roa_bankruptcy = df[df['ROA'] < 0][target_col].mean() * 100
    insights.append(f"â€¢ [ìˆ˜ìµì„±] ì´ìì‚°ìˆœì´ìµë¥ (ROA)ì´ ìŒìˆ˜(-)ì¸ ê¸°ì—…ì˜ ë¶€ë„ìœ¨ì€ {negative_roa_bankruptcy:.2f}%ì„. ìì‚°ì„ íš¨ìœ¨ì ìœ¼ë¡œ ìš´ìš©í•˜ì§€ ëª»í•´ ì†ì‹¤ì´ ëˆ„ì ë˜ê³  ìˆìœ¼ë©°, ì´ëŠ” ê³§ ì´ì ë¹„ìš©ì¡°ì°¨ ê°ë‹¹í•˜ì§€ ëª»í•˜ëŠ” 'ì´ìë³´ìƒë°°ìœ¨ 1 ë¯¸ë§Œ' ìƒíƒœì™€ ì—°ê²°ë  ê°€ëŠ¥ì„±ì´ ë†’ìŒ.")

# 5. ì—°ì²´ -> [ìˆ˜ì •] ì‹ ìš© ìœ„í—˜ì˜ í˜„ì‹¤í™” (íŠ¸ë¦¬ê±° ì´ë²¤íŠ¸)
if 'ì—°ì²´ì—¬ë¶€' in df.columns and target_col in df.columns:
    delinquency_bankruptcy = df[df['ì—°ì²´ì—¬ë¶€'] == 1][target_col].mean() * 100
    insights.append(f"â€¢ [ì‹ ìš©ì´ë ¥] ê³¼ê±° ì—°ì²´ ì´ë ¥ì´ ìˆëŠ” ê¸°ì—…ì˜ ë¶€ë„ìœ¨ì€ {delinquency_bankruptcy:.2f}%ë¡œ ì••ë„ì ìœ¼ë¡œ ë†’ìŒ. ì¬ë¬´ì œí‘œê°€ 'ê³¼ê±°ì˜ ì„±ì í‘œ'ë¼ë©´, ì—°ì²´ ì •ë³´ëŠ” 'í˜„ì¬ì˜ ìê¸ˆ ê²½ìƒ‰'ì„ ë³´ì—¬ì£¼ëŠ” ê°€ì¥ ê°•ë ¥í•œ ì„ í–‰ì§€í‘œì´ì ë¶€ë„ì˜ ì§ì ‘ì ì¸ íŠ¸ë¦¬ê±°(Trigger)ì„.")

# ì¶”ê°€ ì œì•ˆ: ì—…ì¢…ë³„ íŠ¹ì„±
insights.append("â€¢ [ì—…ì¢…íŠ¹ì„±] ê±´ì„¤ì—…, ì¡°ì„ ì—… ë“± ìˆ˜ì£¼ ì‚°ì—…ì´ë‚˜ ë„ì†Œë§¤ì—… ë“± ê²½ê¸° ë¯¼ê° ì—…ì¢…ì—ì„œ ë¶€ë„ìœ¨ ì°¨ì´ê°€ ëšœë ·í•  ê²ƒìœ¼ë¡œ ì˜ˆìƒë¨. ë‹¨ì¼ ëª¨ë¸ë³´ë‹¤ëŠ” ì—…ì¢… ê·¸ë£¹ë³„ íŒŒìƒ ë³€ìˆ˜ë‚˜ ë³„ë„ ì„ê³„ê°’ ì ìš©ì´ í•„ìš”í•¨.")


for insight in insights:
    print(insight)

print("\n" + "="*80)
print("ğŸ¯ ë¶€ë„ ì˜ˆì¸¡ ëª¨ë¸ ê°œë°œ ì‹œ ì¤‘ì  ì‚¬í•­")
print("="*80)

recommendations = [
    "1. [ë¶ˆê· í˜• ëŒ€ì‘] ë‹¨ìˆœ SMOTE ì ìš©ì„ ë„˜ì–´, 'EasyEnsemble' ê°™ì€ ì•™ìƒë¸” ê¸°ë°˜ ìƒ˜í”Œë§ì´ë‚˜, ë¶€ë„ ê¸°ì—…ê³¼ ìœ ì‚¬í•œ íŠ¹ì„±ì„ ê°€ì§„ ì •ìƒ ê¸°ì—…(Hard Negative)ì„ ì§‘ì¤‘ í•™ìŠµì‹œí‚¤ëŠ” ì „ëµ í•„ìš”.",
    "2. [ë³€ìˆ˜ ë³€í™˜] ìœ ë™ë¹„ìœ¨, ë¶€ì±„ë¹„ìœ¨ ë“± ì¬ë¬´ ë¹„ìœ¨ì€ ì´ìƒì¹˜(Outlier)ê°€ ë§ìœ¼ë¯€ë¡œ, ë‹¨ìˆœ ì‚¬ìš©ë³´ë‹¤ 'Log ë³€í™˜', 'Winsorization(ê·¹ë‹¨ê°’ ëŒ€ì²´)' ë˜ëŠ” 'êµ¬ê°„í™”(Binning)'ë¥¼ í†µí•´ ê°•ê±´ì„±(Robustness) í™•ë³´.",
    "3. [íŠ¹ì„± ê³µí•™] ë„ë©”ì¸ ì§€ì‹ì„ í™œìš©í•œ íŒŒìƒ ë³€ìˆ˜ ìƒì„± í•„ìˆ˜ (ì˜ˆ: í˜„ê¸ˆíë¦„/ë¶€ì±„ë¹„ìœ¨, ìš´ì „ìë³¸ íšŒì „ìœ¨, ì´ìë³´ìƒë°°ìœ¨ ë“±). ë‹¨ìˆœ ì¬ë¬´ ìˆ˜ì¹˜ë³´ë‹¤ 'ë³€í™”ìœ¨(YoY, QoQ)' ë° 'ë™ì¢… ì—…ê³„ ëŒ€ë¹„ ìƒëŒ€ì  ìœ„ì¹˜(z-score)'ê°€ ë” ë†’ì€ ì˜ˆì¸¡ë ¥ì„ ê°€ì§ˆ ìˆ˜ ìˆìŒ.",
    "4. [ë¹„ì¬ë¬´ ì •ë³´ í™œìš©] ì¬ë¬´ì œí‘œì˜ ì‹œì°¨(Lag) ë¬¸ì œë¥¼ ë³´ì™„í•˜ê¸° ìœ„í•´ ì‹ ìš© ì¡°íšŒ ê¸°ë¡, ëŒ€í‘œì´ì‚¬ ì‹ ìš©ë„, ì†Œì†¡ ì •ë³´ ë“± 'ë¹„ì¬ë¬´ì  ëŒ€ì•ˆ ì •ë³´'ì˜ ê°€ì¤‘ì¹˜ ìƒí–¥ ì¡°ì •.",
    "5. [ì—…ì¢… ë³´ì •] ì—…ì¢…ë³„ë¡œ ì¬ë¬´ êµ¬ì¡°(ì˜ˆ: ë¶€ì±„ë¹„ìœ¨)ì˜ ì •ìƒ ë²”ìœ„ê°€ ë‹¤ë¥´ë¯€ë¡œ, ì£¼ìš” ì¬ë¬´ ë³€ìˆ˜ë¥¼ 'ì—…ì¢… í‰ê· ìœ¼ë¡œ ë‚˜ëˆˆ ìƒëŒ€ ì§€í‘œ'ë¡œ ë³€í™˜í•˜ì—¬ ëª¨ë¸ì— ì£¼ì… (Industry-Adjusted Ratios).",
    "6. [í‰ê°€ ì§€í‘œ] ë‹¨ìˆœ ì •í™•ë„(Accuracy)ëŠ” ë¬´ì˜ë¯¸í•¨. ë¶€ë„(Positive)ë¥¼ ë§ì¶”ëŠ” ê²ƒì´ í•µì‹¬ì´ë¯€ë¡œ 'Precision-Recall Curve'ì˜ AUC(PR-AUC)ë¥¼ ìµœìš°ì„ ìœ¼ë¡œ í•˜ë˜, ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¹„ìš©ì„ ê³ ë ¤í•œ 'F-beta Score' (Recallì— ê°€ì¤‘ì¹˜) í™œìš©.",
    "7. [í•´ì„ ê°€ëŠ¥ì„±] SHAP value ë“±ì„ í™œìš©í•˜ì—¬ ëª¨ë¸ì´ ì™œ í•´ë‹¹ ê¸°ì—…ì„ ê³ ìœ„í—˜ìœ¼ë¡œ íŒë‹¨í–ˆëŠ”ì§€ ì„¤ëª…í•  ìˆ˜ ìˆì–´ì•¼ í•¨ (ì—¬ì‹  ì‹¬ì‚¬ì—­ ì„¤ë“ ë° ê·œì œ ëŒ€ì‘ ëª©ì )."
]
for rec in recommendations:
    print(rec)
```

**ì¶œë ¥:**

```

================================================================================
ğŸ“Œ ë„ë©”ì¸ ê¸°ë°˜ ë¶€ë„ ì›ì¸ ë¶„ì„ - í•µì‹¬ ì¸ì‚¬ì´íŠ¸
================================================================================
â€¢ [ë¶€ë„ìœ¨] ì „ì²´ ë¶€ë„ìœ¨ 1.51%ì˜ ê·¹ë‹¨ì  ë¶ˆê· í˜• ë°ì´í„°ì„. ì´ëŠ” ì¼ë°˜ì ì¸ ì§€ë„í•™ìŠµ ëª¨ë¸ì´ ë‹¤ìˆ˜ í´ë˜ìŠ¤(ì •ìƒ)ì— í¸í–¥ë  ìœ„í—˜ì´ ë§¤ìš° í¼ì„ ì‹œì‚¬í•˜ë©°, ì •êµí•œ ìƒ˜í”Œë§ ê¸°ë²• ì—†ì´ëŠ” ë¶€ë„ íƒì§€ë ¥(Recall) í™•ë³´ê°€ ë¶ˆê°€ëŠ¥í•¨.
â€¢ [ìœ ë™ì„±] ìœ ë™ë¹„ìœ¨ 100% ë¯¸ë§Œ(ìœ ë™ë¶€ì±„ > ìœ ë™ìì‚°)ì¸ 'ì ì¬ì  ìœ ë™ì„± ìœ„ê¸°' ê¸°ì—…ì˜ ë¶€ë„ìœ¨ì€ 1.99%ë¡œ ì „ì²´ í‰ê·  ëŒ€ë¹„ ê¸‰ê²©íˆ ìƒìŠ¹í•¨. íŠ¹íˆ í˜„ê¸ˆì„± ìì‚°ì´ ë¶€ì¡±í•œ ê²½ìš°, í‘ì ë„ì‚°ì˜ ê°€ëŠ¥ì„±ë„ ë°°ì œí•  ìˆ˜ ì—†ëŠ” í•µì‹¬ ìœ„í—˜ ì‹ í˜¸ì„.
â€¢ [ìë³¸êµ¬ì¡°] ìë³¸ì ì‹(ë¶€ì±„ì´ê³„ > ìì‚°ì´ê³„ ë˜ëŠ” ìë³¸ê¸ˆ ì ì‹) ìƒíƒœì¸ ê¸°ì—…ì˜ ë¶€ë„ìœ¨ì€ 3.78%ì— ë‹¬í•¨. ì´ëŠ” ë‹¨ìˆœí•œ ìœ ë™ì„± ë¬¸ì œë¥¼ ë„˜ì–´ì„  êµ¬ì¡°ì  ë¶€ì‹¤ ìƒíƒœë¡œ, ì™¸ë¶€ ìê¸ˆ ìˆ˜í˜ˆ ì—†ì´ëŠ” ìƒì¡´ì´ ë¶ˆê°€ëŠ¥í•œ 'í•œê³„ ê¸°ì—…'ì˜ ì „í˜•ì ì¸ íŠ¹ì§•ì„.
â€¢ [ìˆ˜ìµì„±] ì´ìì‚°ìˆœì´ìµë¥ (ROA)ì´ ìŒìˆ˜(-)ì¸ ê¸°ì—…ì˜ ë¶€ë„ìœ¨ì€ 2.07%ì„. ìì‚°ì„ íš¨ìœ¨ì ìœ¼ë¡œ ìš´ìš©í•˜ì§€ ëª»í•´ ì†ì‹¤ì´ ëˆ„ì ë˜ê³  ìˆìœ¼ë©°, ì´ëŠ” ê³§ ì´ì ë¹„ìš©ì¡°ì°¨ ê°ë‹¹í•˜ì§€ ëª»í•˜ëŠ” 'ì´ìë³´ìƒë°°ìœ¨ 1 ë¯¸ë§Œ' ìƒíƒœì™€ ì—°ê²°ë  ê°€ëŠ¥ì„±ì´ ë†’ìŒ.
â€¢ [ì‹ ìš©ì´ë ¥] ê³¼ê±° ì—°ì²´ ì´ë ¥ì´ ìˆëŠ” ê¸°ì—…ì˜ ë¶€ë„ìœ¨ì€ 12.38%ë¡œ ì••ë„ì ìœ¼ë¡œ ë†’ìŒ. ì¬ë¬´ì œí‘œê°€ 'ê³¼ê±°ì˜ ì„±ì í‘œ'ë¼ë©´, ì—°ì²´ ì •ë³´ëŠ” 'í˜„ì¬ì˜ ìê¸ˆ ê²½ìƒ‰'ì„ ë³´ì—¬ì£¼ëŠ” ê°€ì¥ ê°•ë ¥í•œ ì„ í–‰ì§€í‘œì´ì ë¶€ë„ì˜ ì§ì ‘ì ì¸ íŠ¸ë¦¬ê±°(Trigger)ì„.
â€¢ [ì—…ì¢…íŠ¹ì„±] ê±´ì„¤ì—…, ì¡°ì„ ì—… ë“± ìˆ˜ì£¼ ì‚°ì—…ì´ë‚˜ ë„ì†Œë§¤ì—… ë“± ê²½ê¸° ë¯¼ê° ì—…ì¢…ì—ì„œ ë¶€ë„ìœ¨ ì°¨ì´ê°€ ëšœë ·í•  ê²ƒìœ¼ë¡œ ì˜ˆìƒë¨. ë‹¨ì¼ ëª¨ë¸ë³´ë‹¤ëŠ” ì—…ì¢… ê·¸ë£¹ë³„ íŒŒìƒ ë³€ìˆ˜ë‚˜ ë³„ë„ ì„ê³„ê°’ ì ìš©ì´ í•„ìš”í•¨.

================================================================================
ğŸ¯ ë¶€ë„ ì˜ˆì¸¡ ëª¨ë¸ ê°œë°œ ì‹œ ì¤‘ì  ì‚¬í•­
================================================================================
1. [ë¶ˆê· í˜• ëŒ€ì‘] ë‹¨ìˆœ SMOTE ì ìš©ì„ ë„˜ì–´, 'EasyEnsemble' ê°™ì€ ì•™ìƒë¸” ê¸°ë°˜ ìƒ˜í”Œë§ì´ë‚˜, ë¶€ë„ ê¸°ì—…ê³¼ ìœ ì‚¬í•œ íŠ¹ì„±ì„ ê°€ì§„ ì •ìƒ ê¸°ì—…(Hard Negative)ì„ ì§‘ì¤‘ í•™ìŠµì‹œí‚¤ëŠ” ì „ëµ í•„ìš”.
2. [ë³€ìˆ˜ ë³€í™˜] ìœ ë™ë¹„ìœ¨, ë¶€ì±„ë¹„ìœ¨ ë“± ì¬ë¬´ ë¹„ìœ¨ì€ ì´ìƒì¹˜(Outlier)ê°€ ë§ìœ¼ë¯€ë¡œ, ë‹¨ìˆœ ì‚¬ìš©ë³´ë‹¤ 'Log ë³€í™˜', 'Winsorization(ê·¹ë‹¨ê°’ ëŒ€ì²´)' ë˜ëŠ” 'êµ¬ê°„í™”(Binning)'ë¥¼ í†µí•´ ê°•ê±´ì„±(Robustness) í™•ë³´.
3. [íŠ¹ì„± ê³µí•™] ë„ë©”ì¸ ì§€ì‹ì„ í™œìš©í•œ íŒŒìƒ ë³€ìˆ˜ ìƒì„± í•„ìˆ˜ (ì˜ˆ: í˜„ê¸ˆíë¦„/ë¶€ì±„ë¹„ìœ¨, ìš´ì „ìë³¸ íšŒì „ìœ¨, ì´ìë³´ìƒë°°ìœ¨ ë“±). ë‹¨ìˆœ ì¬ë¬´ ìˆ˜ì¹˜ë³´ë‹¤ 'ë³€í™”ìœ¨(YoY, QoQ)' ë° 'ë™ì¢… ì—…ê³„ ëŒ€ë¹„ ìƒëŒ€ì  ìœ„ì¹˜(z-score)'ê°€ ë” ë†’ì€ ì˜ˆì¸¡ë ¥ì„ ê°€ì§ˆ ìˆ˜ ìˆìŒ.
4. [ë¹„ì¬ë¬´ ì •ë³´ í™œìš©] ì¬ë¬´ì œí‘œì˜ ì‹œì°¨(Lag) ë¬¸ì œë¥¼ ë³´ì™„í•˜ê¸° ìœ„í•´ ì‹ ìš© ì¡°íšŒ ê¸°ë¡, ëŒ€í‘œì´ì‚¬ ì‹ ìš©ë„, ì†Œì†¡ ì •ë³´ ë“± 'ë¹„ì¬ë¬´ì  ëŒ€ì•ˆ ì •ë³´'ì˜ ê°€ì¤‘ì¹˜ ìƒí–¥ ì¡°ì •.
5. [ì—…ì¢… ë³´ì •] ì—…ì¢…ë³„ë¡œ ì¬ë¬´ êµ¬ì¡°(ì˜ˆ: ë¶€ì±„ë¹„ìœ¨)ì˜ ì •ìƒ ë²”ìœ„ê°€ ë‹¤ë¥´ë¯€ë¡œ, ì£¼ìš” ì¬ë¬´ ë³€ìˆ˜ë¥¼ 'ì—…ì¢… í‰ê· ìœ¼ë¡œ ë‚˜ëˆˆ ìƒëŒ€ ì§€í‘œ'ë¡œ ë³€í™˜í•˜ì—¬ ëª¨ë¸ì— ì£¼ì… (Industry-Adjusted Ratios).
6. [í‰ê°€ ì§€í‘œ] ë‹¨ìˆœ ì •í™•ë„(Accuracy)ëŠ” ë¬´ì˜ë¯¸í•¨. ë¶€ë„(Positive)ë¥¼ ë§ì¶”ëŠ” ê²ƒì´ í•µì‹¬ì´ë¯€ë¡œ 'Precision-Recall Curve'ì˜ AUC(PR-AUC)ë¥¼ ìµœìš°ì„ ìœ¼ë¡œ í•˜ë˜, ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¹„ìš©ì„ ê³ ë ¤í•œ 'F-beta Score' (Recallì— ê°€ì¤‘ì¹˜) í™œìš©.
7. [í•´ì„ ê°€ëŠ¥ì„±] SHAP value ë“±ì„ í™œìš©í•˜ì—¬ ëª¨ë¸ì´ ì™œ í•´ë‹¹ ê¸°ì—…ì„ ê³ ìœ„í—˜ìœ¼ë¡œ íŒë‹¨í–ˆëŠ”ì§€ ì„¤ëª…í•  ìˆ˜ ìˆì–´ì•¼ í•¨ (ì—¬ì‹  ì‹¬ì‚¬ì—­ ì„¤ë“ ë° ê·œì œ ëŒ€ì‘ ëª©ì ).

```

--------------------------------------------------------------------------------

## [ë§ˆí¬ë‹¤ìš´ #20]

## 8. ë‹¤ìŒ ë‹¨ê³„

ì´ ë¶„ì„ì„ ë°”íƒ•ìœ¼ë¡œ ë‹¤ìŒ ë…¸íŠ¸ë¶ì—ì„œëŠ”:
1. **ê³ ê¸‰ ë„ë©”ì¸ íŠ¹ì„± ê³µí•™**: ë¶€ë„ ì˜ˆì¸¡ì— íŠ¹í™”ëœ ë³µí•© ì§€í‘œ ìƒì„±
2. **ìƒê´€ê´€ê³„ ì‹¬ì¸µ ë¶„ì„**: ë³€ìˆ˜ ê°„ ìƒí˜¸ì‘ìš© ë° ë¹„ì„ í˜• ê´€ê³„ í¬ì°©
3. **ë¶ˆê· í˜• ë¶„ë¥˜ ëª¨ë¸ë§**: SMOTE + Tomek Links ë° ì•™ìƒë¸” ê¸°ë²• ì ìš©
4. **ëª¨ë¸ í‰ê°€ ë° í•´ì„**: SHAP ë¶„ì„ ë° ë¹„ì¦ˆë‹ˆìŠ¤ ê°€ì¹˜ ìµœì í™”

--------------------------------------------------------------------------------



ì´ê³„: ë§ˆí¬ë‹¤ìš´ 20ê°œ, ì½”ë“œ 33ê°œ
