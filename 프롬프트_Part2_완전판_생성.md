# ğŸ“— Part 2: ë„ë©”ì¸ íŠ¹ì„± ê³µí•™ - ì™„ì „íŒ ë…¸íŠ¸ë¶ ìƒì„±

## ğŸ‘¨â€ğŸ’¼ ë‹¹ì‹ ì˜ ì—­í•  (Persona)

ë‹¹ì‹ ì€ **10ë…„ ê²½ë ¥ì˜ ê¸ˆìœµê¶Œ ë°ì´í„° ì‚¬ì´ì–¸í‹°ìŠ¤íŠ¸**ì…ë‹ˆë‹¤.

**ì „ë¬¸ ë¶„ì•¼:**
- ê¸°ì—… ì‹ ìš©í‰ê°€ ëª¨ë¸ë§ (7ë…„ ê²½ë ¥)
- ì¬ë¬´ì œí‘œ ì¡°ì‘ íƒì§€ (Beneish M-Score, Altman Z-Score ì „ë¬¸ê°€)
- í•œêµ­ ê¸ˆìœµê°ë…ì› ì™¸ë¶€ê°ì‚¬ ê¸°ì¤€ ì™„ë²½ ì´í•´
- ë¶ˆê· í˜• ë°ì´í„° ì²˜ë¦¬ ë° Feature Engineering ì „ë¬¸ê°€

**ë‹¹ì‹ ì´ ì•Œê³  ìˆëŠ” ê²ƒ:**
- Beneish M-Score 8ê°œ ë³€ìˆ˜ì˜ ì¬ë¬´ì  ì˜ë¯¸ì™€ ê³„ì‚° ê³µì‹
- í•œêµ­ ê¸°ì—…ì˜ ë¶€ë„ íŒ¨í„´ (ìœ ë™ì„± ìœ„ê¸° 70%, ì§€ê¸‰ë¶ˆëŠ¥ 20%, ì‹ ë¢°ìƒì‹¤ 10%)
- VIFì™€ ìƒê´€ê³„ìˆ˜ì˜ ì°¨ì´, ê·¸ë¦¬ê³  ë‹¤ì¤‘ê³µì„ ì„±ì´ ëª¨ë¸ì— ë¯¸ì¹˜ëŠ” ì˜í–¥
- Mann-Whitney U test, Cliff's Delta, Information Valueì˜ í•´ì„

---

## ğŸ¯ ì‘ì—… ëª©í‘œ

ê¸°ì¡´ ë…¸íŠ¸ë¶(`notebooks/ë°œí‘œ_Part2_ë„ë©”ì¸_íŠ¹ì„±_ê³µí•™_new.ipynb`)ì˜ **4ê°€ì§€ ì¹˜ëª…ì  ë¬¸ì œ**ë¥¼ í•´ê²°í•œ **ì™„ì „íŒ ë…¸íŠ¸ë¶**ì„ ìƒì„±í•˜ì„¸ìš”.

**ìµœì¢… ëª©í‘œ:**
- ëª¨ë“  ì…€ì´ ì—ëŸ¬ ì—†ì´ ì‹¤í–‰ë˜ëŠ” ë°œí‘œìš© ë…¸íŠ¸ë¶
- 40ê°œ ì´ìƒì˜ ë„ë©”ì¸ íŠ¹ì„± ìƒì„± ë° í†µê³„ì  ê²€ì¦ ì™„ë£Œ
- Beneish M-Score ì™„ì „ êµ¬í˜„
- VIF ê¸°ë°˜ ë‹¤ì¤‘ê³µì„ ì„± ë¶„ì„ í¬í•¨

---

## ğŸ“‚ ì…ë ¥ íŒŒì¼

| íŒŒì¼ | ê²½ë¡œ | ìš©ë„ |
|------|------|------|
| **ì›ë³¸ ë°ì´í„°** | `data/ê¸°ì—…ì‹ ìš©í‰ê°€ì •ë³´_210801.csv` | 50,105 ê¸°ì—…, 159 ë³€ìˆ˜ |
| **ì°¸ì¡° ë…¸íŠ¸ë¶** | `notebooks/02_ê³ ê¸‰_ë„ë©”ì¸_íŠ¹ì„±ê³µí•™.ipynb` | ì›ë³¸ Beneish M-Score êµ¬í˜„ ì°¸ì¡° |
| **í”„ë¡œì íŠ¸ ê°€ì´ë“œ** | `CLAUDE.md` | ì½”ë”© ê·œì¹™, ê²½ë¡œ ê·œì¹™ |

---

## ğŸš¨ í•´ê²°í•´ì•¼ í•  4ê°€ì§€ ë¬¸ì œ

### ë¬¸ì œ 1: ì¬ë¬´ì¡°ì‘ íƒì§€ íŠ¹ì„±ì´ "ê°„ë‹¨ ë²„ì „"

**í˜„ì¬ ìƒíƒœ:**
```python
# í˜„ì¬ êµ¬í˜„ (7ê°œ íŠ¹ì„±ë§Œ)
- ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨
- ë§¤ì¶œì±„ê¶Œ_ì´ìƒì§€í‘œ
- ì¬ê³ íšŒì „ìœ¨
- ì¬ê³ ë³´ìœ ì¼ìˆ˜
- ì¬ê³ _ì´ìƒì§€í‘œ
- ì´ë°œìƒì•¡
- ë°œìƒì•¡ë¹„ìœ¨
```

**ë¬¸ì œì :** Beneish M-Scoreì˜ í•µì‹¬ 8ê°œ ë³€ìˆ˜ ì¤‘ ì¼ë¶€ë§Œ êµ¬í˜„ë¨

**ìš”êµ¬ì‚¬í•­: ì™„ì „í•œ í•œêµ­í˜• M-Score êµ¬í˜„**

í•„ìˆ˜ í¬í•¨ íŠ¹ì„± (15ê°œ):
1. **DSRI** (Days Sales in Receivables Index): ë§¤ì¶œì±„ê¶Œ ì¦ê°€ìœ¨ ì§€ìˆ˜
2. **GMI** (Gross Margin Index): ë§¤ì¶œì´ì´ìµë¥  ê°ì†Œ ì§€ìˆ˜
3. **AQI** (Asset Quality Index): ìì‚° í’ˆì§ˆ ì•…í™” ì§€ìˆ˜
4. **SGI** (Sales Growth Index): ë§¤ì¶œ ê¸‰ì„±ì¥ ì§€ìˆ˜
5. **DEPI** (Depreciation Index): ê°ê°€ìƒê° ê°ì†Œ ì§€ìˆ˜
6. **SGAI** (Sales, General and Administrative expenses Index): íŒê´€ë¹„ ì¦ê°€ìœ¨
7. **LVGI** (Leverage Index): ë ˆë²„ë¦¬ì§€ ì¦ê°€ ì§€ìˆ˜
8. **TATA** (Total Accruals to Total Assets): ì´ ë°œìƒì•¡ ëŒ€ ìì‚° ë¹„ìœ¨
9. **M-Score ì¢…í•©**: ìœ„ 8ê°œ ë³€ìˆ˜ì˜ ê°€ì¤‘í•©
10. ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨, ì¬ê³ íšŒì „ìœ¨, ì¬ê³ ë³´ìœ ì¼ìˆ˜ ë“± ë³´ì¡° ì§€í‘œ

**ì°¸ê³  ìë£Œ:**
- `notebooks/02_ê³ ê¸‰_ë„ë©”ì¸_íŠ¹ì„±ê³µí•™.ipynb`ì˜ `create_beneish_mscore()` í•¨ìˆ˜ë¥¼ ì½ê³  ì°¸ì¡°
- Beneish M-Score ì›ë³¸ ë…¼ë¬¸ ê³µì‹ ì‚¬ìš©

**ì˜ˆì‹œ ì½”ë“œ:**
```python
def create_manipulation_features_complete(df):
    """ì¬ë¬´ì¡°ì‘ íƒì§€ íŠ¹ì„± - ì™„ì „íŒ (Beneish M-Score)"""

    features = pd.DataFrame(index=df.index)

    # 1. DSRI (Days Sales in Receivables Index)
    # ë§¤ì¶œì±„ê¶Œ/ë§¤ì¶œ ë¹„ìœ¨ì˜ ì „ë…„ ëŒ€ë¹„ ë³€í™”
    # ì£¼ì˜: ì‹œê³„ì—´ ë°ì´í„°ê°€ ì•„ë‹ˆë¯€ë¡œ ì—…ì¢… í‰ê·  ëŒ€ë¹„ ë¹„êµ
    if 'ë§¤ì¶œì±„ê¶Œ' in df.columns and 'ë§¤ì¶œì•¡' in df.columns:
        receivables_ratio = df['ë§¤ì¶œì±„ê¶Œ'] / (df['ë§¤ì¶œì•¡'] + 1)
        industry_median = receivables_ratio.median()
        features['DSRI'] = receivables_ratio / (industry_median + 0.01)

    # 2. GMI (Gross Margin Index)
    # ë§¤ì¶œì´ì´ìµë¥  = (ë§¤ì¶œì•¡ - ë§¤ì¶œì›ê°€) / ë§¤ì¶œì•¡
    if 'ë§¤ì¶œì•¡' in df.columns and 'ë§¤ì¶œì›ê°€' in df.columns:
        gross_margin = (df['ë§¤ì¶œì•¡'] - df['ë§¤ì¶œì›ê°€']) / (df['ë§¤ì¶œì•¡'] + 1)
        features['ë§¤ì¶œì´ì´ìµë¥ '] = gross_margin
        # GMI > 1 ì´ë©´ ì´ìµë¥  ê°ì†Œ (ì¡°ì‘ ì˜ì‹¬)
        industry_median_gm = gross_margin.median()
        features['GMI'] = (industry_median_gm + 0.01) / (gross_margin + 0.01)

    # 3. AQI (Asset Quality Index)
    # (ë¹„ìœ ë™ìì‚° - (ìœ í˜•ìì‚° + íˆ¬ììì‚°)) / ì´ìì‚°
    # ë¬´í˜•ìì‚°, ì´ì—°ìì‚° ë¹„ì¤‘ì´ ë†’ìœ¼ë©´ ì˜ì‹¬
    if 'ìì‚°ì´ê³„' in df.columns:
        tangible_assets = df.get('ìœ í˜•ìì‚°', 0) + df.get('íˆ¬ììì‚°', 0)
        non_current = df.get('ë¹„ìœ ë™ìì‚°', df['ìì‚°ì´ê³„'] - df.get('ìœ ë™ìì‚°', 0))
        soft_assets = non_current - tangible_assets
        features['AQI'] = soft_assets / (df['ìì‚°ì´ê³„'] + 1)

    # ... ë‚˜ë¨¸ì§€ ì§€í‘œë„ ìœ ì‚¬í•˜ê²Œ êµ¬í˜„

    # M-Score ê³„ì‚° (ê°€ì¤‘í•©)
    features['M_Score'] = (
        -4.84 +
        0.920 * features.get('DSRI', 0) +
        0.528 * features.get('GMI', 0) +
        0.404 * features.get('AQI', 0) +
        # ... ë‚˜ë¨¸ì§€ ê³„ìˆ˜
    )

    return features
```

---

### ë¬¸ì œ 2: Feature Validation Matrix ê²€ì¦ ì‹¤íŒ¨

**ì—ëŸ¬ ë©”ì‹œì§€:**
```
âš ï¸ ì¦‰ê°ì§€ê¸‰ëŠ¥ë ¥: columns overlap but no suffix specified: Index(['ì´...
âš ï¸ í˜„ê¸ˆì†Œì§„ì¼ìˆ˜: columns overlap but no suffix specified: Index(['ì´...
(40ê°œ íŠ¹ì„± ëª¨ë‘ ê²€ì¦ ì‹¤íŒ¨)
ê²€ì¦ ì™„ë£Œ: 0ê°œ íŠ¹ì„±
âš ï¸ ê²€ì¦ëœ íŠ¹ì„±ì´ ì—†ìŠµë‹ˆë‹¤.
```

**ì›ì¸:**
```python
# ì˜ëª»ëœ ì½”ë“œ
normal = df[df[target_col] == 0].join(all_features)[feature].dropna()
# dfì™€ all_featuresì— ë™ì¼í•œ ì»¬ëŸ¼ëª…ì´ ìˆì–´ì„œ ì—ëŸ¬ ë°œìƒ
```

**í•´ê²° ë°©ë²•:**
```python
# ì˜¬ë°”ë¥¸ ì½”ë“œ (ë°©ë²• 1: ì§ì ‘ ì¸ë±ì‹±)
normal = all_features.loc[df[target_col] == 0, feature].dropna()
bankrupt = all_features.loc[df[target_col] == 1, feature].dropna()

# ë˜ëŠ” (ë°©ë²• 2: íƒ€ê²Ÿë§Œ í¬í•¨í•œ ì¡°ì¸)
validation_data = pd.concat([df[[target_col]], all_features], axis=1)
normal = validation_data[validation_data[target_col] == 0][feature].dropna()
bankrupt = validation_data[validation_data[target_col] == 1][feature].dropna()
```

**ìš”êµ¬ì‚¬í•­:**
- ëª¨ë“  40ê°œ ì´ìƒ íŠ¹ì„±ì— ëŒ€í•´ ê²€ì¦ ì„±ê³µ
- `validation_df` DataFrameì— ìµœì†Œ 40ê°œ í–‰ í¬í•¨
- ê° íŠ¹ì„±ë§ˆë‹¤ p-value, Cliff's Delta, AUC ê³„ì‚° ì™„ë£Œ

---

### ë¬¸ì œ 3: AUC ì‹œê°í™” ì‹¤íŒ¨

**í˜„ì¬ ìƒíƒœ:**
```
âš ï¸ ê²€ì¦ ê²°ê³¼ê°€ ì—†ê±°ë‚˜ AUC ê³„ì‚°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.
```

**ìš”êµ¬ì‚¬í•­:**
1. ëª¨ë“  íŠ¹ì„±ì˜ AUC ê³„ì‚° ì„±ê³µ
2. Plotly ë°” ì°¨íŠ¸ë¡œ ìƒìœ„ 15ê°œ íŠ¹ì„± ì‹œê°í™”
3. ìƒ‰ìƒìœ¼ë¡œ í†µê³¼(âœ…)/ê²½ê³ (âš ï¸) êµ¬ë¶„

**ì˜ˆì‹œ ì½”ë“œ:**
```python
# AUC ì‹œê°í™”
if len(validation_df) > 0 and 'AUC' in validation_df.columns:
    top_features = validation_df.nlargest(15, 'AUC')

    colors = ['#2ecc71' if x == 'âœ…' else '#e74c3c' for x in top_features['Keep']]

    fig = go.Figure()
    fig.add_trace(go.Bar(
        y=top_features['Feature'].values[::-1],
        x=top_features['AUC'].values[::-1],
        orientation='h',
        marker_color=colors[::-1],
        text=top_features['AUC'].values[::-1].round(3),
        textposition='outside'
    ))

    fig.update_layout(
        title='<b>íŠ¹ì„±ë³„ ë‹¨ë³€ëŸ‰ AUC</b> (ìƒìœ„ 15ê°œ)',
        xaxis_title='AUC',
        yaxis_title='íŠ¹ì„±ëª…',
        height=600,
        showlegend=False
    )

    # AUC ê¸°ì¤€ì„  í‘œì‹œ
    fig.add_vline(x=0.6, line_dash="dash", line_color="gray",
                  annotation_text="ìµœì†Œ ê¸°ì¤€ (0.6)")

    fig.show()
```

---

### ë¬¸ì œ 4: VIF ë‹¤ì¤‘ê³µì„ ì„± ë¶„ì„ ëˆ„ë½

**í˜„ì¬ ìƒíƒœ:**
- IV (Information Value)ì™€ ìƒê´€ê³„ìˆ˜ë§Œ í™•ì¸
- VIF ê³„ì‚° ë° ì œê±° ë¡œì§ ì „í˜€ ì—†ìŒ

**VIFê°€ í•„ìš”í•œ ì´ìœ :**
- ìƒê´€ê³„ìˆ˜ëŠ” **2ê°œ ë³€ìˆ˜ ê°„** ê´€ê³„ë§Œ ì¸¡ì •
- VIFëŠ” **í•œ ë³€ìˆ˜ì™€ ë‚˜ë¨¸ì§€ ëª¨ë“  ë³€ìˆ˜**ì˜ ê´€ê³„ ì¸¡ì •
- ì˜ˆ: Aì™€ Bì˜ ìƒê´€ê³„ìˆ˜ 0.7, Aì™€ Cì˜ ìƒê´€ê³„ìˆ˜ 0.7 â†’ Aì˜ VIFëŠ” 20 ì´ìƒ ê°€ëŠ¥

**ìš”êµ¬ì‚¬í•­:**

1. **VIF ê³„ì‚°**
```python
from statsmodels.stats.outliers_influence import variance_inflation_factor

def calculate_vif(df):
    """VIF ê³„ì‚°"""
    vif_data = pd.DataFrame()
    vif_data["Feature"] = df.columns
    vif_data["VIF"] = [variance_inflation_factor(df.values, i)
                       for i in range(len(df.columns))]
    return vif_data.sort_values('VIF', ascending=False)
```

2. **ìŠ¤ë§ˆíŠ¸í•œ íŠ¹ì„± ì œê±° ë¡œì§** (ë¬´ì¡°ê±´ ì œê±°í•˜ì§€ ì•ŠìŒ)

**ì œê±° ìš°ì„ ìˆœìœ„:**
```python
# ìš°ì„ ìˆœìœ„ 1: VIF é«˜ + ì˜ˆì¸¡ë ¥ ä½ â†’ ì œê±°
if vif > 10 and iv < 0.1 and auc < 0.6:
    remove_features.add(feature)
    print(f"âŒ ì œê±°: {feature}")
    print(f"   ì‚¬ìœ : VIF={vif:.1f} (ë‹¤ì¤‘ê³µì„ ì„± ë†’ìŒ), IV={iv:.3f} (ì˜ˆì¸¡ë ¥ ë‚®ìŒ)")

# ìš°ì„ ìˆœìœ„ 2: ê³ ìƒê´€ ìŒ ì¤‘ ì˜ˆì¸¡ë ¥ ë‚®ì€ ê²ƒ ì œê±°
elif vif > 10 and has_high_correlation:
    # ìƒê´€ê³„ìˆ˜ > 0.9ì¸ ìŒ ì°¾ê¸°
    # ë‘ ë³€ìˆ˜ ì¤‘ IVê°€ ë‚®ì€ ê²ƒ ì œê±°

# ìš°ì„ ìˆœìœ„ 3: VIF é«˜ but ì˜ˆì¸¡ë ¥ å¼º â†’ ìœ ì§€ (ê²½ê³ ë§Œ)
elif vif > 10 and (iv >= 0.1 or auc >= 0.6):
    keep_features.add(feature)
    print(f"âœ… ìœ ì§€: {feature}")
    print(f"   ì‚¬ìœ : VIF={vif:.1f} (ë†’ìŒ) but IV={iv:.3f}, AUC={auc:.2f} (ì˜ˆì¸¡ë ¥ ê°•í•¨)")
    print(f"   âš ï¸ ì£¼ì˜: ë‹¤ì¤‘ê³µì„ ì„± ì¡´ì¬, ëª¨ë¸ í•´ì„ ì‹œ ì£¼ì˜ í•„ìš”")
```

**ì¶œë ¥ ì˜ˆì‹œ:**
```
ğŸ” VIF ê¸°ë°˜ ë‹¤ì¤‘ê³µì„ ì„± ë¶„ì„
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š VIF > 10ì¸ íŠ¹ì„± (7ê°œ ë°œê²¬)

1. ì´ìë³´ìƒë°°ìœ¨
   - VIF: 15.3
   - IV: 0.25 (ê°•í•¨)
   - AUC: 0.72
   - íŒì •: âœ… ìœ ì§€ (ì˜ˆì¸¡ë ¥ ë§¤ìš° ê°•í•¨)
   - ì‚¬ìœ : ë¶€ë„ ì˜ˆì¸¡ì— í•µì‹¬ ì§€í‘œì´ë¯€ë¡œ ìœ ì§€

2. ë¶€ì±„ë¹„ìœ¨
   - VIF: 12.1
   - IV: 0.08 (ì•½í•¨)
   - AUC: 0.58
   - íŒì •: âŒ ì œê±° (VIF é«˜ + ì˜ˆì¸¡ë ¥ ä½)

3. ì¬ë¬´ë ˆë²„ë¦¬ì§€
   - VIF: 18.7
   - IV: 0.05 (ë§¤ìš° ì•½í•¨)
   - AUC: 0.54
   - íŒì •: âŒ ì œê±° (VIF ê·¹íˆ ë†’ìŒ + ì˜ˆì¸¡ë ¥ ê±°ì˜ ì—†ìŒ)
   - ìƒê´€: ë¶€ì±„ë ˆë²„ë¦¬ì§€ì™€ r=0.95 (ì¤‘ë³µ)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ìµœì¢… ê²°ê³¼:
  - VIF > 10 íŠ¹ì„±: 7ê°œ
  - ìœ ì§€: 3ê°œ (ì˜ˆì¸¡ë ¥ ê°•í•¨)
  - ì œê±°: 4ê°œ (VIF é«˜ + ì˜ˆì¸¡ë ¥ ä½)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

---

## ğŸ“‹ ì‘ì—… ìˆœì„œ (Chain of Thought)

**ë‹¨ê³„ë³„ë¡œ ì•„ë˜ ìˆœì„œë¥¼ ë”°ë¼ ì§„í–‰í•˜ì„¸ìš”. ê° ë‹¨ê³„ë§ˆë‹¤ TodoWrite ë„êµ¬ë¥¼ ì‚¬ìš©í•´ ì§„í–‰ìƒí™©ì„ ì¶”ì í•˜ì„¸ìš”.**

### Phase 1: ì‚¬ì „ ì¤€ë¹„ (10ë¶„)

1. **ê¸°ì¡´ íŒŒì¼ ì½ê¸°**
   - `CLAUDE.md` ì½ê¸° (í”„ë¡œì íŠ¸ êµ¬ì¡°, ì½”ë”© ê·œì¹™ í™•ì¸)
   - `notebooks/02_ê³ ê¸‰_ë„ë©”ì¸_íŠ¹ì„±ê³µí•™.ipynb` ì½ê¸° (Beneish M-Score êµ¬í˜„ í™•ì¸)
   - `data/ê¸°ì—…ì‹ ìš©í‰ê°€ì •ë³´_210801.csv` ì»¬ëŸ¼ í™•ì¸ (head 10ì¤„)

2. **ë¬¸ì œì  ì¬í™•ì¸**
   - í˜„ì¬ ë…¸íŠ¸ë¶(`notebooks/ë°œí‘œ_Part2_ë„ë©”ì¸_íŠ¹ì„±_ê³µí•™_new.ipynb`) ì½ê¸°
   - 4ê°€ì§€ ë¬¸ì œê°€ ì‹¤ì œë¡œ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸

### Phase 2: ë…¸íŠ¸ë¶ ê¸°ë³¸ êµ¬ì¡° ìƒì„± (15ë¶„)

3. **ìƒˆ ë…¸íŠ¸ë¶ ìƒì„±**: `notebooks/ë°œí‘œ_Part2_ë„ë©”ì¸_íŠ¹ì„±_ê³µí•™_ì™„ì „íŒ.ipynb`
   - ë§ˆí¬ë‹¤ìš´ ì…€: ì œëª©, Part 1 ìš”ì•½, Why ì„¹ì…˜
   - ì½”ë“œ ì…€: í™˜ê²½ ì„¤ì •, ë°ì´í„° ë¡œë”©
   - í•œê¸€ í°íŠ¸ ì„¤ì • í¬í•¨

4. **ê¸°ë³¸ íŠ¹ì„± ìƒì„± í•¨ìˆ˜ ì‘ì„±** (ê¸°ì¡´ ê²ƒ ë³µì‚¬)
   - `create_liquidity_crisis_features()` (ìœ ë™ì„± ìœ„ê¸°)
   - `create_insolvency_features()` (ì§€ê¸‰ë¶ˆëŠ¥)
   - `create_stakeholder_features()` (ì´í•´ê´€ê³„ì)
   - `create_korean_market_features()` (í•œêµ­ ì‹œì¥ íŠ¹í™”)

### Phase 3: ë¬¸ì œ 1 í•´ê²° - Beneish M-Score ì™„ì „ êµ¬í˜„ (30ë¶„)

5. **ì¬ë¬´ì¡°ì‘ íƒì§€ íŠ¹ì„± ì™„ì „íŒ ì‘ì„±**
   - `notebooks/02_ê³ ê¸‰_ë„ë©”ì¸_íŠ¹ì„±ê³µí•™.ipynb`ì˜ `create_beneish_mscore()` ì°¸ì¡°
   - 8ê°œ í•µì‹¬ ì§€í‘œ ëª¨ë‘ êµ¬í˜„ (DSRI, GMI, AQI, SGI, DEPI, SGAI, LVGI, TATA)
   - M-Score ì¢…í•© ì ìˆ˜ ê³„ì‚°
   - ì£¼ì„ìœ¼ë¡œ ê° ì§€í‘œì˜ ì¬ë¬´ì  ì˜ë¯¸ ì„¤ëª…

6. **íŠ¹ì„± ìƒì„± ì‹¤í–‰ ë° ê²€ì¦**
   - ëª¨ë“  íŠ¹ì„± ìƒì„± í•¨ìˆ˜ ì‹¤í–‰
   - `all_features` DataFrameì— concat
   - ìƒì„±ëœ íŠ¹ì„± ìˆ˜ í™•ì¸ (40ê°œ ì´ìƒ)

### Phase 4: ë¬¸ì œ 2 & 3 í•´ê²° - ê²€ì¦ ë¡œì§ ìˆ˜ì • (20ë¶„)

7. **Feature Validation Matrix ìˆ˜ì •**
   - join ì—ëŸ¬ ìˆ˜ì • (ë°©ë²• 1 ë˜ëŠ” ë°©ë²• 2 ì‚¬ìš©)
   - ëª¨ë“  íŠ¹ì„±ì— ëŒ€í•´ Mann-Whitney U test ìˆ˜í–‰
   - Cliff's Delta, AUC ê³„ì‚°
   - `validation_df` ìƒì„± ë° ì¶œë ¥

8. **ì‹œê°í™” ìƒì„±**
   - AUC ìƒìœ„ 15ê°œ íŠ¹ì„± Plotly ë°” ì°¨íŠ¸
   - ìƒ‰ìƒìœ¼ë¡œ í†µê³¼/ê²½ê³  êµ¬ë¶„
   - AUC ê¸°ì¤€ì„  (0.6) í‘œì‹œ

### Phase 5: ë¬¸ì œ 4 í•´ê²° - VIF ë¶„ì„ ì¶”ê°€ (25ë¶„)

9. **VIF ê³„ì‚° í•¨ìˆ˜ ì‘ì„±**
   - `statsmodels` import
   - ëª¨ë“  íŠ¹ì„±ì— ëŒ€í•´ VIF ê³„ì‚°
   - VIF > 10 íŠ¹ì„± ì‹ë³„

10. **ìŠ¤ë§ˆíŠ¸ íŠ¹ì„± ì œê±° ë¡œì§ êµ¬í˜„**
    - VIF + IV + AUC ì¢…í•© ê³ ë ¤
    - ì œê±° ìš°ì„ ìˆœìœ„ì— ë”°ë¼ íŒì •
    - ê²°ê³¼ë¥¼ í…Œì´ë¸”ë¡œ ì¶œë ¥ (Feature, VIF, IV, AUC, íŒì •, ì‚¬ìœ )

11. **ìµœì¢… íŠ¹ì„± ì„ íƒ**
    - IV > 0.02 AND (VIF < 10 OR ì˜ˆì¸¡ë ¥ ê°•í•¨) íŠ¹ì„±ë§Œ ì„ íƒ
    - ìƒê´€ê´€ê³„ > 0.9 ìŒ ì¤‘ í•˜ë‚˜ ì œê±°
    - ì„ íƒëœ íŠ¹ì„± ëª©ë¡ ì¶œë ¥

### Phase 6: ìµœì¢… ê²€ì¦ ë° ì €ì¥ (15ë¶„)

12. **ìµœì¢… ë°ì´í„°ì…‹ ìƒì„±**
    - ì„ íƒëœ íŠ¹ì„±ë§Œ í¬í•¨í•œ DataFrame ìƒì„±
    - íƒ€ê²Ÿ ë³€ìˆ˜ í¬í•¨
    - `data/features/domain_based_features_ì™„ì „íŒ.csv` ì €ì¥

13. **ì „ì²´ ë…¸íŠ¸ë¶ ì‹¤í–‰**
    ```bash
    papermill notebooks/ë°œí‘œ_Part2_ë„ë©”ì¸_íŠ¹ì„±_ê³µí•™_ì™„ì „íŒ.ipynb \
              notebooks/ë°œí‘œ_Part2_ë„ë©”ì¸_íŠ¹ì„±_ê³µí•™_ì™„ì „íŒ_executed.ipynb
    ```
    - ëª¨ë“  ì…€ 100% ì„±ê³µ í™•ì¸
    - ì—ëŸ¬ ë°œìƒ ì‹œ ì¦‰ì‹œ ìˆ˜ì •

14. **Key Takeaways ì‘ì„±**
    - ë§ˆí¬ë‹¤ìš´ ì…€ë¡œ ì£¼ìš” ë°œê²¬ ì •ë¦¬
    - ìƒì„±ëœ íŠ¹ì„± ìš”ì•½ í…Œì´ë¸”
    - ë‹¤ìŒ ë‹¨ê³„ (Part 3) ì•ˆë‚´

---

## âœ… í•„ìˆ˜ ê²€ì¦ ê¸°ì¤€

ë…¸íŠ¸ë¶ ì‘ì„± í›„ **ë°˜ë“œì‹œ ë‹¤ìŒì„ í™•ì¸**í•˜ì„¸ìš”:

### 1. ì‹¤í–‰ ì„±ê³µë¥ 
```bash
cd /home/user/aaa
papermill notebooks/ë°œí‘œ_Part2_ë„ë©”ì¸_íŠ¹ì„±_ê³µí•™_ì™„ì „íŒ.ipynb \
          notebooks/ë°œí‘œ_Part2_ë„ë©”ì¸_íŠ¹ì„±_ê³µí•™_ì™„ì „íŒ_executed.ipynb
```
- âœ… **100% ì„±ê³µ** (ëª¨ë“  ì…€ ì—ëŸ¬ ì—†ì´ ì‹¤í–‰)
- âŒ 1ê°œ ì…€ì´ë¼ë„ ì‹¤íŒ¨í•˜ë©´ ì¬ì‘ì—…

### 2. íŠ¹ì„± ê°œìˆ˜
- ìƒì„±ëœ íŠ¹ì„±: **40ê°œ ì´ìƒ**
- ê²€ì¦ í†µê³¼ íŠ¹ì„±: `validation_df`ì— **40ê°œ ì´ìƒ** í–‰
- ìµœì¢… ì„ íƒ íŠ¹ì„±: **25~35ê°œ** (IV, VIF, ìƒê´€ê´€ê³„ í•„í„°ë§ í›„)

### 3. í†µê³„ì  ìœ ì˜ì„±
- ëª¨ë“  ìµœì¢… ì„ íƒ íŠ¹ì„±ì˜ **p-value < 0.05**
- ìµœì†Œ 20ê°œ ì´ìƒ íŠ¹ì„±ì˜ **AUC > 0.6**
- ìµœì†Œ 15ê°œ ì´ìƒ íŠ¹ì„±ì˜ **IV > 0.1**

### 4. ì‹œê°í™” ìƒì„±
- âœ… Feature Validation AUC ë°” ì°¨íŠ¸ (Plotly)
- âœ… VIF ë¶„ì„ ê²°ê³¼ í…Œì´ë¸”
- âœ… ìƒê´€ê´€ê³„ íˆíŠ¸ë§µ (ì„ íƒëœ íŠ¹ì„±ë§Œ, ì„ íƒì‚¬í•­)

### 5. íŒŒì¼ ì €ì¥
- âœ… `notebooks/ë°œí‘œ_Part2_ë„ë©”ì¸_íŠ¹ì„±_ê³µí•™_ì™„ì „íŒ.ipynb`
- âœ… `notebooks/ë°œí‘œ_Part2_ë„ë©”ì¸_íŠ¹ì„±_ê³µí•™_ì™„ì „íŒ_executed.ipynb`
- âœ… `data/features/domain_based_features_ì™„ì „íŒ.csv`
  - shape: `(50105, 26~36)` (íƒ€ê²Ÿ 1ê°œ + íŠ¹ì„± 25~35ê°œ)
  - ì¸ì½”ë”©: `utf-8-sig`
  - ìš©ëŸ‰: 15~20MB

---

## ğŸ”§ í•„ìˆ˜ ì½”ë”© ê·œì¹™ (CLAUDE.md ì¤€ìˆ˜)

### 1. í•œê¸€ í°íŠ¸ ì„¤ì •
```python
import platform
if platform.system() == 'Darwin':
    plt.rc('font', family='AppleGothic')
elif platform.system() == 'Windows':
    plt.rc('font', family='Malgun Gothic')
else:
    plt.rc('font', family='NanumGothic')
plt.rc('axes', unicode_minus=False)
```

### 2. ë°ì´í„° ì²˜ë¦¬
```python
# ê²°ì¸¡ì¹˜ ì²˜ë¦¬
X_filled = X.fillna(X.median())

# ë¬´í•œëŒ€ ì²˜ë¦¬
X_filled = X_filled.replace([np.inf, -np.inf], 0)

# ë²”ì£¼í˜• ë³€ìˆ˜ ì²˜ë¦¬ (ìˆ˜ì¹˜ ë³€í™˜ í›„ ê³„ì‚°)
if 'ìœ„í—˜ê²½ë³´ë“±ê¸‰' in X.columns:
    X['ìœ„í—˜ê²½ë³´ë“±ê¸‰'] = X['ìœ„í—˜ê²½ë³´ë“±ê¸‰'].cat.codes
```

### 3. íŒŒì¼ ê²½ë¡œ
```python
# ë°ì´í„° ë¡œë”© (ë…¸íŠ¸ë¶ì€ notebooks/ í´ë”ì— ìˆìŒ)
df = pd.read_csv('../data/ê¸°ì—…ì‹ ìš©í‰ê°€ì •ë³´_210801.csv', encoding='utf-8')

# íŠ¹ì„± ì €ì¥
df.to_csv('../data/features/domain_based_features_ì™„ì „íŒ.csv',
          encoding='utf-8-sig', index=False)
```

### 4. ì¬ë¬´ ë¹„ìœ¨ ê³„ì‚°
```python
# í•­ìƒ ë¶„ëª¨ì— +1 ë˜ëŠ” +0.1 ì¶”ê°€ (division by zero ë°©ì§€)
features['ìœ ë™ë¹„ìœ¨'] = df['ìœ ë™ìì‚°'] / (df['ìœ ë™ë¶€ì±„'] + 1)
features['ì´ìë³´ìƒë°°ìœ¨'] = df['ì˜ì—…ì´ìµ'] / (df['ê¸ˆìœµë¹„ìš©'] + 1)
```

### 5. Train/Test Split (í–¥í›„ ì‚¬ìš©)
```python
# í´ë˜ìŠ¤ ë¶ˆê· í˜• ë°ì´í„°ì´ë¯€ë¡œ stratify í•„ìˆ˜
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42, stratify=y
)
```

---

## ğŸ“Š ë…¸íŠ¸ë¶ êµ¬ì¡° (í…œí”Œë¦¿)

```markdown
# ğŸ“— Part 2: ë„ë©”ì¸ íŠ¹ì„± ê³µí•™ - ì™„ì „íŒ

## ì‹œë‹ˆì–´ ë°ì´í„° ì‚¬ì´ì–¸í‹°ìŠ¤íŠ¸ì˜ ì¬ë¬´ ë„ë©”ì¸ ì§€ì‹ ê¸°ë°˜ Feature Engineering

---

## ğŸ“Œ Part 1 ìš”ì•½
[ê¸°ì¡´ ë‚´ìš© ìœ ì§€]

---

## ğŸ¯ Why: ì™œ ë„ë©”ì¸ íŠ¹ì„±ì´ í•„ìš”í•œê°€?
[ê¸°ì¡´ ë‚´ìš© ìœ ì§€]

---

## ğŸ”§ íŠ¹ì„± ìƒì„±

### ì¹´í…Œê³ ë¦¬ 1: ìœ ë™ì„± ìœ„ê¸° íŠ¹ì„± (10ê°œ)
[ê¸°ì¡´ í•¨ìˆ˜ ì‚¬ìš©]

### ì¹´í…Œê³ ë¦¬ 2: ì§€ê¸‰ë¶ˆëŠ¥ íŒ¨í„´ íŠ¹ì„± (8ê°œ)
[ê¸°ì¡´ í•¨ìˆ˜ ì‚¬ìš©]

### ì¹´í…Œê³ ë¦¬ 3: ì¬ë¬´ì¡°ì‘ íƒì§€ íŠ¹ì„± - ì™„ì „íŒ (15ê°œ) â­ ì‹ ê·œ
**ğŸ’¡ Beneish M-Score ì™„ì „ êµ¬í˜„**

[ìƒˆë¡œìš´ í•¨ìˆ˜ ì‘ì„±]

### ì¹´í…Œê³ ë¦¬ 4: ì´í•´ê´€ê³„ì í–‰ë™ íŠ¹ì„± (10ê°œ)
[ê¸°ì¡´ í•¨ìˆ˜ ì‚¬ìš©]

### ì¹´í…Œê³ ë¦¬ 5: í•œêµ­ ì‹œì¥ íŠ¹í™” íŠ¹ì„± (6ê°œ)
[ê¸°ì¡´ í•¨ìˆ˜ ì‚¬ìš©]

---

## ğŸ“Š Feature Validation Matrix â­ ìˆ˜ì •

**ìƒì„±í•œ ëª¨ë“  íŠ¹ì„±ì— ëŒ€í•´ í†µê³„ì  ê²€ì¦ ìˆ˜í–‰**

[join ì—ëŸ¬ ìˆ˜ì •ëœ ì½”ë“œ ì‚¬ìš©]

---

## ğŸ¯ Feature Selection: ë‹¤ì¤‘ê³µì„ ì„± ì œê±° ë° ìµœì í™”

### 6.1 Information Value (IV) ë¶„ì„
[ê¸°ì¡´ ì½”ë“œ ì‚¬ìš©]

### 6.2 ìƒê´€ê´€ê³„ ë¶„ì„
[ê¸°ì¡´ ì½”ë“œ ì‚¬ìš©]

### 6.3 VIF ë‹¤ì¤‘ê³µì„ ì„± ë¶„ì„ â­ ì‹ ê·œ
[ìƒˆë¡œìš´ ì½”ë“œ ì‘ì„±]

### 6.4 ìµœì¢… íŠ¹ì„± ì„ íƒ
**IV + VIF + ì˜ˆì¸¡ë ¥ ì¢…í•© ê³ ë ¤**

[ìŠ¤ë§ˆíŠ¸ ì œê±° ë¡œì§ êµ¬í˜„]

---

## ğŸ’¾ ìµœì¢… ë°ì´í„°ì…‹ ì €ì¥

---

## âœ… Key Takeaways

### ìƒì„±ëœ íŠ¹ì„± ìš”ì•½

| ì¹´í…Œê³ ë¦¬ | ìƒì„± | ê²€ì¦ í†µê³¼ | ìµœì¢… ì„ íƒ |
|----------|------|-----------|-----------|
| ìœ ë™ì„± ìœ„ê¸° | 10 | 9 | 7 |
| ì§€ê¸‰ë¶ˆëŠ¥ íŒ¨í„´ | 8 | 8 | 6 |
| ì¬ë¬´ì¡°ì‘ íƒì§€ | 15 | 12 | 8 |
| ì´í•´ê´€ê³„ì í–‰ë™ | 10 | 10 | 7 |
| í•œêµ­ ì‹œì¥ íŠ¹í™” | 6 | 6 | 4 |
| **í•©ê³„** | **49** | **45** | **32** |

### í•µì‹¬ ë°œê²¬
[ì£¼ìš” ë°œê²¬ ì •ë¦¬]

---

## â¡ï¸ ë‹¤ìŒ ë‹¨ê³„: Part 3 ëª¨ë¸ë§
[ì•ˆë‚´ ë‚´ìš©]
```

---

## ğŸ’¬ ì‘ì—… ì§„í–‰ ë°©ì‹

### TodoWrite ë„êµ¬ í™œìš©
ê° Phase ì‹œì‘ ì „ì— TODO ë¦¬ìŠ¤íŠ¸ ì‘ì„±:

```python
# ì˜ˆì‹œ
TodoWrite({
    "todos": [
        {"content": "ê¸°ì¡´ íŒŒì¼ ì½ê¸° (CLAUDE.md, ì°¸ì¡° ë…¸íŠ¸ë¶)", "status": "pending", "activeForm": "Reading existing files"},
        {"content": "ë…¸íŠ¸ë¶ ê¸°ë³¸ êµ¬ì¡° ìƒì„±", "status": "pending", "activeForm": "Creating notebook structure"},
        {"content": "Beneish M-Score ì™„ì „ êµ¬í˜„", "status": "pending", "activeForm": "Implementing Beneish M-Score"},
        {"content": "Feature Validation ìˆ˜ì •", "status": "pending", "activeForm": "Fixing validation logic"},
        {"content": "VIF ë¶„ì„ ì¶”ê°€", "status": "pending", "activeForm": "Adding VIF analysis"},
        {"content": "ì „ì²´ ì‹¤í–‰ ë° ê²€ì¦", "status": "pending", "activeForm": "Validating notebook"}
    ]
})
```

### ì§„í–‰ ì¤‘ ì£¼ì˜ì‚¬í•­
1. **í•œ ë²ˆì— ì „ì²´ë¥¼ ë§Œë“¤ì§€ ë§ˆì„¸ìš”**
   - Phaseë³„ë¡œ ë‚˜ëˆ ì„œ ì‘ì—…
   - ê° Phase ì™„ë£Œ í›„ ì¤‘ê°„ ê²€ì¦

2. **ì—ëŸ¬ ë°œìƒ ì‹œ ì¦‰ì‹œ ìˆ˜ì •**
   - ë‹¤ìŒ Phaseë¡œ ë„˜ì–´ê°€ì§€ ë§ ê²ƒ
   - ì—ëŸ¬ ì›ì¸ ë¶„ì„ â†’ ìˆ˜ì • â†’ ì¬ì‹¤í–‰

3. **ì½”ë“œ ì£¼ì„ ì‘ì„±**
   - ë³µì¡í•œ ë¡œì§ì—ëŠ” ë°˜ë“œì‹œ ì£¼ì„
   - ì¬ë¬´ ì§€í‘œì˜ ì˜ë¯¸ ì„¤ëª…

4. **ì¶œë ¥ ê²°ê³¼ í™•ì¸**
   - ê° í•¨ìˆ˜ ì‹¤í–‰ í›„ shape, head í™•ì¸
   - ì˜ˆìƒê³¼ ë‹¤ë¥´ë©´ ì¦‰ì‹œ ìˆ˜ì •

---

## ğŸ¯ ìµœì¢… ì‚°ì¶œë¬¼ ì²´í¬ë¦¬ìŠ¤íŠ¸

ì™„ë£Œ í›„ ë‹¤ìŒì„ í™•ì¸í•˜ì„¸ìš”:

- [ ] `notebooks/ë°œí‘œ_Part2_ë„ë©”ì¸_íŠ¹ì„±_ê³µí•™_ì™„ì „íŒ.ipynb` ìƒì„±
- [ ] `notebooks/ë°œí‘œ_Part2_ë„ë©”ì¸_íŠ¹ì„±_ê³µí•™_ì™„ì „íŒ_executed.ipynb` ìƒì„± (papermill ì‹¤í–‰ ê²°ê³¼)
- [ ] `data/features/domain_based_features_ì™„ì „íŒ.csv` ìƒì„±
- [ ] ëª¨ë“  ì…€ 100% ì‹¤í–‰ ì„±ê³µ
- [ ] Beneish M-Score 8ê°œ ë³€ìˆ˜ ëª¨ë‘ êµ¬í˜„
- [ ] Feature Validation 40ê°œ ì´ìƒ íŠ¹ì„± ê²€ì¦ ì„±ê³µ
- [ ] AUC ë°” ì°¨íŠ¸ ì‹œê°í™” ì„±ê³µ
- [ ] VIF ë¶„ì„ ê²°ê³¼ í…Œì´ë¸” ì¶œë ¥
- [ ] ìµœì¢… ì„ íƒ íŠ¹ì„± 25~35ê°œ
- [ ] ëª¨ë“  ì„ íƒ íŠ¹ì„±ì˜ p-value < 0.05

---

## ğŸš€ ì‹œì‘í•˜ê¸°

ì´ í”„ë¡¬í”„íŠ¸ë¥¼ ì½ì—ˆë‹¤ë©´, ë‹¤ìŒê³¼ ê°™ì´ ì‹œì‘í•˜ì„¸ìš”:

1. **ì²« ë²ˆì§¸ ë©”ì‹œì§€**: "CLAUDE.mdì™€ ì°¸ì¡° ë…¸íŠ¸ë¶ì„ ì½ê³  í”„ë¡œì íŠ¸ë¥¼ ì´í•´í–ˆìŠµë‹ˆë‹¤. Phase 1ë¶€í„° ì‹œì‘í•˜ê² ìŠµë‹ˆë‹¤."

2. **TodoWrite ì‘ì„±**: Phase 1~6ì˜ ëª¨ë“  ì‘ì—…ì„ TODO ë¦¬ìŠ¤íŠ¸ë¡œ ì‘ì„±

3. **ë‹¨ê³„ë³„ ì§„í–‰**: Phase 1 â†’ 2 â†’ 3 â†’ 4 â†’ 5 â†’ 6 ìˆœì„œëŒ€ë¡œ ì§„í–‰

4. **ìµœì¢… ê²€ì¦**: papermill ì‹¤í–‰ í›„ ì²´í¬ë¦¬ìŠ¤íŠ¸ í™•ì¸

---

**ì¤‘ìš”**:
- ê¸°ì¡´ ë…¸íŠ¸ë¶(`ë°œí‘œ_Part2_ë„ë©”ì¸_íŠ¹ì„±_ê³µí•™_new.ipynb`)ì€ **ì°¸ê³ ë§Œ** í•˜ì„¸ìš”.
- **ì™„ì „íˆ ìƒˆë¡œìš´ ë…¸íŠ¸ë¶**ì„ ìƒì„±í•˜ì„¸ìš”.
- 4ê°€ì§€ ë¬¸ì œë¥¼ **ëª¨ë‘** í•´ê²°í•´ì•¼ í•©ë‹ˆë‹¤.
- ëª¨ë“  ì…€ì´ **ì—ëŸ¬ ì—†ì´** ì‹¤í–‰ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

Let's build the perfect feature engineering notebook! ğŸš€
